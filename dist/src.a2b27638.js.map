{"version":3,"sources":["src/common/webgl-utils.js","node_modules/@babel/runtime/helpers/classCallCheck.js","node_modules/@babel/runtime/helpers/createClass.js","node_modules/@babel/runtime/helpers/defineProperty.js","src/common/shadersUtils.js","src/common/Time.js","src/common/Engine.js","src/common/keyCodes.js","src/common/inputManager.js","node_modules/@babel/runtime/helpers/typeof.js","node_modules/@babel/runtime/helpers/assertThisInitialized.js","node_modules/@babel/runtime/helpers/setPrototypeOf.js","node_modules/@babel/runtime/helpers/inherits.js","node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","node_modules/@babel/runtime/helpers/getPrototypeOf.js","src/common/Component.js","src/common/Components/Transform.js","src/common/Utils/Vector_Matrix.js","src/common/Camera.js","src/common/Object.js","src/common/Scene.js","src/common/Shader.js","src/common/ShaderProgram.js","src/common/Utils/constants.js","src/shaders/shaderDefaults.js","src/common/Material.js","src/shaders/ShaderFactory.js","src/common/Mesh.js","src/common/Texture.js","src/common/Components/Light.js","src/common/Components/DirectionalLight.js","src/common/Components/PointLight.js","src/common/Components/SpotLight.js","src/index.js","node_modules/parcel-bundler/src/builtins/bundle-url.js","node_modules/parcel-bundler/src/builtins/css-loader.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["WebGLUtils","makeFailHTML","msg","GET_A_WEBGL_BROWSER","OTHER_PROBLEM","setupWebGL","canvas","opt_attribs","showLink","str","container","parentNode","innerHTML","window","WebGLRenderingContext","context","create3DContext","names","ii","length","getContext","e","console","log","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","element","setTimeout","ShaderUtils","gl","shaders","shaderProgram","createProgram","forEach","shader","compiledShader","loadAndCompileShader","type","source","attachShader","linkProgram","createShader","shaderSource","compileShader","deleteShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","program","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","name","value","glUniform1f","getUniformLocation","glUniform1i","glUniform4fv","Time","currentTime","lastTime","performance","Date","now","updateTime","frames","secondsCounter","notifyFps","deltaTime","time","fpsFnSub","fn","Engine","opt","Math","radians","degrees","pi","PI","clamp","number","min","max","setGlContext","showFps","setFpsCounter","scene","scenes","push","onAfterSceneAdded","activeScene","clearColor","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","mainCamera","renderScene","doRendering","bind","document","createElement","idNum","round","random","setAttribute","id","text","appendChild","body","subscribeFps","keys","KEYMAP","STRG","CTRL","CTRLRIGHT","CTRLR","SHIFT","RETURN","ENTER","BACKSPACE","BCKSP","ALT","ALTR","ALTRIGHT","SPACE","WIN","MAC","FN","UP","DOWN","LEFT","RIGHT","ESC","DEL","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","KEYNAMES","backspace","tab","enter","shift","ctrl","alt","pause_break","caps_lock","escape","page_up","end","home","left_arrow","up_arrow","right_arrow","down_arrow","insert","delete","a","b","c","d","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","select_key","multiply","add","subtract","divide","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","num_lock","scroll_lock","semi_colon","equal_sign","comma","dash","period","forward_slash","grave_accent","open_bracket","backslash","closebracket","single_quote","KEYCODES","MOUSECODES","MOUSENAMES","left","center","right","InputManager","movX","movY","start","onkeydown","which","updateKeyPressed","onkeyup","updateKeyUnPressed","onmousedown","updateMousePressed","onmouseup","updateMouseUnPressed","onmousemove","clientX","clientY","movementX","movementY","updateMousePosition","keysPressed","mousePosition","el","requestPointerLock","mozRequestPointerLock","exitPointerLock","mozExitPointerLock","onclick","mouseLockedEl","mouseLocked","keyCode","code","mousePressed","lastMousePosition","Y","Component","nextId","registeredComponents","Transform","parent","t1","t2","transform","position","rotation","scale","_argumentsToArray","args","concat","apply","Array","prototype","slice","equal","matrix","vec2","result","arguments","splice","vec3","vec4","scalarProduct","mat2","mat3","mat4","mult","sum","translate","isArray","rotate","angle","axis","normalize","cos","omc","sin","rotateX","theta","rx","rotateY","ry","rotateZ","rz","scalem","lookAt","eye","at","up","cross","negate","dot","ortho","bottom","top","near","far","perspective","fovy","aspect","tan","transpose","sqrt","excludeLastComponent","last","pop","len","isFinite","mix","flatten","elemsAreArrays","floats","Float32Array","idx","sizeof","byteLength","printm","det2","det3","det4","m0","m1","m2","m3","det","inverse2","inverse3","a00","a01","a02","a10","a11","a12","a20","a21","a22","inverse4","a03","a13","a23","a30","a31","a32","a33","inverse","normalMatrix","flag","Camera","speed","moveKeys","projOptions","sensitivity","zooms","forward","backward","addEventListener","event","zoomLevel","sign","deltaY","maxLevel","setZoomLevel","proj","fov","updateCameraDirection","_updateCameraDirection","ytop","direction","getFrontVector","offsetX","offsetY","yaw","pitch","newPos","level","SceneObject","startCallback","onStart","components","mesh","meshes","warning","child","children","transformToRender","summed","getTransformToRender","camera","lights","lightsTypes","render","material","component","warn","onAfterAdded","onAfterRemoved","Scene","vertex","fragment","engine","cameras","cam","alreadyPresent","obj","objects","objectsMap","light","parentObj","lightIndex","findIndex","onUpdate","Shader","VERTEX_SHADER","FRAGMENT_SHADER","shaderError","checkShaderCompilingErrors","errors","other","ShaderProgram","createShaderProgramFromShaders","checkShaderProgramLinkingErrors","LightTypes","DirectionalLight","PointLight","SpotLight","TextureTypes","DiffuseMap","SpecularMap","NormalMap","LightMap","BumpMap","ShadowMap","EmptyTexture","width","height","border","srcFormat","internalFormat","srcType","pixels","Uint8Array","DefTextCoords","vDiffuseCoords_In","vSpecularCoords_In","vLightCoords_In","vBumpCoords_In","vShadowCoords_In","vNormalCoords_In","vDiffuseCoords_Out","vSpecularCoords_Out","vLightCoords_Out","vBumpCoords_Out","vShadowCoords_Out","vNormalCoords_Out","vDiffuseCoords_Assign","vSpecularCoords_Assign","vLightCoords_Assign","vBumpCoords_Assign","vShadowCoords_Assign","vNormalCoords_Assign","vertexCompleteShaderObj","version","diffuseCoordsIn","diffuseCoordsOut","specularCoordsIn","specularCoordsOut","normalCoordsIn","normalCoordsOut","normalIn","modelViewProj","colorOut","normalOut","fragPosOut","mainStart","mainBody","diffuseAssign","specularAssign","normalAssign","mainBodyOutput","materialStruct","DirectionalLightShader","PointLightShader","SpotLightShader","DirLightFuncDec","PointLightFuncDec","SpotLightFuncDec","LightAmbientWithTexture_Diff_Spec","LightDiffuseWithTexture_Diff_Spec","LightSpecularWithTexture_Diff_Spec","LightAmbientWithTexture_Diff","LightDiffuseWithTexture_Diff","LightSpecularWithTexture_Diff","LightAmbientWithTexture_Spec","LightDiffuseWithTexture_Spec","LightSpecularWithTexture_Spec","DirLightFuncImplObj","signature","bodyStandandPart","bodyAmbient","bodyDiffuse","bodySpecular","bodyReturn","PointLightFuncImplObj","bodyAttenuation","SpotLightFuncImplObj","textureScheme","materialVar","diffuseMapVar","specularMapVar","lightMapVar","bumbMapVar","shadowMapVar","normalMapVar","fDiffuseCoords","fSpecularCoords","fLightCoords","fBumpCoords","fShadowCoords","fNormalCoords","fOutput_Lights","fragmentShaderCompleteObj","precision","lightsStructs","lightsFuncDec","colorIn","fragPosIn","texturesCoords","samplers","viewPos","lightsUniform","lightsCalc","textureCalc","fragOutput","mainEnd","lightsFuncImpl","textureFuncImpl","Material","ambient","diffuse","specular","shininess","ShaderFactory","props","vertexSource","shaderDefault","textures","Object","values","join","fragmentSource","JSON","parse","stringify","hasLights","hasTexture","hasDiffuseTexture","getTexturesCalc","getLightsStructsFromLights","getLightsFuncDec","getLightsVarsFromLights","doLightCalcs","getLightsFuncImpl","sources","textureTypes","lightSource","setLightSourceTextures","Mesh","vertices","indices","textCoords","normals","set","keepData","TRIANGLES","assign","DIFFUSE_MAP","SPECULAR_MAP","NORMAL_MAP","LIGHT_MAP","BUMP_MAP","SHADOW_MAP","VAO","createVertexArray","bindVertexArray","VBO","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","positionLoc","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","NBO","normalLoc","locations","textCoordBuffer","textCoordLoc","EBO","ELEMENT_ARRAY_BUFFER","Uint16Array","modelLoc","viewLoc","projLoc","unbindVAO","object","modelMatrix","traslationMatrix","rotationMatrixX","rotationMatrixY","rotationMatrixZ","scaleMatrix","getModelMatrix","lightName","lightLocs","constant","linear","quadratic","cutOff","outerCutOff","viewPosLoc","materialLocs","getDirectionalLightLocations","getPointLightLocations","getSpotLightLocations","shaderUpdated","CreateVertexShaderFromProperties","CreateFragmentShaderFromProperties","key","getLocations","createAndLoadBuffers","updateShadersAndProgram","useProgram","projMatrix","getProjectionMatrix","viewMatrix","getViewMatrix","uniformMatrix4fv","uniform3fv","uniform1f","setupDirectionalLight","setupPointLight","setupSpotLight","texture","ActiveTexture","drawElements","UNSIGNED_SHORT","drawArrays","DisactiveTexture","destroyProgram","destroyShaders","Texture","textureUnit","gl_type","imagePath","s_texelType","texelType","params","createTexture","bindTexture","TEXTURE_2D","texImage2D","UNSIGNED_BYTE","textureSource","Image","crossOrigin","src","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","TEXTURE_MAG_FILTER","LINEAR","_loaded","generateMipmap","removeEventListener","activeTexture","TEXTURE0","deleteTexture","lightTypes","Light","registerLight","constructor","unregisterLight","inputs","getElementById","lockMouse","drawingBufferWidth","drawingBufferHeight","enable","DEPTH_TEST","viewport","vertices1","floorTextCoords","handleInputs","isKeyDown","keyCodes","moveUp","moveDown","moveLeft","moveBackwards","moveRight","moveForward","obj3","robotLowerArm","robotBody","pointLight_obj","pointLight","getMouseMovX","getMouseMovY","obj2","lightsObj","robotUpperArm","mat","floor","floorMesh","textureFloor","RGB","LoadTexture","addMesh","addObject","cube","cube2","cube3","addChild","dirLight","pointLight_obj2","pointLight2","spotLight","addComponent","gameManager","clearMousePosition","addCamera","addScene","main","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","replace","exports","bundle","require","updateLink","link","newLink","cloneNode","onload","remove","href","split","insertBefore","nextSibling","cssTimeout","reloadCSS","links","querySelectorAll","module","OVERLAY_ID","OldModule","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","overlay","createErrorOverlay","stackTrace","innerText","getParents","modules","parents","dep","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["/*\r\n * Copyright 2010, Google Inc.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are\r\n * met:\r\n *\r\n *     * Redistributions of source code must retain the above copyright\r\n * notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above\r\n * copyright notice, this list of conditions and the following disclaimer\r\n * in the documentation and/or other materials provided with the\r\n * distribution.\r\n *     * Neither the name of Google Inc. nor the names of its\r\n * contributors may be used to endorse or promote products derived from\r\n * this software without specific prior written permission.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\r\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\r\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\r\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\r\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\r\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\r\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n */\r\n\r\n\r\n/**\r\n * @fileoverview This file contains functions every webgl program will need\r\n * a version of one way or another.\r\n *\r\n * Instead of setting up a context manually it is recommended to\r\n * use. This will check for success or failure. On failure it\r\n * will attempt to present an approriate message to the user.\r\n *\r\n *       gl = WebGLUtils.setupWebGL(canvas);\r\n *\r\n * For animated WebGL apps use of setTimeout or setInterval are\r\n * discouraged. It is recommended you structure your rendering\r\n * loop like this.\r\n *\r\n *       function render() {\r\n *         window.requestAnimFrame(render, canvas);\r\n *\r\n *         // do rendering\r\n *         ...\r\n *       }\r\n *       render();\r\n *\r\n * This will call your rendering function up to the refresh rate\r\n * of your display but will stop rendering if your app is not\r\n * visible.\r\n */\r\n\r\nexport const WebGLUtils = function() {\r\n\r\n/**\r\n * Creates the HTLM for a failure message\r\n * @param {string} canvasContainerId id of container of th\r\n *        canvas.\r\n * @return {string} The html.\r\n */\r\nvar makeFailHTML = function(msg) {\r\n  return '' +\r\n    '<table style=\"background-color: #8CE; width: 100%; height: 100%;\"><tr>' +\r\n    '<td align=\"center\">' +\r\n    '<div style=\"display: table-cell; vertical-align: middle;\">' +\r\n    '<div style=\"\">' + msg + '</div>' +\r\n    '</div>' +\r\n    '</td></tr></table>';\r\n};\r\n\r\n/**\r\n * Mesasge for getting a webgl browser\r\n * @type {string}\r\n */\r\nvar GET_A_WEBGL_BROWSER = '' +\r\n  'This page requires a browser that supports WebGL.<br/>' +\r\n  '<a href=\"http://get.webgl.org\">Click here to upgrade your browser.</a>';\r\n\r\n/**\r\n * Mesasge for need better hardware\r\n * @type {string}\r\n */\r\nvar OTHER_PROBLEM = '' +\r\n  \"It doesn't appear your computer can support WebGL.<br/>\" +\r\n  '<a href=\"http://get.webgl.org/troubleshooting/\">Click here for more information.</a>';\r\n\r\n/**\r\n * Creates a webgl context. If creation fails it will\r\n * change the contents of the container of the <canvas>\r\n * tag to an error message with the correct links for WebGL.\r\n * @param {Element} canvas. The canvas element to create a\r\n *     context from.\r\n * @param {WebGLContextCreationAttirbutes} opt_attribs Any\r\n *     creation attributes you want to pass in.\r\n * @return {WebGLRenderingContext} The created context.\r\n */\r\nvar setupWebGL = function(canvas, opt_attribs) {\r\n  function showLink(str) {\r\n    var container = canvas.parentNode;\r\n    if (container) {\r\n      container.innerHTML = makeFailHTML(str);\r\n    }\r\n  };\r\n\r\n  if (!window.WebGLRenderingContext) {\r\n    showLink(GET_A_WEBGL_BROWSER);\r\n    return null;\r\n  }\r\n\r\n  var context = create3DContext(canvas, opt_attribs);\r\n  if (!context) {\r\n    showLink(OTHER_PROBLEM);\r\n  }\r\n  return context;\r\n};\r\n\r\n/**\r\n * Creates a webgl context.\r\n * @param {!Canvas} canvas The canvas tag to get context\r\n *     from. If one is not passed in one will be created.\r\n * @return {!WebGLContext} The created context.\r\n */\r\nvar create3DContext = function(canvas, opt_attribs) {\r\n  var names = [\"webgl2\", \"webgl\", \"experimental-webgl\", \"webkit-3d\", \"moz-webgl\"];\r\n  var context = null;\r\n  for (var ii = 0; ii < names.length; ++ii) {\r\n    try {\r\n      context = canvas.getContext(names[ii], opt_attribs);\r\n    } catch(e) {}\r\n    if (context) {\r\n      console.log(context);\r\n      break;\r\n    }\r\n  }\r\n  return context;\r\n}\r\n\r\nreturn {\r\n  create3DContext: create3DContext,\r\n  setupWebGL: setupWebGL\r\n};\r\n}();\r\n\r\n/**\r\n * Provides requestAnimationFrame in a cross browser way.\r\n */\r\nwindow.requestAnimFrame = (function() {\r\n  return window.requestAnimationFrame ||\r\n         window.webkitRequestAnimationFrame ||\r\n         window.mozRequestAnimationFrame ||\r\n         window.oRequestAnimationFrame ||\r\n         window.msRequestAnimationFrame ||\r\n         function(/* function FrameRequestCallback */ callback, /* DOMElement Element */ element) {\r\n           window.setTimeout(callback, 1000/60);\r\n         };\r\n})();\r\n\r\n\r\n","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","export class ShaderUtils {\n\n    gl;\n\n    constructor(gl) {\n      this.gl = gl;\n    }\n\n    static setGlContext(gl){\n      this.gl = gl;\n    }\n\n    static compileShadersAndcreateProgram(shaders) {\n      const shaderProgram = this.gl.createProgram();\n      shaders.forEach(shader => {\n          let compiledShader = this.loadAndCompileShader(shaders.type, shaders.source);\n          this.gl.attachShader(shaderProgram, compiledShader);\n      });\n      this.gl.linkProgram(shaderProgram);\n      return shaderProgram;\n    }\n\n    static loadAndCompileShader(type, source) {\n      console.log('[SHADER] Compiling ->', ' Type: ', type, '- Source: ', source)\n      let shader = this.gl.createShader(type);\n      this.gl.shaderSource(shader, source);\n      this.gl.compileShader(shader);\n      return shader;\n    }\n\n    /**\n     * @param {[vertex, fragment]} shaders \n     */\n    static createShaderProgramFromShaders(shaders) {\n      console.log('[SHADER_PROGRAM] Creating ->', ' Shaders: ', shaders);\n      const shaderProgram = this.gl.createProgram();\n    \n      shaders.forEach(shader => {\n        this.gl.attachShader(shaderProgram, shader);\n        this.gl.deleteShader(shader);\n      });\n      this.gl.linkProgram(shaderProgram);\n      return shaderProgram;\n    }\n\n    static checkShaderCompilingErrors(shader) {\n      if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\n          return this.gl.getShaderInfoLog(shader);\n      } else return null;\n    }\n\n    static checkShaderProgramLinkingErrors(program) {\n      if (!this.gl.getProgramParameter(program, this.gl.LINK_STATUS)) {\n          return this.gl.getProgramInfoLog(program);\n      } else return null;\n    }\n\n    static destroyShaderProgram(program){\n      this.gl.deleteProgram(program);\n    }\n\n    static destroyShader(shader){\n      this.gl.deleteShader(shader);\n    }\n\n    static setFloat(name, value) {\n      this.gl.glUniform1f(this.gl.getUniformLocation(name), value);\n    }\n\n    static setBool(name, value) {\n      this.gl.glUniform1i(this.gl.getUniformLocation(name), value);\n    }\n\n    static setInt(name, value) {\n      this.gl.glUniform1i(this.gl.getUniformLocation(name), value);\n    }\n\n    static setMatrix(name, value){\n      this.gl.glUniform4fv(this.gl.getUniformLocation(name), value);\n    }\n\n}\n","/** \r\n * @author Alberto Contorno\r\n * @class\r\n * Class representing the time. \r\n * It provides the current time (in ms from the start of the Engine)\r\n * a deltaTime between frames \r\n * and a FPS counter service to which something can subscribe\r\n */\r\nexport class Time{\r\n    /**\r\n     * @property {number} deltaTime- The time passed between the last frame (in ms) and the current one. Use it to make things indipendent from the frame rate.\r\n     * @property {number} time- The time passed since the start (in ms).\r\n     * @property {number} frames- The current number of frames passed since last second (not precise).\r\n     */\r\n    deltaTime = 0;\r\n    \r\n    time = 0;\r\n    currentTime = 0;\r\n    lastTime = 0;\r\n    secondsCounter = 0;\r\n    frames = 0;\r\n    fpsFnSub = null;\r\n    constructor() {\r\n        /**\r\n         * someProperty is an example property that is set to `true`\r\n         * @type {boolean}\r\n         * @public\r\n         */\r\n        this.currentTime = this.lastTime = (performance ? performance : Date).now();\r\n        this.updateTime();\r\n    }\r\n    /**\r\n     * Function that update the time\r\n     */\r\n    updateTime(){\r\n        this.frames++;\r\n        if(this.secondsCounter>=1){\r\n            this.notifyFps();\r\n            this.secondsCounter=0;\r\n            this.frames = 0;\r\n        }\r\n        this.currentTime = (performance ? performance : Date).now();\r\n        this.deltaTime = (this.currentTime - this.lastTime) * 0.001;\r\n        this.lastTime = this.currentTime;\r\n        this.time += this.deltaTime;\r\n        this.secondsCounter += this.deltaTime;\r\n        //window.requestAnimationFrame(this.updateTime.bind(this));\r\n    }\r\n\r\n    notifyFps(){ //subscribe\r\n        if (this.fpsFnSub){this.fpsFnSub();}\r\n    }\r\n\r\n    subscribeFps(fn){\r\n        this.fpsFnSub = fn;\r\n    }\r\n\r\n}\r\n","import {ShaderUtils} from './shadersUtils'\nimport { Time } from './Time';\n/**\n * @author Alberto Contorno\n * @class\n * class that represent the entire Engine.\n * It takes care of the main loop fo the rendering and of the updating of the time\n * It initialize the GL context, and maintains the list of scenes, of which only one is the active (rendered) one.\n */\nexport class Engine{ //TODO SCENE MANAGER\n    scenes = [];\n    activeScene;\n    gl;\n    time;\n    opt;\n    /**\n     * Create a new Engine and do the setup of all the environment.\n     * @param {WebGL_Context} gl The WebGl context obtained from a canvas. This will be the context of the entire Engine.\n     * used as the context of every Shader.\n     */\n    constructor(gl, opt){\n      Math.radians = degrees => {\n        var pi = Math.PI;\n        return degrees * (pi / 180);\n      };\n\n      Math.clamp = function (number, min, max) {\n        return Math.max(min, Math.min(number, max));\n      };\n      this.gl = gl;\n      this.time = new Time();\n      this.opt = opt;\n      ShaderUtils.setGlContext(this.gl);\n\n      if(this.opt){\n        if(this.opt.showFps){\n          this.setFpsCounter();\n        }\n      }\n    }\n\n    /**\n     * \n     * @param {Scene} scene add a scene to the list of scenes that the Engine manages.\n     * If there is no active scene, the added scene is set as the active one.\n     */\n    addScene(scene){\n      this.scenes.push(scene);\n      scene.onAfterSceneAdded(this);\n      if (!this.activeScene){\n        this.activeScene = this.scenes.length - 1;\n      }\n    }\n\n    /**\n     * Starts the rendering and the update of the time at every frame.\n     */\n    doRendering() {\n      this.gl.clearColor(0.0, 0.0, 0.0, 1.0);\n      this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\n      if (this.scenes[this.activeScene] && this.scenes[this.activeScene].mainCamera){\n        this.scenes[this.activeScene].renderScene(this.gl);\n      }\n      this.time.updateTime();\n      window.requestAnimationFrame(this.doRendering.bind(this));\n    }\n\n    setFpsCounter(){\n      let container = document.createElement('div');\n      let idNum = Math.round(Math.random(0, 1) * 100);\n      container.setAttribute(\"style\",\n      `position: absolute;\n      top: 10px;\n      left: 20px;\n      color: yellow;`);\n      container.id = 'glFpsCounterContainer_' + idNum;\n      let text = document.createElement('p');\n      text.id = 'glFpsCounterText_'+ idNum;\n      container.appendChild(text);\n      document.body.appendChild(container);\n      this.time.subscribeFps(() => { text.innerHTML = 'FPS: ' + this.time.frames; })\n    }\n}","export const keys = {\n\tKEYMAP: {\n\t\tSTRG: 17,\n\t\tCTRL: 17,\n\t\tCTRLRIGHT: 18,\n\t\tCTRLR: 18,\n\t\tSHIFT: 16,\n\t\tRETURN: 13,\n\t\tENTER: 13,\n\t\tBACKSPACE: 8,\n\t\tBCKSP: 8,\n\t\tALT: 18,\n\t\tALTR: 17,\n\t\tALTRIGHT: 17,\n\t\tSPACE: 32,\n\t\tWIN: 91,\n\t\tMAC: 91,\n\t\tFN: null,\n\t\tUP: 38,\n\t\tDOWN: 40,\n\t\tLEFT: 37,\n\t\tRIGHT: 39,\n\t\tESC: 27,\n\t\tDEL: 46,\n\t\tF1: 112,\n\t\tF2: 113,\n\t\tF3: 114,\n\t\tF4: 115,\n\t\tF5: 116,\n\t\tF6: 117,\n\t\tF7: 118,\n\t\tF8: 119,\n\t\tF9: 120,\n\t\tF10: 121,\n\t\tF11: 122,\n\t\tF12: 123\n\t},\n\tKEYNAMES: {\n\t\tbackspace: '8',\n\t\ttab: '9',\n\t\tenter: '13',\n\t\tshift: '16',\n\t\tctrl: '17',\n\t\talt: '18',\n\t\tpause_break: '19',\n\t\tcaps_lock: '20',\n\t\tescape: '27',\n\t\tpage_up: '33',\n\t\t'page down': '34',\n\t\tend: '35',\n\t\thome: '36',\n\t\tleft_arrow: '37',\n\t\tup_arrow: '38',\n\t\tright_arrow: '39',\n\t\tdown_arrow: '40',\n\t\tinsert: '45',\n\t\tdelete: '46',\n\t\t'0': '48',\n\t\t'1': '49',\n\t\t'2': '50',\n\t\t'3': '51',\n\t\t'4': '52',\n\t\t'5': '53',\n\t\t'6': '54',\n\t\t'7': '55',\n\t\t'8': '56',\n\t\t'9': '57',\n\t\ta: '65',\n\t\tb: '66',\n\t\tc: '67',\n\t\td: '68',\n\t\te: '69',\n\t\tf: '70',\n\t\tg: '71',\n\t\th: '72',\n\t\ti: '73',\n\t\tj: '74',\n\t\tk: '75',\n\t\tl: '76',\n\t\tm: '77',\n\t\tn: '78',\n\t\to: '79',\n\t\tp: '80',\n\t\tq: '81',\n\t\tr: '82',\n\t\ts: '83',\n\t\tt: '84',\n\t\tu: '85',\n\t\tv: '86',\n\t\tw: '87',\n\t\tx: '88',\n\t\ty: '89',\n\t\tz: '90',\n\t\t'left_window key': '91',\n\t\t'right_window key': '92',\n\t\tselect_key: '93',\n\t\t'numpad 0': '96',\n\t\t'numpad 1': '97',\n\t\t'numpad 2': '98',\n\t\t'numpad 3': '99',\n\t\t'numpad 4': '100',\n\t\t'numpad 5': '101',\n\t\t'numpad 6': '102',\n\t\t'numpad 7': '103',\n\t\t'numpad 8': '104',\n\t\t'numpad 9': '105',\n\t\tmultiply: '106',\n\t\tadd: '107',\n\t\tsubtract: '109',\n\t\t'decimal point': '110',\n\t\tdivide: '111',\n\t\tf1: '112',\n\t\tf2: '113',\n\t\tf3: '114',\n\t\tf4: '115',\n\t\tf5: '116',\n\t\tf6: '117',\n\t\tf7: '118',\n\t\tf8: '119',\n\t\tf9: '120',\n\t\tf10: '121',\n\t\tf11: '122',\n\t\tf12: '123',\n\t\tnum_lock: '144',\n\t\tscroll_lock: '145',\n\t\tsemi_colon: '186',\n\t\tequal_sign: '187',\n\t\tcomma: '188',\n\t\tdash: '189',\n\t\tperiod: '190',\n\t\tforward_slash: '191',\n\t\tgrave_accent: '192',\n\t\topen_bracket: '219',\n\t\tbackslash: '220',\n\t\tclosebracket: '221',\n\t\tsingle_quote: '222'\n\t},\n\tKEYCODES: {\n\t\t8: 'backspace',\n\t\t9: 'tab',\n\t\t13: 'enter',\n\t\t16: 'shift',\n\t\t17: 'ctrl',\n\t\t18: 'alt',\n\t\t19: 'pause_break',\n\t\t20: 'caps_lock',\n\t\t27: 'escape',\n\t\t33: 'page_up',\n\t\t34: 'page down',\n\t\t35: 'end',\n\t\t36: 'home',\n\t\t37: 'left_arrow',\n\t\t38: 'up_arrow',\n\t\t39: 'right_arrow',\n\t\t40: 'down_arrow',\n\t\t45: 'insert',\n\t\t46: 'delete',\n\t\t48: '0',\n\t\t49: '1',\n\t\t50: '2',\n\t\t51: '3',\n\t\t52: '4',\n\t\t53: '5',\n\t\t54: '6',\n\t\t55: '7',\n\t\t56: '8',\n\t\t57: '9',\n\t\t65: 'a',\n\t\t66: 'b',\n\t\t67: 'c',\n\t\t68: 'd',\n\t\t69: 'e',\n\t\t70: 'f',\n\t\t71: 'g',\n\t\t72: 'h',\n\t\t73: 'i',\n\t\t74: 'j',\n\t\t75: 'k',\n\t\t76: 'l',\n\t\t77: 'm',\n\t\t78: 'n',\n\t\t79: 'o',\n\t\t80: 'p',\n\t\t81: 'q',\n\t\t82: 'r',\n\t\t83: 's',\n\t\t84: 't',\n\t\t85: 'u',\n\t\t86: 'v',\n\t\t87: 'w',\n\t\t88: 'x',\n\t\t89: 'y',\n\t\t90: 'z',\n\t\t91: 'left_window key',\n\t\t92: 'right_window key',\n\t\t93: 'select_key',\n\t\t96: 'numpad 0',\n\t\t97: 'numpad 1',\n\t\t98: 'numpad 2',\n\t\t99: 'numpad 3',\n\t\t100: 'numpad 4',\n\t\t101: 'numpad 5',\n\t\t102: 'numpad 6',\n\t\t103: 'numpad 7',\n\t\t104: 'numpad 8',\n\t\t105: 'numpad 9',\n\t\t106: 'multiply',\n\t\t107: 'add',\n\t\t109: 'subtract',\n\t\t110: 'decimal point',\n\t\t111: 'divide',\n\t\t112: 'f1',\n\t\t113: 'f2',\n\t\t114: 'f3',\n\t\t115: 'f4',\n\t\t116: 'f5',\n\t\t117: 'f6',\n\t\t118: 'f7',\n\t\t119: 'f8',\n\t\t120: 'f9',\n\t\t121: 'f10',\n\t\t122: 'f11',\n\t\t123: 'f12',\n\t\t144: 'num_lock',\n\t\t145: 'scroll_lock',\n\t\t186: 'semi_colon',\n\t\t187: 'equal_sign',\n\t\t188: 'comma',\n\t\t189: 'dash',\n\t\t190: 'period',\n\t\t191: 'forward_slash',\n\t\t192: 'grave_accent',\n\t\t219: 'open_bracket',\n\t\t220: 'backslash',\n\t\t221: 'closebracket',\n\t\t222: 'single_quote'\n\t},\n\tMOUSECODES: {\n\t\t0: 'left',\n\t\t1: 'center',\n\t\t2: 'right'\n\t},\n\tMOUSENAMES: { left: 0, center: 1, right: 2 }\n};\n","import {keys} from './keyCodes';\n/**\n * @author Alberto Contorno\n * @class\n * Class used to manage the user inputs. It can manage keyboard and mouse.\n */\nexport class InputManager{\n  keysPressed = {};\n  mousePressed = {};\n  mousePosition = {x: 0, y: 0, movX: 0, movY: 0};\n  lastMousePosition = {x: 0, y: 0};\n\n  keyCodes = keys;\n  mouseLocked = false;\n  mouseLockedEl = null;\n\n  constructor(){\n    this.start();\n  }\n\n  start(){\n    window.onkeydown = ({ which }) => {\n      this.updateKeyPressed(which);\n    };\n    window.onkeyup = ({ which }) => {\n      this.updateKeyUnPressed(which);\n    }\n    window.onmousedown = ({ which }) => {\n      this.updateMousePressed(which);\n    }\n    window.onmouseup = ({ which }) => {\n      this.updateMouseUnPressed(which);\n    }\n    window.onmousemove = ({clientX, clientY, movementX, movementY}) => {\n      this.updateMousePosition(clientX, clientY, movementX, movementY);\n    }\n  }\n\n  stop(){\n    window.onkeydown = null;\n    window.onkeyup = null;\n    window.onmousedown = null;\n    window.onmouseup = null;\n    window.onmousemove = null;\n  }\n\n  clearKeyPressed() {\n    this.keysPressed = { };\n  }\n\n  clearMousePosition() {\n    this.mousePosition = {x:0, y:0, movX: 0, movY: 0};\n  }\n\n  lockMouse(el){\n    el.requestPointerLock = el.requestPointerLock ||\n      el.mozRequestPointerLock;\n\n    document.exitPointerLock = document.exitPointerLock ||\n      document.mozExitPointerLock;\n    \n    el.onclick = () => {\n      el.requestPointerLock();\n      this.mouseLockedEl = el;\n      this.mouseLocked = true;\n    }\n \n  }\n\n  unlockMouse(){\n    document.exitPointerLock();\n    this.mouseLocked = false;\n    this.mouseLockedEl.requestPointerLock = null;\n    document.exitPointerLock = null;\n    this.mouseLockedEl = null;\n  }\n\n  updateKeyPressed(keyCode){\n    this.keysPressed[keys.KEYCODES[keyCode]] = true;\n  }\n\n  updateKeyUnPressed(keyCode) {\n    this.keysPressed[keys.KEYCODES[keyCode]] = false;\n  }\n\n  updateMousePressed(code){\n    this.mousePressed[keys.MOUSECODES[code]] = true;\n  }\n\n  updateMouseUnPressed(code) {\n    this.mousePressed[keys.MOUSECODES[code]] = false;\n  }\n\n  updateMousePosition(x, y, movX, movY){\n    this.lastMousePosition.x = this.mousePosition.x;\n    this.lastMousePosition.y = this.mousePosition.y;\n    this.lastMousePosition.movX = this.mousePosition.movX;\n    this.lastMousePosition.movY = this.mousePosition.movY;\n\n    this.mousePosition.x = x;\n    this.mousePosition.y = y;\n    this.mousePosition.movX = movX;\n    this.mousePosition.movY = movY;\n  }\n\n  isKeyDown(keyCode){\n    return this.keysPressed[keys.KEYCODES[keyCode]] || false;\n  }\n\n  isKeyUp(keyCode){\n    return !this.keysPressed[keys.KEYCODES[keyCode]] || true\n  }\n\n  isMouseDown(code){\n    return this.mousePressed[keys.MOUSECODES[code]] || false;\n  }\n\n  isMouseUp(code){\n    return !this.mousePressed[keys.MOUSECODES[code]] || true;\n  }\n\n  getMousePosition(){\n    return this.mousePosition;\n  }\n\n  getMouseX(){\n    return this.mousePosition.x;\n  }\n\n  getMouseY(){\n    return this.mousePosition.y;\n  }\n\n  getMouseLastX() {\n    return this.lastMousePosition.x;\n  }\n\n  getMouseLastY() {\n    return this.lastMousePosition.Y;\n  }\n\n  getMouseDeltaX(){\n    return this.mousePosition.x - this.lastMousePosition.x;\n  }\n\n  getMouseDeltaY(){\n    return this.mousePosition.y - this.lastMousePosition.y;\n  }\n\n  getMouseMovX(){\n    return this.mousePosition.movX;\n  }\n\n  getMouseMovY() {\n    return this.mousePosition.movY;\n  }\n\n  isMouseLocked(){\n    return this.mouseLocked;\n  }\n  \n}","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","/**\r\n * @author Alberto Contorno\r\n * @class\r\n */\r\nexport class Component{\r\n    static nextId = 1;\r\n    name;\r\n    parent;\r\n\r\n    constructor(){\r\n        Component.nextId++;\r\n        this.id = Component.nextId;\r\n    }\r\n\r\n    onAfterAdded() {}\r\n\r\n    onAfterRemoved() {}\r\n}\r\n\r\nexport const registeredComponents = {\r\n    'transform': 0,\r\n    'mesh': 1,\r\n    'light': 2,\r\n    'material': 3\r\n}","import {Component} from '../Component';\n\n/**\n * @author Alberto Contorno\n * @class\n */\nexport class Transform extends Component{\n    position = [0, 0, 0];\n    rotation = [0, 0, 0]\n    scale = [1, 1, 1];\n\n    constructor(parent){\n        super();\n        this.parent = parent;\n        this.name = 'transform';\n\n    }\n\n    static summed(t1, t2){\n        if(t1 == null || t2 == null){ return null; }\n        let transform = new Transform();\n\n        transform.position[0] = t1.position[0] + t2.position[0];\n        transform.position[1] = t1.position[1] + t2.position[1];\n        transform.position[2] = t1.position[2] + t2.position[2];\n\n        transform.rotation[0] = t1.rotation[0] + t2.rotation[0];\n        transform.rotation[1] = t1.rotation[1] + t2.rotation[1];\n        transform.rotation[2] = t1.rotation[2] + t2.rotation[2];\n\n        transform.scale[0] = t1.scale[0] * t2.scale[0];\n        transform.scale[1] = t1.scale[1] * t2.scale[1];\n        transform.scale[2] = t1.scale[2] * t2.scale[2];\n\n        return transform;\n    }\n}","function _argumentsToArray( args )\r\n{\r\n    return [].concat.apply( [], Array.prototype.slice.apply(args) );\r\n}\r\n\r\n\r\nfunction radians( degrees ) {\r\n  return degrees * Math.PI / 180.0;\r\n}\r\n\r\nfunction equal( u, v )\r\n{\r\n    if ( u.length != v.length ) { return false; }\r\n\r\n    if ( u.matrix && v.matrix ) {\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i].length != v[i].length ) { return false; }\r\n            for ( var j = 0; j < u[i].length; ++j ) {\r\n                if ( u[i][j] !== v[i][j] ) { return false; }\r\n            }\r\n        }\r\n    }\r\n    else if ( u.matrix && !v.matrix || !u.matrix && v.matrix ) {\r\n        return false;\r\n    }\r\n    else {\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i] !== v[i] ) { return false; }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nexport const vec2 = function vec2(){\r\n  var result = _argumentsToArray( arguments );\r\n\r\n  switch ( result.length ) {\r\n  case 0: result.push( 0.0 );\r\n  case 1: result.push( 0.0 );\r\n  }\r\n\r\n  return result.splice( 0, 2 );\r\n}\r\n\r\nexport const vec3 = function vec3() {\r\n  var result = _argumentsToArray( arguments );\r\n\r\n  switch ( result.length ) {\r\n  case 0: result.push( 0.0 );\r\n  case 1: result.push( 0.0 );\r\n  case 2: result.push( 0.0 );\r\n  }\r\n\r\n  return result.splice( 0, 3 );\r\n}\r\n\r\nexport const vec4 = function vec4() {\r\n  var result = _argumentsToArray( arguments );\r\n\r\n  switch ( result.length ) {\r\n  case 0: result.push( 0.0 );\r\n  case 1: result.push( 0.0 );\r\n  case 2: result.push( 0.0 );\r\n  case 3: result.push( 1.0 );\r\n  }\r\n\r\n  return result.splice( 0, 4 );\r\n}\r\n\r\nexport const scalarProduct = function scalarProduct(v, s){\r\n  v.forEach( (v,i) => v[i] = v * s );\r\n}\r\n\r\n\r\n/////////////////////////////////////////////////////\r\nexport const mat2 = function mat2()\r\n{\r\n    var v = _argumentsToArray( arguments );\r\n\r\n    var m = [];\r\n    switch ( v.length ) {\r\n    case 0:\r\n        v[0] = 1;\r\n    case 1:\r\n        m = [\r\n            vec2( v[0],  0.0 ),\r\n            vec2(  0.0, v[0] )\r\n        ];\r\n        break;\r\n\r\n    default:\r\n        m.push( vec2(v) );  v.splice( 0, 2 );\r\n        m.push( vec2(v) );\r\n        break;\r\n    }\r\n\r\n    m.matrix = true;\r\n\r\n    return m;\r\n}\r\n\r\nexport const mat3 = function mat3()\r\n{\r\n    var v = _argumentsToArray( arguments );\r\n\r\n    var m = [];\r\n    switch ( v.length ) {\r\n    case 0:\r\n        v[0] = 1;\r\n    case 1:\r\n        m = [\r\n            vec3( v[0],  0.0,  0.0 ),\r\n            vec3(  0.0, v[0],  0.0 ),\r\n            vec3(  0.0,  0.0, v[0] )\r\n        ];\r\n        break;\r\n\r\n    default:\r\n        m.push( vec3(v) );  v.splice( 0, 3 );\r\n        m.push( vec3(v) );  v.splice( 0, 3 );\r\n        m.push( vec3(v) );\r\n        break;\r\n    }\r\n\r\n    m.matrix = true;\r\n\r\n    return m;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const mat4 = function mat4()\r\n{\r\n    var v = _argumentsToArray( arguments );\r\n\r\n    var m = [];\r\n    switch ( v.length ) {\r\n    case 0:\r\n        v[0] = 1;\r\n    case 1:\r\n        m = [\r\n            vec4( v[0], 0.0,  0.0,   0.0 ),\r\n            vec4( 0.0,  v[0], 0.0,   0.0 ),\r\n            vec4( 0.0,  0.0,  v[0],  0.0 ),\r\n            vec4( 0.0,  0.0,  0.0,  v[0] )\r\n        ];\r\n        break;\r\n\r\n    default:\r\n        m.push( vec4(v) );  v.splice( 0, 4 );\r\n        m.push( vec4(v) );  v.splice( 0, 4 );\r\n        m.push( vec4(v) );  v.splice( 0, 4 );\r\n        m.push( vec4(v) );\r\n        break;\r\n    }\r\n\r\n    m.matrix = true;\r\n\r\n    return m;\r\n}\r\n\r\nexport const subtract = function subtract( u, v )\r\n{\r\n    var result = [];\r\n\r\n    if ( u.matrix && v.matrix ) {\r\n        if ( u.length != v.length ) {\r\n            throw \"subtract(): trying to subtract matrices\" +\r\n                \" of different dimensions\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i].length != v[i].length ) {\r\n                throw \"subtract(): trying to subtact matrices\" +\r\n                    \" of different dimensions\";\r\n            }\r\n            result.push( [] );\r\n            for ( var j = 0; j < u[i].length; ++j ) {\r\n                result[i].push( u[i][j] - v[i][j] );\r\n            }\r\n        }\r\n\r\n        result.matrix = true;\r\n\r\n        return result;\r\n    }\r\n    else if ( u.matrix && !v.matrix || !u.matrix && v.matrix ) {\r\n        throw \"subtact(): trying to subtact  matrix and non-matrix variables\";\r\n    }\r\n    else {\r\n        if ( u.length != v.length ) {\r\n            throw \"subtract(): vectors are not the same length\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            result.push( u[i] - v[i] );\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const mult = function mult( u, v )\r\n{\r\n    var result = [];\r\n\r\n    if ( u.matrix && v.matrix ) {\r\n        if ( u.length != v.length ) {\r\n            throw \"mult(): trying to add matrices of different dimensions\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i].length != v[i].length ) {\r\n                throw \"mult(): trying to add matrices of different dimensions\";\r\n            }\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            result.push( [] );\r\n\r\n            for ( var j = 0; j < v.length; ++j ) {\r\n                var sum = 0.0;\r\n                for ( var k = 0; k < u.length; ++k ) {\r\n                    sum += u[i][k] * v[k][j];\r\n                }\r\n                result[i].push( sum );\r\n            }\r\n        }\r\n\r\n        result.matrix = true;\r\n\r\n        return result;\r\n    }\r\n\r\n      if(u.matrix&& (u.length == v.length)) {\r\n        for(var i = 0; i<v.length; i++) {\r\n          var sum = 0.0;\r\n          for(var j=0; j<v.length; j++) {\r\n            sum += u[i][j]*v[j];\r\n          }\r\n          result.push(sum);\r\n        }\r\n      return result;\r\n      }\r\n\r\n\r\n\r\n    else {\r\n        if ( u.length != v.length ) {\r\n            throw \"mult(): vectors are not the same dimension\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            result.push( u[i] * v[i] );\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  Basic Transformation Matrix Generators\r\n//\r\n\r\nexport const add = function add( u, v )\r\n{\r\n    var result = [];\r\n\r\n    if ( u.matrix && v.matrix ) {\r\n        if ( u.length != v.length ) {\r\n            throw \"add(): trying to add matrices of different dimensions\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i].length != v[i].length ) {\r\n                throw \"add(): trying to add matrices of different dimensions\";\r\n            }\r\n            result.push( [] );\r\n            for ( var j = 0; j < u[i].length; ++j ) {\r\n                result[i].push( u[i][j] + v[i][j] );\r\n            }\r\n        }\r\n\r\n        result.matrix = true;\r\n\r\n        return result;\r\n    }\r\n    else if ( u.matrix && !v.matrix || !u.matrix && v.matrix ) {\r\n        throw \"add(): trying to add matrix and non-matrix variables\";\r\n    }\r\n    else {\r\n        if ( u.length != v.length ) {\r\n            throw \"add(): vectors are not the same dimension\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            result.push( u[i] + v[i] );\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\nexport const translate = function translate( x, y, z )\r\n{\r\n    if ( Array.isArray(x) && x.length == 3 ) {\r\n        z = x[2];\r\n        y = x[1];\r\n        x = x[0];\r\n    }\r\n\r\n    var result = mat4();\r\n    result[0][3] = x;\r\n    result[1][3] = y;\r\n    result[2][3] = z;\r\n\r\n    return result;\r\n}\r\n\r\nexport const rotate = function rotate( angle, axis )\r\n{\r\n    if ( !Array.isArray(axis) ) {\r\n        axis = [ arguments[1], arguments[2], arguments[3] ];\r\n    }\r\n\r\n    var v = normalize( axis );\r\n\r\n    var x = v[0];\r\n    var y = v[1];\r\n    var z = v[2];\r\n\r\n    var c = Math.cos( radians(angle) );\r\n    var omc = 1.0 - c;\r\n    var s = Math.sin( radians(angle) );\r\n\r\n    var result = mat4(\r\n        vec4( x*x*omc + c,   x*y*omc - z*s, x*z*omc + y*s, 0.0 ),\r\n        vec4( x*y*omc + z*s, y*y*omc + c,   y*z*omc - x*s, 0.0 ),\r\n        vec4( x*z*omc - y*s, y*z*omc + x*s, z*z*omc + c,   0.0 ),\r\n        vec4()\r\n    );\r\n\r\n    return result;\r\n}\r\n\r\nexport const rotateX = function rotateX(theta) {\r\n  var c = Math.cos( radians(theta) );\r\n  var s = Math.sin( radians(theta) );\r\n  var rx = mat4( 1.0,  0.0,  0.0, 0.0,\r\n      0.0,  c,  -s, 0.0,\r\n      0.0, s,  c, 0.0,\r\n      0.0,  0.0,  0.0, 1.0 );\r\n  return rx;\r\n}\r\nexport const rotateY = function rotateY(theta) {\r\n  var c = Math.cos( radians(theta) );\r\n  var s = Math.sin( radians(theta) );\r\n  var ry = mat4( c, 0.0, s, 0.0,\r\n      0.0, 1.0,  0.0, 0.0,\r\n      -s, 0.0,  c, 0.0,\r\n      0.0, 0.0,  0.0, 1.0 );\r\n  return ry;\r\n}\r\nexport const rotateZ = function rotateZ(theta) {\r\n  var c = Math.cos( radians(theta) );\r\n  var s = Math.sin( radians(theta) );\r\n  var rz = mat4( c, -s, 0.0, 0.0,\r\n      s,  c, 0.0, 0.0,\r\n      0.0,  0.0, 1.0, 0.0,\r\n      0.0,  0.0, 0.0, 1.0 );\r\n  return rz;\r\n}\r\n\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const scalem = function scalem( x, y, z )\r\n{\r\n    if ( Array.isArray(x) && x.length == 3 ) {\r\n        z = x[2];\r\n        y = x[1];\r\n        x = x[0];\r\n    }\r\n\r\n    var result = mat4();\r\n    result[0][0] = x;\r\n    result[1][1] = y;\r\n    result[2][2] = z;\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  ModelView Matrix Generators\r\n//\r\n\r\nexport const lookAt = function lookAt( eye, at, up )\r\n{\r\n    if ( !Array.isArray(eye) || eye.length != 3) {\r\n        throw \"lookAt(): first parameter [eye] must be an a vec3\";\r\n    }\r\n\r\n    if ( !Array.isArray(at) || at.length != 3) {\r\n        throw \"lookAt(): first parameter [at] must be an a vec3\";\r\n    }\r\n\r\n    if ( !Array.isArray(up) || up.length != 3) {\r\n        throw \"lookAt(): first parameter [up] must be an a vec3\";\r\n    }\r\n\r\n    if ( equal(eye, at) ) {\r\n        return mat4();\r\n    }\r\n\r\n    var v = normalize( subtract(at, eye) );  // view direction vector\r\n    var n = normalize( cross(v, up) );       // perpendicular vector\r\n    var u = normalize( cross(n, v) );        // \"new\" up vector\r\n\r\n    v = negate( v );\r\n\r\n    var result = mat4(\r\n        vec4( n, -dot(n, eye) ),\r\n        vec4( u, -dot(u, eye) ),\r\n        vec4( v, -dot(v, eye) ),\r\n        vec4()\r\n    );\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  Projection Matrix Generators\r\n//\r\n\r\nexport const ortho = function ortho( left, right, bottom, top, near, far )\r\n{\r\n    if ( left == right ) { throw \"ortho(): left and right are equal\"; }\r\n    if ( bottom == top ) { throw \"ortho(): bottom and top are equal\"; }\r\n    if ( near == far )   { throw \"ortho(): near and far are equal\"; }\r\n\r\n    var w = right - left;\r\n    var h = top - bottom;\r\n    var d = far - near;\r\n\r\n    var result = mat4();\r\n    result[0][0] = 2.0 / w;\r\n    result[1][1] = 2.0 / h;\r\n    result[2][2] = -2.0 / d;\r\n    result[0][3] = -(left + right) / w;\r\n    result[1][3] = -(top + bottom) / h;\r\n    result[2][3] = -(near + far) / d;\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const perspective = function perspective( fovy, aspect, near, far )\r\n{\r\n    var f = 1.0 / Math.tan( radians(fovy) / 2 );\r\n    var d = far - near;\r\n\r\n    var result = mat4();\r\n    result[0][0] = f / aspect;\r\n    result[1][1] = f;\r\n    result[2][2] = -(near + far) / d;\r\n    result[2][3] = -2 * near * far / d;\r\n    result[3][2] = -1;\r\n    result[3][3] = 0.0;\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  Matrix Functions\r\n//\r\n\r\nexport const transpose = function transpose( m )\r\n{\r\n    if ( !m.matrix ) {\r\n        return \"transpose(): trying to transpose a non-matrix\";\r\n    }\r\n\r\n    var result = [];\r\n    for ( var i = 0; i < m.length; ++i ) {\r\n        result.push( [] );\r\n        for ( var j = 0; j < m[i].length; ++j ) {\r\n            result[i].push( m[j][i] );\r\n        }\r\n    }\r\n\r\n    result.matrix = true;\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  Vector Functions\r\n//\r\n\r\nexport const dot = function dot( u, v )\r\n{\r\n    if ( u.length != v.length ) {\r\n        throw \"dot(): vectors are not the same dimension\";\r\n    }\r\n\r\n    var sum = 0.0;\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        sum += u[i] * v[i];\r\n    }\r\n\r\n    return sum;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const negate = function negate( u )\r\n{\r\n    var result = [];\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        result.push( -u[i] );\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const cross = function cross( u, v )\r\n{\r\n    if ( !Array.isArray(u) || u.length < 3 ) {\r\n        throw \"cross(): first argument is not a vector of at least 3\";\r\n    }\r\n\r\n    if ( !Array.isArray(v) || v.length < 3 ) {\r\n        throw \"cross(): second argument is not a vector of at least 3\";\r\n    }\r\n\r\n    var result = [\r\n        u[1]*v[2] - u[2]*v[1],\r\n        u[2]*v[0] - u[0]*v[2],\r\n        u[0]*v[1] - u[1]*v[0]\r\n    ];\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const length = function length( u )\r\n{\r\n    return Math.sqrt( dot(u, u) );\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const normalize = function normalize( u, excludeLastComponent )\r\n{\r\n    if ( excludeLastComponent ) {\r\n        var last = u.pop();\r\n    }\r\n\r\n    var len = length( u );\r\n\r\n    if ( !isFinite(len) ) {\r\n        throw \"normalize: vector \" + u + \" has zero length\";\r\n    }\r\n\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        u[i] /= len;\r\n    }\r\n\r\n    if ( excludeLastComponent ) {\r\n        u.push( last );\r\n    }\r\n\r\n    return u;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const mix = function mix( u, v, s )\r\n{\r\n    if ( typeof s !== \"number\" ) {\r\n        throw \"mix: the last paramter \" + s + \" must be a number\";\r\n    }\r\n\r\n    if ( u.length != v.length ) {\r\n        throw \"vector dimension mismatch\";\r\n    }\r\n\r\n    var result = [];\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        result.push( (1.0 - s) * u[i] + s * v[i] );\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n// Vector and Matrix functions\r\n//\r\n\r\nexport const scale = function scale( s, u )\r\n{\r\n    if ( !Array.isArray(u) ) {\r\n        throw \"scale: second parameter \" + u + \" is not a vector\";\r\n    }\r\n\r\n    var result = [];\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        result.push( s * u[i] );\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//\r\n//\r\n\r\nexport const flatten = function flatten( v )\r\n{\r\n    if ( v.matrix === true ) {\r\n        v = transpose( v );\r\n    }\r\n\r\n    var n = v.length;\r\n    var elemsAreArrays = false;\r\n\r\n    if ( Array.isArray(v[0]) ) {\r\n        elemsAreArrays = true;\r\n        n *= v[0].length;\r\n    }\r\n\r\n    var floats = new Float32Array( n );\r\n\r\n    if ( elemsAreArrays ) {\r\n        var idx = 0;\r\n        for ( var i = 0; i < v.length; ++i ) {\r\n            for ( var j = 0; j < v[i].length; ++j ) {\r\n                floats[idx++] = v[i][j];\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        for ( var i = 0; i < v.length; ++i ) {\r\n            floats[i] = v[i];\r\n        }\r\n    }\r\n\r\n    return floats;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nvar sizeof = {\r\n    'vec2' : new Float32Array( flatten(vec2()) ).byteLength,\r\n    'vec3' : new Float32Array( flatten(vec3()) ).byteLength,\r\n    'vec4' : new Float32Array( flatten(vec4()) ).byteLength,\r\n    'mat2' : new Float32Array( flatten(mat2()) ).byteLength,\r\n    'mat3' : new Float32Array( flatten(mat3()) ).byteLength,\r\n    'mat4' : new Float32Array( flatten(mat4()) ).byteLength\r\n};\r\n\r\n// new functions 5/2/2015\r\n\r\n// printing\r\n\r\nexport const printm = function printm(m)\r\n{\r\n    if(m.length == 2)\r\n    for(var i=0; i<m.length; i++)\r\n       console.log(m[i][0], m[i][1]);\r\n    else if(m.length == 3)\r\n    for(var i=0; i<m.length; i++)\r\n       console.log(m[i][0], m[i][1], m[i][2]);\r\n    else if(m.length == 4)\r\n    for(var i=0; i<m.length; i++)\r\n       console.log(m[i][0], m[i][1], m[i][2], m[i][3]);\r\n}\r\n// determinants\r\n\r\nexport const det2 = function det2(m)\r\n{\r\n\r\n     return m[0][0]*m[1][1]-m[0][1]*m[1][0];\r\n\r\n}\r\n\r\nexport const det3 = function det3(m)\r\n{\r\n     var d = m[0][0]*m[1][1]*m[2][2]\r\n           + m[0][1]*m[1][2]*m[2][0]\r\n           + m[0][2]*m[2][1]*m[1][0]\r\n           - m[2][0]*m[1][1]*m[0][2]\r\n           - m[1][0]*m[0][1]*m[2][2]\r\n           - m[0][0]*m[1][2]*m[2][1]\r\n           ;\r\n     return d;\r\n}\r\n\r\nexport const det4 = function det4(m)\r\n{\r\n     var m0 = [\r\n         vec3(m[1][1], m[1][2], m[1][3]),\r\n         vec3(m[2][1], m[2][2], m[2][3]),\r\n         vec3(m[3][1], m[3][2], m[3][3])\r\n     ];\r\n     var m1 = [\r\n         vec3(m[1][0], m[1][2], m[1][3]),\r\n         vec3(m[2][0], m[2][2], m[2][3]),\r\n         vec3(m[3][0], m[3][2], m[3][3])\r\n     ];\r\n     var m2 = [\r\n         vec3(m[1][0], m[1][1], m[1][3]),\r\n         vec3(m[2][0], m[2][1], m[2][3]),\r\n         vec3(m[3][0], m[3][1], m[3][3])\r\n     ];\r\n     var m3 = [\r\n         vec3(m[1][0], m[1][1], m[1][2]),\r\n         vec3(m[2][0], m[2][1], m[2][2]),\r\n         vec3(m[3][0], m[3][1], m[3][2])\r\n     ];\r\n     return m[0][0]*det3(m0) - m[0][1]*det3(m1)\r\n         + m[0][2]*det3(m2) - m[0][3]*det3(m3);\r\n\r\n}\r\n\r\nexport const det = function det(m)\r\n{\r\n     if(m.matrix != true) console.log(\"not a matrix\");\r\n     if(m.length == 2) return det2(m);\r\n     if(m.length == 3) return det3(m);\r\n     if(m.length == 4) return det4(m);\r\n}\r\n\r\n//---------------------------------------------------------\r\n\r\n// inverses\r\n\r\nexport const inverse2 = function inverse2(m)\r\n{\r\n     var a = mat2();\r\n     var d = det2(m);\r\n     a[0][0] = m[1][1]/d;\r\n     a[0][1] = -m[0][1]/d;\r\n     a[1][0] = -m[1][0]/d;\r\n     a[1][1] = m[0][0]/d;\r\n     a.matrix = true;\r\n     return a;\r\n}\r\n\r\nexport const inverse3 = function inverse3(m)\r\n{\r\n    var a = mat3();\r\n    var d = det3(m);\r\n\r\n    var a00 = [\r\n       vec2(m[1][1], m[1][2]),\r\n       vec2(m[2][1], m[2][2])\r\n    ];\r\n    var a01 = [\r\n       vec2(m[1][0], m[1][2]),\r\n       vec2(m[2][0], m[2][2])\r\n    ];\r\n    var a02 = [\r\n       vec2(m[1][0], m[1][1]),\r\n       vec2(m[2][0], m[2][1])\r\n    ];\r\n    var a10 = [\r\n       vec2(m[0][1], m[0][2]),\r\n       vec2(m[2][1], m[2][2])\r\n    ];\r\n    var a11 = [\r\n       vec2(m[0][0], m[0][2]),\r\n       vec2(m[2][0], m[2][2])\r\n    ];\r\n    var a12 = [\r\n       vec2(m[0][0], m[0][1]),\r\n       vec2(m[2][0], m[2][1])\r\n    ];\r\n    var a20 = [\r\n       vec2(m[0][1], m[0][2]),\r\n       vec2(m[1][1], m[1][2])\r\n    ];\r\n    var a21 = [\r\n       vec2(m[0][0], m[0][2]),\r\n       vec2(m[1][0], m[1][2])\r\n    ];\r\n    var a22 = [\r\n       vec2(m[0][0], m[0][1]),\r\n       vec2(m[1][0], m[1][1])\r\n    ];\r\n\r\n   a[0][0] = det2(a00)/d;\r\n   a[0][1] = -det2(a10)/d;\r\n   a[0][2] = det2(a20)/d;\r\n   a[1][0] = -det2(a01)/d;\r\n   a[1][1] = det2(a11)/d;\r\n   a[1][2] = -det2(a21)/d;\r\n   a[2][0] = det2(a02)/d;\r\n   a[2][1] = -det2(a12)/d;\r\n   a[2][2] = det2(a22)/d;\r\n\r\n   return a;\r\n\r\n}\r\n\r\nexport const inverse4 = function inverse4(m)\r\n{\r\n    var a = mat4();\r\n    var d = det4(m);\r\n\r\n    var a00 = [\r\n       vec3(m[1][1], m[1][2], m[1][3]),\r\n       vec3(m[2][1], m[2][2], m[2][3]),\r\n       vec3(m[3][1], m[3][2], m[3][3])\r\n    ];\r\n    var a01 = [\r\n       vec3(m[1][0], m[1][2], m[1][3]),\r\n       vec3(m[2][0], m[2][2], m[2][3]),\r\n       vec3(m[3][0], m[3][2], m[3][3])\r\n    ];\r\n    var a02 = [\r\n       vec3(m[1][0], m[1][1], m[1][3]),\r\n       vec3(m[2][0], m[2][1], m[2][3]),\r\n       vec3(m[3][0], m[3][1], m[3][3])\r\n    ];\r\n    var a03 = [\r\n       vec3(m[1][0], m[1][1], m[1][2]),\r\n       vec3(m[2][0], m[2][1], m[2][2]),\r\n       vec3(m[3][0], m[3][1], m[3][2])\r\n    ];\r\n    var a10 = [\r\n       vec3(m[0][1], m[0][2], m[0][3]),\r\n       vec3(m[2][1], m[2][2], m[2][3]),\r\n       vec3(m[3][1], m[3][2], m[3][3])\r\n    ];\r\n    var a11 = [\r\n       vec3(m[0][0], m[0][2], m[0][3]),\r\n       vec3(m[2][0], m[2][2], m[2][3]),\r\n       vec3(m[3][0], m[3][2], m[3][3])\r\n    ];\r\n    var a12 = [\r\n       vec3(m[0][0], m[0][1], m[0][3]),\r\n       vec3(m[2][0], m[2][1], m[2][3]),\r\n       vec3(m[3][0], m[3][1], m[3][3])\r\n    ];\r\n    var a13 = [\r\n       vec3(m[0][0], m[0][1], m[0][2]),\r\n       vec3(m[2][0], m[2][1], m[2][2]),\r\n       vec3(m[3][0], m[3][1], m[3][2])\r\n    ];\r\n    var a20 = [\r\n       vec3(m[0][1], m[0][2], m[0][3]),\r\n       vec3(m[1][1], m[1][2], m[1][3]),\r\n       vec3(m[3][1], m[3][2], m[3][3])\r\n    ];\r\n    var a21 = [\r\n       vec3(m[0][0], m[0][2], m[0][3]),\r\n       vec3(m[1][0], m[1][2], m[1][3]),\r\n       vec3(m[3][0], m[3][2], m[3][3])\r\n    ];\r\n    var a22 = [\r\n       vec3(m[0][0], m[0][1], m[0][3]),\r\n       vec3(m[1][0], m[1][1], m[1][3]),\r\n       vec3(m[3][0], m[3][1], m[3][3])\r\n    ];\r\n    var a23 = [\r\n       vec3(m[0][0], m[0][1], m[0][2]),\r\n       vec3(m[1][0], m[1][1], m[1][2]),\r\n       vec3(m[3][0], m[3][1], m[3][2])\r\n    ];\r\n\r\n    var a30 = [\r\n       vec3(m[0][1], m[0][2], m[0][3]),\r\n       vec3(m[1][1], m[1][2], m[1][3]),\r\n       vec3(m[2][1], m[2][2], m[2][3])\r\n    ];\r\n    var a31 = [\r\n       vec3(m[0][0], m[0][2], m[0][3]),\r\n       vec3(m[1][0], m[1][2], m[1][3]),\r\n       vec3(m[2][0], m[2][2], m[2][3])\r\n    ];\r\n    var a32 = [\r\n       vec3(m[0][0], m[0][1], m[0][3]),\r\n       vec3(m[1][0], m[1][1], m[1][3]),\r\n       vec3(m[2][0], m[2][1], m[2][3])\r\n    ];\r\n    var a33 = [\r\n       vec3(m[0][0], m[0][1], m[0][2]),\r\n       vec3(m[1][0], m[1][1], m[1][2]),\r\n       vec3(m[2][0], m[2][1], m[2][2])\r\n    ];\r\n\r\n\r\n\r\n   a[0][0] = det3(a00)/d;\r\n   a[0][1] = -det3(a10)/d;\r\n   a[0][2] = det3(a20)/d;\r\n   a[0][3] = -det3(a30)/d;\r\n   a[1][0] = -det3(a01)/d;\r\n   a[1][1] = det3(a11)/d;\r\n   a[1][2] = -det3(a21)/d;\r\n   a[1][3] = det3(a31)/d;\r\n   a[2][0] = det3(a02)/d;\r\n   a[2][1] = -det3(a12)/d;\r\n   a[2][2] = det3(a22)/d;\r\n   a[2][3] = -det3(a32)/d;\r\n   a[3][0] = -det3(a03)/d;\r\n   a[3][1] = det3(a13)/d;\r\n   a[3][2] = -det3(a23)/d;\r\n   a[3][3] = det3(a33)/d;\r\n\r\n   return a;\r\n}\r\nexport const inverse = function inverse(m)\r\n{\r\n   if(m.matrix != true) console.log(\"not a matrix\");\r\n   if(m.length == 2) return inverse2(m);\r\n   if(m.length == 3) return inverse3(m);\r\n   if(m.length == 4) return inverse4(m);\r\n}\r\n\r\nexport const normalMatrix = function normalMatrix(m, flag)\r\n{\r\n    var a = mat4();\r\n    a = inverse(transpose(m));\r\n    if(flag != true) return a;\r\n    else {\r\n    var b = mat3();\r\n    for(var i=0;i<3;i++) for(var j=0; j<3; j++) b[i][j] = a[i][j];\r\n    return b;\r\n    }\r\n\r\n}\r\n","import { vec3, perspective, ortho, lookAt, scale, add, subtract, normalize, cross } from \"./Utils/Vector_Matrix\";\n\n/**\n * @author Alberto Contorno\n * @class\n * It represents a Camera that can be used in a Scene. \n * It provides methods to move and rotate the camera and \n * default view matrices ('ortho', 'perspective').\n */\nexport class Camera{\n  static nextId = 1;\n\n  position = vec3(0, 0, 0);\n  rotation = vec3(0, 0, 0);\n  \n  up = vec3(0,1,0);\n  right;\n  direction = vec3(0, 0, 0);\n  front = vec3(0, 0, 0);\n  \n  proj;\n  type = 'perspective';\n\n  yaw = 0;\n  pitch = 0;\n\n  zoomLevel = 2;\n  zooms;\n  sensitivity = 1;\n  speed = 1;\n\n  currX; currY; lastX; lastY;\n  \n  moveKeys = {forward: 'w', backward: 's', right: 'd', left: 'a' };\n\n  updateCameraDirection;\n  updateCameraPos;\n  inputs;\n  time;\n  //per ortho left = -1.0; right = 1.0; ytop = 1.0; bottom = -1.0;\n  \n  /**\n   * \n   * @param {vec3} position The initial position of the camera.\n   * @param {vec3} up The up vector of the camera\n   * @param {number} speed The movement speed of the camera used if the camera is moved with the inner methods.\n   * @param {string} type The type of the camera. Must be 'ortho' or 'perspective'.\n   * @param {object} moveKeys TO BE DEFINED\n   * @param {object} projOptions Options object for more configurations (TO BE DEFINED)\n   * @param {number} sensitivity The turn speed used to update the direction of the camera by the inner method.\n   * @param {object} zooms An object containing all the zoom levels in the form {0: fov0, 1: fov1} (only for 'perspective' cameras)\n   */\n  constructor(position, up, speed, type, moveKeys, projOptions, sensitivity, zooms){\n    Camera.nextId++;\n    this.id = Camera.nextId;\n    this.sensitivity = sensitivity;\n    this.speed = speed;\n    this.position = position;\n    this.type = type;\n    this.projOptions = projOptions;\n    this.zooms = zooms;\n    window.addEventListener(\"wheel\", event => {\n      this.zoomLevel += Math.sign(event.deltaY);\n      this.zoomLevel = Math.clamp(this.zoomLevel, 0, this.zooms.maxLevel);\n      this.setZoomLevel(this.zoomLevel);\n    });\n    if(type && type === 'perspective'){\n      this.proj = perspective(this.projOptions.fov, this.projOptions.aspect, this.projOptions.near, this.projOptions.far);\n      this.updateCameraDirection = this._updateCameraDirection;\n      //this.updateCameraPos = this._updateCameraPos;\n    } else if (type && type === 'orthographic'){\n      this.proj = ortho(this.projOptions.left, this.projOptions.right, this.projOptions.bottom, this.projOptions.ytop, this.projOptions.near, this.projOptions.far);\n      this.updateCameraDirection = this._updateCameraDirection;\n    }\n  }\n\n  /**\n   * Return the Projection Matrix of the camera.\n   */\n  getProjectionMatrix(){\n    return this.proj;\n  }\n\n  /**\n   * Return the front vector of the camera;\n   */\n  getFrontVector(){\n    return vec3(\n      this.position[0] + this.direction[0],\n      this.position[1] + this.direction[1],\n      this.position[2] + this.direction[2]\n    );\n  }\n/**\n * Return the View Matrix of the camera.\n */\n  getViewMatrix(){\n    return lookAt(this.getFrontVector(), this.position, this.up);\n  }\n/**\n * It updates the direction of the camera.\n * @param {number} offsetX Offset on X direction to update the yaw of the camera (i.e. how much the camera must turn to the rigth/left)\n * @param {number} offsetY Offset on Y direction to update the pitch of the camera (i.e. how much the camera must turn up/down)\n * @param {number} deltaTime The delta time used to scale the quantities of the movements to make everything indipendent from the frame rate\n */\n  _updateCameraDirection(offsetX, offsetY, deltaTime) {\n    offsetX *= this.sensitivity * deltaTime;\n    offsetY *= this.sensitivity * deltaTime;\n    this.yaw += offsetX;\n    this.pitch += offsetY;\n\n    if (this.pitch > 89.0) { this.pitch = 89.0; }\n    if (this.pitch < -89.0) { this.pitch = -89.0;}\n    this.direction = vec3(\n      Math.cos(Math.radians(this.pitch)) * Math.cos(Math.radians(this.yaw)),\n      Math.sin(Math.radians(this.pitch)),\n      Math.cos(Math.radians(this.pitch)) * Math.sin(Math.radians(this.yaw))\n    );\n  }\n\n  /**\n   * Set a new position for the camera.\n   * @param {vec3} newPos A vector of 3 components (x,y,z) representing the new positon of the camera in the world\n   */\n  _updateCameraPos(newPos){\n    this.position = vec3(newPos[0], newPos[1], 0.0);\n  }\n  /**\n   * Move the camera forward with respect to the current looking direction, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveForward(deltaTime){\n    this.position = subtract(\n      this.position, scale(this.speed * deltaTime, this.direction)\n    );\n  }\n  /**\n   * Move the camera backwards with respect to the current looking direction, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveBackwards(deltaTime){\n    this.position = add(\n      this.position, scale(this.speed * deltaTime, this.direction)\n    );\n  }\n  /**\n   * Move the camera to the left with respect to the current looking direction, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveLeft(deltaTime){\n    this.position = add(\n      this.position, scale(this.speed * deltaTime, normalize(cross(this.direction, this.up)))\n    );\n  }\n  /**\n   * Move the camera to the left with respect to the current looking direction, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveRight(deltaTime){\n    this.position = subtract(\n      this.position, scale(this.speed * deltaTime, normalize(cross(this.direction, this.up)))\n    );\n  }\n  /**\n   * Move the camera up, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveUp(deltaTime){\n    this.position =  add(\n      this.position, scale(this.speed * deltaTime, vec3(0, 1, 0))\n    );\n  }\n  /**\n   * Move the camera down, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveDown(deltaTime){\n    this.position = subtract(\n      this.position, scale(this.speed * deltaTime, vec3(0, 1, 0))\n      );\n\n  }\n  /**\n   * Set the configuration of the levels of zooms. Only for perspective cameras.\n   * @param {object} zooms - An object of configuration. It must contains a maxLevel zoom, and a key[int]-value[int] pair for every level of zoom, indicating\n   * as a key the level (an integer starting from 0 and incremented by 1 for every zoom level) and as a value the fov associated.\n   * @example\n   * { maxLevel: 3, 0: 30, 1: 45, 2: 75, 3: 90 },\n   */\n  setZoomLevels(zooms){\n    this.zooms = zooms;\n  }\n  /**\n   * Set the current level of zoom to be used, if applicable on the base of the zooms configuration.\n   * @param {*} level The chosen level of zoom.\n   */\n  setZoomLevel(level){\n    this.zoomLevel = level;\n    if(this.zooms){\n      this.projOptions.fov = this.zooms[this.zoomLevel] || 45;\n    } else {\n      this.projOptions.fov = 45;\n    }\n    this.proj = perspective(this.projOptions.fov, this.projOptions.aspect, this.projOptions.near, this.projOptions.far);\n  }\n  \n}","import { Transform } from './Components/Transform';\nimport { registeredComponents, Component } from './Component';\nimport { Camera } from './Camera';\n\n/**\n * @author Alberto Contorno\n * @class\n */\nexport class SceneObject{\n  static nextId = 1;\n  id;\n  scene;\n  components = {};\n  transform;\n  meshes = []; //model\n  children = [];\n  parent;\n  material;\n  name;\n\n  onStart = () => {};\n\n  onUpdate = () => {};\n\n  onDestroy = () => {};\n\n  constructor(startCallback, name){ \n    this.name =name;\n    SceneObject.nextId++;\n    this.id = SceneObject.nextId;\n    this.onStart = startCallback;\n    this.transform = this.components['transform'] = new Transform(this);\n  }\n  \n  addMesh(mesh){\n    for (let m of this.meshes) {\n      if (m.id === mesh.id) {\n        console.warning('[WARNING - Object](addMesh) - Added mesh is already present.');\n        return;\n      }\n    }\n    this.meshes.push(mesh);\n  }\n\n  addChild(child){\n    this.children.push(child);\n    child.parent = this;\n  }\n\n  getTransformToRender(){\n    let transformToRender;\n    if (this.parent) {\n      transformToRender = Transform.summed(this.transform, this.parent.getTransformToRender())\n    } else {\n      transformToRender = this.transform;\n    }\n\n    return transformToRender;\n  }\n\n  /**\n   * \n   * @param {GL_CONTEXT} gl \n   * @param {Camera} camera \n   * @param {*} lights \n   */\n  render(gl, camera, lights, lightsTypes){\n    //obj passes position, rotation and scaling\n    for(let mesh of this.meshes){\n      let transformToRender = this.getTransformToRender();\n      mesh.render(gl, camera, this, this.type, this.material, lights, lightsTypes, this.name);\n      //mesh.renderDefault(gl, camera, this, this.type, this.material, lights, defaultShader, locs)\n    }\n  }\n\n  /**\n   * \n   * @param {Component} component \n   */\n  addComponent(component){\n    if (!component) {\n      console.warn('[WARNING - SCENE_OBJECT](addComponent) - Trying to add a component but no component provided.');\n      return;\n    }\n    this.components[component.name] = component;\n    component.parent = this;\n    component.onAfterAdded(this, this.scene);\n  }\n\n  /**\n   * \n   * @param {Component} component \n   */\n  removeComponent(component){\n    if(!component){\n      console.warn('[WARNING - SCENE_OBJECT](addComponent) - Trying to add a component but no component provided.');\n      return;\n    }\n    this.components[component.name] = null;\n    component.parent = null;\n    component.onAfterRemoved(this, this.scene);\n  }\n\n}","import { SceneObject } from \"./Object\";\nimport { Camera } from \"./Camera\";\n\n/**\n * @author Alberto Contorno\n * @class\n * Class that represents a Scene. \n * A Scene is a container to render and manage objects.\n * Moreover it has an array of cameras that can be used, of which, one is the main camera used to render.\n */\nexport class Scene{\n  static nextId = 1;\n  id;\n  objects = [];\n  objectsMap = {};\n  cameras = [];\n  mainCamera;\n  lights = [];\n  lightsTypes = {};\n  defaultShaders = {vertex: null, fragment: null, program: null};\n  defaultLocations = {};\n  emptyTextures;\n  engine;\n\n  constructor(){\n    Scene.nextId++;\n    this.id = Scene.nextId;\n  }\n\n  onAfterSceneAdded(engine){\n    this.engine = engine;\n    //this.setupDefaultShaders();\n  }\n\n  /**\n   * \n   * @param {Camera} camera \n   */\n  addCamera(camera){\n    for(let cam of this.cameras){\n      if(cam.id === camera.id){\n        console.warn('[WARNING - SCENE](addCamera) - Added camera is already present.');\n        return;\n      }\n    }\n    this.cameras.push(camera);\n    if(!this.mainCamera){\n      this.mainCamera = camera;\n    }\n  }\n\n  /**\n   * \n   * @param {Camera} camera \n   */\n  setMainCamera(camera){\n    this.mainCamera = camera;\n    let alreadyPresent = false;\n    for (let cam of this.cameras) {\n      if (cam.id === camera.id) {\n        alreadyPresent = true;\n        break;\n      }\n    }\n    if(!alreadyPresent){\n      this.cameras.push(camera);\n    }\n  }\n\n  /**\n   * \n   * @param {SceneObject} obj \n   */\n  addObject(obj){\n    this.objects.push(obj);\n    obj.scene = this;\n    this.objectsMap[obj.id] = this.objects.length - 1;\n  }\n\n  /**\n   * \n   * @param {SceneObject} obj \n   */\n  removeObject(obj){\n    if(typeof obj === 'object'){\n      if (this.objectsMap[this.objectsMap[obj.id]] != null){\n        this.objects[this.objectsMap[obj.id]] = null;\n        this.objectsMap[this.objectsMap[obj.id]] = null;\n      }\n    } else if (typeof obj === 'number'){\n      if (this.objects[obj] != null){\n        this.objects[obj] = null;\n      }\n    }\n  }\n\n  registerLight(type, light){\n    this.lights.push({ parentObj: light.parent, type, light });\n    this.lightsTypes[type] = this.lightsTypes[type] ? this.lightsTypes[type] + 1 : 1;\n    // TODO Recompute shader\n  }\n\n  unregisterLight(type, light){\n    if (!light){\n      console.warn('[WARNING - SCENE](unregisterLight) - Trying to unregister a light but no light is provided.')\n    }\n    let lightIndex = this.lights.findIndex( el => el.id = light.id);\n    if (lightIndex >= 0){\n      this.lights[lightIndex].parentObj = null;\n      this.lights[lightIndex].light = null;\n      this.lightsTypes[type] = this.lightsTypes[type] ? this.lightsTypes[type] - 1 : 0;\n      this.lights.splice(lightIndex, 1);\n      //TODO Recompute shader\n    } else {\n      console.warn('[WARNING - SCENE](unregisterLight) - Trying to unregister a light that is not registered into the scene.');\n    }\n  }\n\n  renderScene(gl){\n    for (let obj of this.objects) {\n      obj.onUpdate();\n      obj.render(gl, this.mainCamera, this.lights, this.lightsTypes);\n    }\n  }\n\n\n}","\nimport {ShaderUtils} from './shadersUtils';\n\n/**\n * @author Alberto Contorno\n * @class\n */\nexport class Shader{\n    static nextId = 1;\n\n    type;\n    source;\n    id;\n    errors = [];\n    shader;\n    constructor(gl, type, source){\n      Shader.nextId++;\n      this.id = Shader.nextId;\n      this.type = (type === 'vertex') ? gl.VERTEX_SHADER : gl.FRAGMENT_SHADER;\n      this.shader = ShaderUtils.loadAndCompileShader(this.type, source);\n      this.source = source;\n      let shaderError = ShaderUtils.checkShaderCompilingErrors(this.shader);\n      if (shaderError) { \n        console.log(\"err\",shaderError);\n        this.errors.push(shaderError); \n      }\n    }\n\n    equals(other){\n      return this.id === other.id;\n    }\n\n    destroy(gl){\n\n    }\n    \n}","/**\n * @author Alberto Contorno\n * @class\n */\nimport { ShaderUtils } from './shadersUtils';\n\nexport class ShaderProgram{\n  static nextId = 1;\n  program;\n  errors = [];\n  constructor(gl, shaders){\n    ShaderProgram.nextId++;\n    this.id = ShaderProgram.nextId;\n    this.program = ShaderUtils.createShaderProgramFromShaders(shaders);\n    let shaderError = ShaderUtils.checkShaderProgramLinkingErrors(this.program);\n    if (shaderError) { \n      console.log('err prog',shaderError);\n      this.errors.push(shaderError) \n    }\n  }\n}","import {vec2, vec3, vec4} from \"./Vector_Matrix\";\r\n\r\nexport const LightTypes = {\r\n    DirectionalLight: 'DIRECTIONAL_LIGHT',\r\n    PointLight: 'POINTLIGHT',\r\n    SpotLight: 'SPOTLIGHT'\r\n}\r\n\r\nexport const TextureTypes = {\r\n    DiffuseMap: 'DIFFUSE_MAP',\r\n    SpecularMap: 'SPECULAR_MAP',\r\n    NormalMap: 'NORMAL_MAP',\r\n    LightMap: 'LIGHT_MAP',\r\n    BumpMap: 'BUMP_MAP',\r\n    ShadowMap: 'SHADOW_MAP'\r\n}\r\n\r\nexport const EmptyTexture = {\r\n    level: 0,\r\n    width:1,\r\n    height: 1,\r\n    border: 0,\r\n    srcFormat: 'RGBA',\r\n    internalFormat: 'RGBA',\r\n    srcType: 'UNSIGNED_BYTE',\r\n    pixels: new Uint8Array([255, 255, 255, 255])\r\n}\r\nexport const DefTextCoords = vec2(0,0);\r\n","export const vDiffuseCoords_In = 'in vec2 vDiffuseTextCoords;\\n';\r\nexport const vSpecularCoords_In = 'in vec2 vSpecularTextCoords;\\n';\r\nexport const vLightCoords_In = 'in vec2 vLightTextCoords;\\n';\r\nexport const vBumpCoords_In = 'in vec2 vBumpTextCoords;\\n';\r\nexport const vShadowCoords_In = 'in vec2 vShadowTextCoords;\\n';\r\nexport const vNormalCoords_In = 'in vec2 vNormalTextCoords;\\n';\r\n\r\nexport const vDiffuseCoords_Out = 'out vec2 fDiffuseTextCoords;\\n';\r\nexport const vSpecularCoords_Out = 'out vec2 fSpecularTextCoords;\\n';\r\nexport const vLightCoords_Out = 'out vec2 fLightTextCoords;\\n';\r\nexport const vBumpCoords_Out = 'out vec2 fBumpTextCoords;\\n';\r\nexport const vShadowCoords_Out = 'out vec2 fShadowTextCoords;\\n';\r\nexport const vNormalCoords_Out = 'out vec2 fNormalTextCoords;\\n';\r\n\r\nexport const vDiffuseCoords_Assign = '\\tfDiffuseTextCoords = vDiffuseTextCoords;\\n';\r\nexport const vSpecularCoords_Assign = '\\tfDiffuseTextCoords = vDiffuseTextCoords;\\n';\r\nexport const vLightCoords_Assign = '\\tfDiffuseTextCoords = vDiffuseTextCoords;\\n';\r\nexport const vBumpCoords_Assign = '\\tfDiffuseTextCoords = vDiffuseTextCoords;\\n';\r\nexport const vShadowCoords_Assign = '\\tfDiffuseTextCoords = vDiffuseTextCoords;\\n';\r\nexport const vNormalCoords_Assign = '\\tfDiffuseTextCoords = vDiffuseTextCoords;\\n';\r\n\r\nexport const vertexCompleteShaderObj = () =>({\r\n  version: \"#version 300 es\\n\",\r\n  position: \"in vec4 vPosition;\\n\",\r\n  diffuseCoordsIn: '',\r\n  diffuseCoordsOut: '',\r\n  specularCoordsIn: '',\r\n  specularCoordsOut: '',\r\n  normalCoordsIn: '',\r\n  normalCoordsOut: '',\r\n  normalIn: \"in vec3 vNormal;\\n\",\r\n  modelViewProj: \"uniform mat4 model;\\nuniform mat4 view;\\nuniform mat4 projection;\\n\",\r\n  colorOut: \"out vec4 fColor;\\n\",\r\n  normalOut: \"out vec3 fNormal;\\n\",\r\n  fragPosOut: \"out vec3 fPos;\\n\",\r\n  mainStart: \"void main(){\\n\",\r\n  mainBody: \"\\tfColor = vPosition;\\n\"+\r\n  \"\\tfNormal = mat3(transpose(inverse(model))) * vNormal;\\n\"+\r\n  \"\\tfPos = vec3(model * vPosition);\\n\",\r\n  diffuseAssign: '',\r\n  specularAssign: '',\r\n  normalAssign: '',\r\n  mainBodyOutput: '\\tgl_Position = projection * view * model * vPosition;\\n}'\r\n});\r\n\r\n\r\nexport const materialStruct = \"struct Material {\\n\" +\r\n\"\\tvec3 ambient;\\n\" +\r\n\"\\tvec3 diffuse;\\n\" +\r\n\"\\tvec3 specular;\\n\" +\r\n\"\\tfloat shininess;\\n\" +\r\n\"};\\n\"\r\n\r\nexport const DirectionalLightShader = `struct DirectionalLight {\r\n    vec3 direction;\r\n    vec3 ambient;\r\n    vec3 diffuse;\r\n    vec3 specular;\r\n};\r\n`;\r\n\r\nexport const PointLightShader = `struct PointLight {\r\n    vec3 position;\r\n    vec3 ambient;\r\n    vec3 diffuse;\r\n    vec3 specular;\r\n    float constant;\r\n    float linear;\r\n    float quadratic;\r\n};\r\n`;\r\n\r\nexport const SpotLightShader = `\r\nstruct SpotLight {\r\n    vec3 direction;\r\n    vec3 position;\r\n    vec3 ambient;\r\n    vec3 diffuse;\r\n    vec3 specular;\r\n    float constant;\r\n    float linear;\r\n    float quadratic;\r\n    float cutOff;\r\n    float outerCutOff;\r\n};\r\n`;\r\n\r\nexport const DirLightFuncDec = 'vec3 CalcDirLight(DirectionalLight light, vec3 normal, vec3 viewDir);\\n';\r\nexport const PointLightFuncDec = 'vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir);\\n';\r\nexport const SpotLightFuncDec = 'vec3 CalcSpotLight(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir);\\n';\r\n\r\nexport const LightAmbientWithTexture_Diff_Spec = '\\tvec3 ambient = light.ambient * vec3(texture(diffuseTexture, fDiffuseTextCoords));\\n'\r\nexport const LightDiffuseWithTexture_Diff_Spec = '\\tvec3 diffuse = light.diffuse * diff * vec3(texture(diffuseTexture, fDiffuseTextCoords));\\n'\r\nexport const LightSpecularWithTexture_Diff_Spec = '\\tvec3 specular = light.specular * spec * vec3(texture(specularTexture, fSpecularTextCoords));\\n'\r\n\r\nexport const LightAmbientWithTexture_Diff = '\\tvec3 ambient = light.ambient * vec3(texture(diffuseTexture, fDiffuseTextCoords));\\n'\r\nexport const LightDiffuseWithTexture_Diff = '\\tvec3 diffuse = light.diffuse * diff * vec3(texture(diffuseTexture, fDiffuseTextCoords));\\n'\r\nexport const LightSpecularWithTexture_Diff = '\\tvec3 specular = light.specular * spec * material.specular;\\n'\r\n\r\nexport const LightAmbientWithTexture_Spec = '\\tvec3 ambient = light.ambient * material.diffuse;\\n'\r\nexport const LightDiffuseWithTexture_Spec = '\\tvec3 diffuse = light.ambient * material.diffuse;\\n'\r\nexport const LightSpecularWithTexture_Spec = '\\tvec3 specular = light.specular * spec * vec3(texture(specularTexture, fSpecularTextCoords));\\n'\r\n\r\n/* export const DirLightFuncImpl = `vec3 CalcDirLight(DirectionalLight light, vec3 normal, vec3 viewDir)\r\n{\r\n    vec3 lightDir = normalize(-light.direction);\r\n    // diffuse shading\r\n    float diff = max(dot(normal, lightDir), 0.0);\r\n    // specular shading\r\n    vec3 reflectDir = reflect(-lightDir, normal);\r\n    float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\r\n    // combine results\r\n    vec3 ambient = light.ambient * material.diffuse;\r\n    vec3 diffuse = light.diffuse * diff * material.diffuse;\r\n    vec3 specular = light.specular * spec * material.specular;\r\n    return (ambient + diffuse + specular);\r\n}\\n` */\r\n\r\nexport const DirLightFuncImplObj = () =>({\r\n  signature: 'vec3 CalcDirLight(DirectionalLight light, vec3 normal, vec3 viewDir){\\n',\r\n  bodyStandandPart: `\\tvec3 lightDir = normalize(-light.direction);\r\n  \\t// diffuse shading\r\n  \\tfloat diff = max(dot(normal, lightDir), 0.0);\r\n  \\t// specular shading\r\n  \\tvec3 reflectDir = reflect(-lightDir, normal);\r\n  \\tfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\r\n  \\t// combine results\\n`,\r\n  bodyAmbient: '\\tvec3 ambient = light.ambient * material.diffuse;\\n',\r\n  bodyDiffuse: '\\tvec3 diffuse = light.diffuse * diff * material.diffuse;\\n',\r\n  bodySpecular: '\\tvec3 specular = light.specular * spec * material.specular;\\n',\r\n  bodyReturn: '\\treturn (ambient + diffuse + specular);\\n}\\n'\r\n});\r\n\r\n\r\n/* export const PointLightFuncImpl = `vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir)\r\n{\r\n    vec3 lightDir = normalize(light.position - fragPos);\r\n    // diffuse shading\r\n    float diff = max(dot(normal, lightDir), 0.0);\r\n    // specular shading\r\n    vec3 reflectDir = reflect(-lightDir, normal);\r\n    float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\r\n    // attenuation\r\n    float distance = length(light.position - fragPos);\r\n    float attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    \r\n    // combine results\r\n    vec3 ambient = light.ambient * material.diffuse;\r\n    vec3 diffuse = light.diffuse * diff * material.diffuse;\r\n    vec3 specular = light.specular * spec * material.specular;\r\n    ambient *= attenuation;\r\n    diffuse *= attenuation;\r\n    specular *= attenuation;\r\n    return (ambient + diffuse + specular);\r\n}\\n`; */\r\n\r\nexport const PointLightFuncImplObj = () =>({\r\n  signature: 'vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir){\\n',\r\n  bodyStandandPart: `\\tvec3 lightDir = normalize(light.position - fragPos);\r\n  \\t// diffuse shading\r\n  \\tfloat diff = max(dot(normal, lightDir), 0.0);\r\n  \\t// specular shading\r\n  \\tvec3 reflectDir = reflect(-lightDir, normal);\r\n  \\tfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\r\n  \\t// attenuation\r\n  \\tfloat distance = length(light.position - fragPos);\r\n  \\tfloat attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    \r\n  \\t// combine results\\n`,\r\n  bodyAmbient: '\\tvec3 ambient = light.ambient * material.diffuse;\\n',\r\n  bodyDiffuse: '\\tvec3 diffuse = light.diffuse * diff * material.diffuse;\\n',\r\n  bodySpecular: '\\tvec3 specular = light.specular * spec * material.specular;\\n',\r\n  bodyAttenuation: `\\tambient *= attenuation;\r\n  \\tdiffuse *= attenuation;\r\n  \\tspecular *= attenuation;\\n`,\r\n  bodyReturn: '\\treturn (ambient + diffuse + specular);\\n}\\n'\r\n});\r\n\r\n/* export const SpotLightFuncImpl = `vec3 CalcSpotLight(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir)\r\n{\r\n    vec3 lightDir = normalize(light.position - fragPos);\r\n    // diffuse shading\r\n    float diff = max(dot(normal, lightDir), 0.0);\r\n    // specular shading\r\n    vec3 reflectDir = reflect(-lightDir, normal);\r\n    float spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\r\n    // attenuation\r\n    float distance = length(light.position - fragPos);\r\n    float attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    \r\n    // spotlight intensity\r\n    float theta = dot(lightDir, normalize(-light.direction)); \r\n    float epsilon = light.cutOff - light.outerCutOff;\r\n    float intensity = clamp((theta - light.outerCutOff) / epsilon, 0.0, 1.0);\r\n    // combine results\r\n    vec3 ambient = light.ambient * material.ambient;\r\n    vec3 diffuse = light.diffuse * diff * material.diffuse;\r\n    vec3 specular = light.specular * spec * material.specular;\r\n    ambient *= attenuation * intensity;\r\n    diffuse *= attenuation * intensity;\r\n    specular *= attenuation * intensity;\r\n    return (ambient + diffuse + specular);\r\n}\\n`; */\r\n\r\nexport const SpotLightFuncImplObj = () =>({\r\n  signature: 'vec3 CalcSpotLight(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir){\\n',\r\n  bodyStandandPart: `\\tvec3 lightDir = normalize(light.position - fragPos);\r\n  \\t// diffuse shading\r\n  \\tfloat diff = max(dot(normal, lightDir), 0.0);\r\n  \\t// specular shading\r\n  \\tvec3 reflectDir = reflect(-lightDir, normal);\r\n  \\tfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\r\n  \\t// attenuation\r\n  \\tfloat distance = length(light.position - fragPos);\r\n  \\tfloat attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    \r\n  \\t// spotlight intensity\r\n  \\tfloat theta = dot(lightDir, normalize(-light.direction)); \r\n  \\tfloat epsilon = light.cutOff - light.outerCutOff;\r\n  \\tfloat intensity = clamp((theta - light.outerCutOff) / epsilon, 0.0, 1.0);\r\n  \\t// combine results\\n`,\r\n  bodyAmbient: '\\tvec3 ambient = light.ambient * material.diffuse;\\n',\r\n  bodyDiffuse: '\\tvec3 diffuse = light.diffuse * diff * material.diffuse;\\n',\r\n  bodySpecular: '\\tvec3 specular = light.specular * spec * material.specular;\\n',\r\n  bodyAttenuation: `\\tambient *= attenuation * intensity;\r\n  \\tdiffuse *= attenuation * intensity;\r\n  \\tspecular *= attenuation * intensity;\\n`,\r\n  bodyReturn: '\\treturn (ambient + diffuse + specular);\\n}\\n'\r\n});\r\n\r\n/* \r\nvec3 ambient = light.ambient * vec3(texture(material.diffuse, TexCoords));\r\n    vec3 diffuse = light.diffuse * diff * vec3(texture(material.diffuse, TexCoords));\r\n    vec3 specular = light.specular * spec * vec3(texture(material.specular, TexCoords)); */\r\n\r\nexport const textureScheme = `\r\nmainTexture;\r\nbumpMap;\r\nlightMap;\r\nshadowMap;\r\n`\r\n\r\nexport const materialVar = 'uniform Material material;\\n';\r\n\r\nexport const diffuseMapVar = 'uniform sampler2D diffuseTexture;\\n';\r\nexport const specularMapVar = 'uniform sampler2D specularTexture;\\n';\r\nexport const lightMapVar = 'uniform sampler2D lightTexture;\\n';\r\nexport const bumbMapVar = 'uniform sampler2D bumpTexture;\\n';\r\nexport const shadowMapVar = 'uniform sampler2D shadowTexture;\\n';\r\nexport const normalMapVar = 'uniform sampler2D normalTexture;\\n';\r\n\r\nexport const fDiffuseCoords = 'in vec2 fDiffuseTextCoords;\\n';\r\nexport const fSpecularCoords = 'in vec2 fSpecularTextCoords;\\n';\r\nexport const fLightCoords = 'in vec2 fLightTextCoords;\\n';\r\nexport const fBumpCoords = 'in vec2 fBumpTextCoords;\\n';\r\nexport const fShadowCoords = 'in vec2 fShadowTextCoords;\\n';\r\nexport const fNormalCoords = 'in vec2 fNormalTextCoords;\\n';\r\n\r\nexport const fOutput_Lights = '\\tfragColor = vec4(lightColor, 1.0);\\n'\r\n\r\nexport var fragmentShaderCompleteObj = ()=>({\r\n  version: '#version 300 es\\n',\r\n  precision: 'precision mediump float;\\n',\r\n  materialStruct: '',\r\n  lightsStructs: '',\r\n  lightsFuncDec: '',\r\n  colorIn: 'in vec4 fColor;\\n',\r\n  normalIn: 'in vec3 fNormal;\\n',\r\n  fragPosIn: 'in vec3 fPos;\\n',\r\n  texturesCoords: '',\r\n  samplers: '',\r\n  viewPos: 'uniform vec3 viewPos;\\n',\r\n  material: '',\r\n  lightsUniform: '',\r\n  colorOut: 'out vec4 fragColor;\\n',\r\n  mainStart: 'void main(){\\n',\r\n  lightsCalc: '',\r\n  textureCalc: '',\r\n  fragOutput: '\\tfragColor = vec4(0.0, 0.0, 1.0, 1.0);\\n',\r\n  mainEnd: '}\\n',\r\n  lightsFuncImpl: '',\r\n  textureFuncImpl: ''\r\n});\r\n\r\n","import { vec2, vec3 } from \"./Utils/Vector_Matrix\";\r\n\r\n\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Class that represents a Material of a Mesh, that defines the differents components\r\n * of the Phong Lighting.\r\n */\r\nexport class Material{\r\n    static nextId = 1;\r\n    ambient;\r\n    diffuse; // Can be a Texture - If present ambient is to be ignored\r\n    specular; // Can be a Texture\r\n    shininess;\r\n\r\n    textures; // TODO { diffuseMap: Texture, specularMap: Texture, lightMap: Texture, bumpMap: Texture, shadowMap: Texture}\r\n\r\n    /**\r\n     * Create a new Material to be used by a Mesh.\r\n     * @param {vec3} ambient The ambient color of the object\r\n     * @param {vec3} diffuse The diffuse color of the objcet\r\n     * @param {vec3} diffuse The spcular color of the objcet\r\n     * @param {float} diffuse The shininess level of the objcet (a power of 2 (eg. 32, 64 ...))\r\n     */\r\n    constructor(ambient, diffuse, specular, shininess){\r\n        Material.nextId++;\r\n        this.id = Material.nextId;\r\n        this.ambient = ambient || vec3(0.5, 0.5, 0.5);\r\n        this.diffuse = diffuse || vec3(0.5, 0.5, 0.5);\r\n        this.specular = specular || vec3(0.5, 0.5, 0.5);\r\n        this.shininess = shininess || 64;\r\n    }\r\n}","import { Mesh } from '../common/Mesh';\r\nimport { LightTypes, TextureTypes } from '../common/Utils/constants';\r\nimport * as shaderDefault from './shaderDefaults';\r\nimport { Material } from '../common/Material';\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Class used to create Default Shaders according to Mesh properties.\r\n */\r\nexport class ShaderFactory{\r\n    \r\n\r\n    // ==============================================================================================================================\r\n    /**\r\n     * \r\n     * @param {{\r\n        *  material : { diffuse, specular, specular, shininess, \r\n        *      textures: { diffuseMap, specularMap, lightMap, bumpMap, shadowMap}\r\n        *  },\r\n        *  lights : {lights, lightsValues: []},\r\n        * }} props \r\n    */\r\n    static CreateVertexShaderFromProperties(props) {\r\n        let vertexSource = shaderDefault.vertexCompleteShaderObj();\r\n        if(props.material){\r\n            const textures = props.material.textures\r\n            if(textures){\r\n                if(textures[TextureTypes.DiffuseMap]){\r\n                    vertexSource.diffuseCoordsIn = shaderDefault.vDiffuseCoords_In;\r\n                    vertexSource.diffuseCoordsOut = shaderDefault.vDiffuseCoords_Out;\r\n                    vertexSource.diffuseAssign = shaderDefault.vDiffuseCoords_Assign;\r\n                } \r\n                if(textures[TextureTypes.SpecularMap]){\r\n                    vertexSource.specularCoordsIn = shaderDefault.vSpecularCoords_In;\r\n                    vertexSource.specularCoordsOut = shaderDefault.vSpecularCoords_Out;\r\n                    vertexSource.specularAssign = shaderDefault.vSpecularCoords_Assign;\r\n                } \r\n                /* if(textures[TextureTypes.LightMap]){\r\n                    vertexSource.specularCoordsIn = shaderDefault.vSpecularCoords_In;\r\n                    vertexSource.specularCoordsOut = shaderDefault.vSpecularCoords_Out;\r\n                    vertexSource.specularAssign = shaderDefault.vSpecularCoords_Assign;\r\n                } \r\n                if(textures[TextureTypes.BumpMap]){\r\n                    vertexSource.specularCoordsIn = shaderDefault.vSpecularCoords_In;\r\n                    vertexSource.specularCoordsOut = shaderDefault.vSpecularCoords_Out;\r\n                    vertexSource.specularAssign = shaderDefault.vSpecularCoords_Assign;\r\n                } \r\n                if(textures[TextureTypes.ShadowMap]){\r\n                    vertexSource.specularCoordsIn = shaderDefault.vSpecularCoords_In;\r\n                    vertexSource.specularCoordsOut = shaderDefault.vSpecularCoords_Out;\r\n                    vertexSource.specularAssign = shaderDefault.vSpecularCoords_Assign;\r\n                } */\r\n            }\r\n        }\r\n\r\n        vertexSource = Object.values(vertexSource).join('');\r\n        return vertexSource;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {{\r\n        *  material : { diffuse, specular, specular, shininess, \r\n        *      textures: { diffuseMap, specularMap, lightMap, bumpMap, shadowMap}\r\n        *  },\r\n        *  lights : {lights, lightsValues: []},\r\n        * }} props\r\n     */\r\n    static CreateFragmentShaderFromProperties(props, n) {\r\n        let fragmentSource = shaderDefault.fragmentShaderCompleteObj();\r\n        console.log(JSON.parse(JSON.stringify(fragmentSource)))\r\n        let hasLights = false;\r\n        let hasTexture ={  hasDiffuseTexture: false };\r\n\r\n        if(props.material){\r\n            fragmentSource.materialStruct = shaderDefault.materialStruct;\r\n            fragmentSource.material = shaderDefault.materialVar;\r\n            const textures = props.material.textures\r\n            if(textures){\r\n                if(textures[TextureTypes.DiffuseMap]){\r\n                    \r\n                    fragmentSource.samplers += shaderDefault.diffuseMapVar;\r\n                    fragmentSource.texturesCoords += shaderDefault.fDiffuseCoords;\r\n                    hasTexture.hasDiffuseTexture = true;\r\n                } \r\n                if(textures[TextureTypes.SpecularMap]){\r\n                    fragmentSource.samplers += shaderDefault.specularMapVar;\r\n                    fragmentSource.texturesCoords += shaderDefault.fSpecularCoords;\r\n                } \r\n                if(textures[TextureTypes.LightMap]){\r\n                    fragmentSource.samplers += shaderDefault.lightMapVar;\r\n                    fragmentSource.texturesCoords += shaderDefault.fLightCoords;\r\n                } \r\n                if(textures[TextureTypes.BumpMap]){\r\n                    fragmentSource.samplers += shaderDefault.bumbMapVar;\r\n                    fragmentSource.texturesCoords += shaderDefault.fBumpCoords;\r\n                } \r\n                if(textures[TextureTypes.ShadowMap]){\r\n                    fragmentSource.samplers += shaderDefault.shadowMapVar;\r\n                    fragmentSource.texturesCoords += shaderDefault.fShadowCoords;\r\n                }\r\n                fragmentSource.textureCalc = this.getTexturesCalc(props.material.textures);\r\n            }\r\n        }\r\n\r\n        if(props.lights){\r\n            hasLights = true;\r\n            fragmentSource.lightsStructs = this.getLightsStructsFromLights(props.lights.lightsTypes);\r\n            fragmentSource.lightsFuncDec = this.getLightsFuncDec(props.lights.lightsTypes);\r\n            fragmentSource.lightsUniform = this.getLightsVarsFromLights(props.lights.lights);\r\n            fragmentSource.lightsCalc = this.doLightCalcs(props.lights.lights, props.material.textures);\r\n            fragmentSource.lightsFuncImpl = this.getLightsFuncImpl(props.lights.lightsTypes, props.material.textures);\r\n            fragmentSource.fragOutput = shaderDefault.fOutput_Lights;\r\n        }\r\n\r\n        fragmentSource = Object.values(fragmentSource).join('');\r\n        return fragmentSource;\r\n    }\r\n\r\n\r\n    //===================UTILS===================\r\n    static getLights(sources){\r\n        let lights = '';\r\n        if (sources && sources.lights){\r\n            for (let i = 0; i < sources.lights.length; i++) {\r\n                lights +='uniform Light light'+i+';\\n';\r\n            }\r\n        }\r\n        return lights;\r\n    }\r\n\r\n    static doLightCalcs(lights, textureTypes) {\r\n        let lightsCalc =\r\n            '\\tvec3 viewDir = normalize(viewPos - fPos);\\n' +\r\n            '\\tvec3 norm = normalize(fNormal);\\n'// se c' normal map usare quella\r\n\r\n        for(let i=0; i<lights.length; i++){\r\n            if( i == 0){\r\n                lightsCalc += '\\tvec3 lightColor = '; \r\n            } else {\r\n                lightsCalc += '\\tlightColor += ';\r\n            }\r\n            if (lights[i].type == LightTypes.DirectionalLight){\r\n                lightsCalc += 'CalcDirLight(light' + i + ', norm, viewDir);\\n';\r\n            }\r\n            if (lights[i].type == LightTypes.PointLight){\r\n                lightsCalc += 'CalcPointLight(light' + i + ', norm, fPos, viewDir);\\n';\r\n            }\r\n            if (lights[i].type == LightTypes.SpotLight){\r\n                lightsCalc += 'CalcSpotLight(light' + i + ', norm, fPos, viewDir);\\n';\r\n            }\r\n        }\r\n\r\n        return lightsCalc;\r\n    }\r\n\r\n    static getLightsStructsFromLights(lightsTypes) {\r\n        let r = '';\r\n\r\n        if (lightsTypes[LightTypes.DirectionalLight]) r += shaderDefault.DirectionalLightShader;\r\n        if (lightsTypes[LightTypes.PointLight]) r += shaderDefault.PointLightShader;\r\n        if (lightsTypes[LightTypes.SpotLight]) r += shaderDefault.SpotLightShader;\r\n        \r\n        return r;\r\n    }\r\n\r\n    static getLightsFuncDec(lightsTypes){\r\n        let r = '';\r\n\r\n        if (lightsTypes[LightTypes.DirectionalLight]) r += shaderDefault.DirLightFuncDec;\r\n        if (lightsTypes[LightTypes.PointLight]) r += shaderDefault.PointLightFuncDec;\r\n        if (lightsTypes[LightTypes.SpotLight]) r += shaderDefault.SpotLightFuncDec;\r\n\r\n        return r;\r\n    }\r\n\r\n    static getLightsFuncImpl(lightsTypes, textures){\r\n        let r = '';\r\n\r\n        if (lightsTypes[LightTypes.DirectionalLight]){\r\n            const lightSource = shaderDefault.DirLightFuncImplObj();\r\n            if(textures){ this.setLightSourceTextures(lightSource, textures); }\r\n            r += Object.values(lightSource).join('');\r\n        }\r\n        if(lightsTypes[LightTypes.PointLight]){\r\n            const lightSource = shaderDefault.PointLightFuncImplObj();\r\n            if(textures){ this.setLightSourceTextures(lightSource, textures); }\r\n            r += Object.values(lightSource).join('');\r\n        }\r\n        if (lightsTypes[LightTypes.SpotLight]){\r\n            const lightSource = shaderDefault.SpotLightFuncImplObj();\r\n            if(textures){ this.setLightSourceTextures(lightSource, textures); }\r\n            r += Object.values(lightSource).join('');\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static setLightSourceTextures(lightSource, textures){\r\n        if(textures[TextureTypes.DiffuseMap] && textures[TextureTypes.SpecularMap]){\r\n            lightSource.bodyAmbient = shaderDefault.LightAmbientWithTexture_Diff_Spec;\r\n            lightSource.bodyDiffuse = shaderDefault.LightDiffuseWithTexture_Diff_Spec;\r\n            lightSource.bodySpecular = shaderDefault.LightSpecularWithTexture_Diff_Spec;\r\n        } else if(textures[TextureTypes.DiffuseMap] && !textures[TextureTypes.SpecularMap]){\r\n            lightSource.bodyAmbient = shaderDefault.LightAmbientWithTexture_Diff;\r\n            lightSource.bodyDiffuse = shaderDefault.LightDiffuseWithTexture_Diff;\r\n            lightSource.bodySpecular = shaderDefault.LightSpecularWithTexture_Diff;\r\n        } else if(!textures[TextureTypes.DiffuseMap] && textures[TextureTypes.SpecularMap]){\r\n            lightSource.bodyAmbient = shaderDefault.LightAmbientWithTexture_Spec;\r\n            lightSource.bodyDiffuse = shaderDefault.LightDiffuseWithTexture_Spec;\r\n            lightSource.bodySpecular = shaderDefault.LightSpecularWithTexture_Spec;\r\n        }\r\n    }\r\n\r\n    static getLightsVarsFromLights (lights){\r\n        let r = '';\r\n\r\n        for(let i=0; i<lights.length; i++){\r\n            if (lights[i].type === LightTypes.DirectionalLight) r += 'uniform DirectionalLight light' + i + ';\\n';\r\n            if (lights[i].type === LightTypes.PointLight) r += 'uniform PointLight light' + i + ';\\n';\r\n            if (lights[i].type === LightTypes.SpotLight) r += 'uniform SpotLight light' + i + ';\\n';\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    //FOR FUTURE\r\n    static getTexturesCalc(textures){\r\n        let r = '';\r\n        return r;\r\n    }\r\n\r\n}\r\n","import {Shader} from './Shader';\nimport {ShaderProgram} from './ShaderProgram';\nimport {ShaderFactory} from '../shaders/ShaderFactory';\nimport { vec3, flatten, mat4, translate, rotate, rotateX, rotateY, rotateZ, scalem, mult } from './Utils/Vector_Matrix';\nimport { Material } from './Material';\nimport { LightTypes } from \"./Utils/constants\";\n/**\n * @author Alberto Contorno\n * @class\n */\nexport class Mesh{\n  static nextId = 1;\n  vertices;\n  indices;\n  shaders = {vertex: null, fragment: null, program: null, set: false}\n  id;\n  VAO;\n  VBO;\n  EBO;\n  NBO;\n  type;\n  locations = {};\n  textures = {}; // {diffuseMap, specularMap, normalMap, BumbpMap, shadowMap}\n  normals;\n  material;\n  textCoords;\n  shaderUpdated = false;\n  /*\n    opt : keepData, autoUpdateShaders, shadersShouldUpdate\n  */\n  /**\n   * \n   * @param {*} gl \n   * @param {*} vertices \n   * @param {*} indices \n   * @param {{ vertex: string, fragment: string }} shaders\n   * @param {*} opt \n   * @param {*} textures // props.material.textures = {  DIFFUSE_MAP: 1, SPECULAR_MAP: 1, NORMAL_MAP: 1, LIGHT_MAP: 1, BUMP_MAP: 1, SHADOW_MAP: 1 };\n   * @param {*} textCoords \n   */\n  constructor(gl, vertices, indices, shaders, opt, textures, textCoords, normals){\n    Mesh.nextId++;\n    this.gl = gl;\n    this.id = Mesh.nextId;\n    this.vertices = vertices;\n    this.indices = indices;\n    this.opt = opt || { keepData: true };\n    this.type = this.opt.type || gl.TRIANGLES;\n    this.textures = Object.assign({ DIFFUSE_MAP: null, SPECULAR_MAP: null, NORMAL_MAP: null, LIGHT_MAP: null, BUMP_MAP: null, SHADOW_MAP: null}, textures);;\n    this.textCoords = textCoords;\n    this.normals = normals;\n\n    this.shaders = {};\n    //Create shader if passed else do it automatically from info\n    // TODO create shader from object properties, update when properties change (eg. a component in the object is removed)\n    console.log('MESH CREATED_'+this.id, this);\n  }\n\n  createAndLoadBuffers(gl){\n    this.VAO = gl.createVertexArray();\n    gl.bindVertexArray(this.VAO);\n\n    this.VBO = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.VBO);\n    gl.bufferData(gl.ARRAY_BUFFER, flatten(this.vertices), gl.STATIC_DRAW);\n\n    let positionLoc = gl.getAttribLocation(this.shaders.program.program, 'vPosition');\n    gl.vertexAttribPointer(positionLoc, 4, gl.FLOAT, false, 0, 0);\n    gl.enableVertexAttribArray(positionLoc);\n\n    if (this.normals) {\n      this.NBO = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.NBO);\n      gl.bufferData(gl.ARRAY_BUFFER, flatten(this.normals), gl.STATIC_DRAW);\n      let normalLoc = gl.getAttribLocation(this.shaders.program.program, 'vNormal');\n      gl.vertexAttribPointer(normalLoc, 3, gl.FLOAT, false, 0, 0);\n      gl.enableVertexAttribArray(normalLoc);\n    }\n\n    this.locations.textures = {};\n    if(this.textures.DIFFUSE_MAP){\n      if (this.textCoords){\n        this.textCoordBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.textCoordBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, flatten(this.textCoords), gl.STATIC_DRAW);\n        let textCoordLoc = gl.getAttribLocation(this.shaders.program.program, 'vDiffuseTextCoords');\n        gl.vertexAttribPointer(textCoordLoc, 2, gl.FLOAT, false, 0, 0);\n        gl.enableVertexAttribArray(textCoordLoc);\n      }\n    }\n\n    if (this.indices) {\n      this.EBO = gl.createBuffer();\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.EBO);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(this.indices), gl.STATIC_DRAW);\n    }\n    \n    /* let textCoordLoc = gl.getAttribLocation(this.shaders.program.program, 'vTextCoord');\n    gl.vertexAttribPointer(textCoordLoc, 3, gl.FLOAT, false, 32, 12);\n    gl.enableVertexAttribArray(textCoordLoc); */\n\n    //questa parte la fara l'engine\n    this.locations.modelLoc = gl.getUniformLocation(this.shaders.program.program, 'model');\n    this.locations.viewLoc = gl.getUniformLocation(this.shaders.program.program, 'view');\n    this.locations.projLoc = gl.getUniformLocation(this.shaders.program.program, 'projection');\n\n    this.unbindVAO(gl);\n    //TODO\n    //in teoria this.vertices, e this.indices non serve pi e possiamo tenerci solo la this.indices.lenght\n    //se servono usiamo un flag per decidere di tenerli\n    if(this.opt && !this.opt.keepData){\n      this.vertices = null;\n      this.indices = null;\n      this.textCoords = null;\n    }\n\n  }\n\n  unbindVAO(gl){\n    gl.bindVertexArray(null);\n  }\n\n  getModelMatrix(object){\n    let transform = object.transform;\n    \n    let position = transform.position || [0, 0, 0];\n    let rotation = transform.rotation || [0, 0, 0];\n    let scale = transform.scale || [1, 1, 1];\n\n    let modelMatrix = mat4();\n    // da costruire a partire dalla posizione dell'oggetto\n    let traslationMatrix = translate(position[0], position[1], position[2]);\n    //da costruire a partire dalla rotazione dell'oggetto\n    let rotationMatrixX = rotateX(rotation[0]);\n    let rotationMatrixY = rotateY(rotation[1]);\n    let rotationMatrixZ = rotateZ(rotation[2]);\n\n    let scaleMatrix = scalem(scale[0], scale[1], scale[2]);\n\n    //translate * rotate * scale\n    modelMatrix = mult(traslationMatrix, rotationMatrixX);\n    modelMatrix = mult(modelMatrix, rotationMatrixY);\n    modelMatrix = mult(modelMatrix, rotationMatrixZ);\n    modelMatrix = mult(modelMatrix, scaleMatrix);\n\n    if (object.parent) {\n      modelMatrix = mult(this.getModelMatrix(object.parent), modelMatrix);\n    }\n\n    return modelMatrix;\n  }\n\n  getDirectionalLightLocations(gl, lightName){\n    let lightLocs = {type: LightTypes.DirectionalLight};\n    lightLocs.ambient = gl.getUniformLocation(this.shaders.program.program, lightName+'.ambient');\n    lightLocs.diffuse = gl.getUniformLocation(this.shaders.program.program, lightName +'.diffuse');\n    lightLocs.specular = gl.getUniformLocation(this.shaders.program.program, lightName +'.specular');\n    lightLocs.direction = gl.getUniformLocation(this.shaders.program.program, lightName +'.direction');\n    return lightLocs;\n  }\n\n  getPointLightLocations(gl, lightName){\n    let lightLocs = { type: LightTypes.PointLight };\n    lightLocs.position = gl.getUniformLocation(this.shaders.program.program, lightName + '.position');\n    lightLocs.ambient = gl.getUniformLocation(this.shaders.program.program, lightName + '.ambient');\n    lightLocs.diffuse = gl.getUniformLocation(this.shaders.program.program, lightName + '.diffuse');\n    lightLocs.specular = gl.getUniformLocation(this.shaders.program.program, lightName + '.specular');\n    lightLocs.constant = gl.getUniformLocation(this.shaders.program.program, lightName + '.constant');\n    lightLocs.linear = gl.getUniformLocation(this.shaders.program.program, lightName + '.linear');\n    lightLocs.quadratic = gl.getUniformLocation(this.shaders.program.program, lightName + '.quadratic');\n    return lightLocs;\n  }\n\n  getSpotLightLocations(lightName){\n    const gl = this.gl;\n    let lightLocs = { type: LightTypes.SpotLight };\n    lightLocs.position = gl.getUniformLocation(this.shaders.program.program, lightName + '.position');\n    lightLocs.ambient = gl.getUniformLocation(this.shaders.program.program, lightName + '.ambient');\n    lightLocs.diffuse = gl.getUniformLocation(this.shaders.program.program, lightName + '.diffuse');\n    lightLocs.specular = gl.getUniformLocation(this.shaders.program.program, lightName + '.specular');\n    lightLocs.constant = gl.getUniformLocation(this.shaders.program.program, lightName + '.constant');\n    lightLocs.linear = gl.getUniformLocation(this.shaders.program.program, lightName + '.linear');\n    lightLocs.quadratic = gl.getUniformLocation(this.shaders.program.program, lightName + '.quadratic');\n    lightLocs.cutOff = gl.getUniformLocation(this.shaders.program.program, lightName + '.cutOff');\n    lightLocs.outerCutOff = gl.getUniformLocation(this.shaders.program.program, lightName + '.outerCutOff');\n    lightLocs.direction = gl.getUniformLocation(this.shaders.program.program, lightName + '.direction');\n    return lightLocs;\n  }\n\n  getLocations(lights){\n    const gl = this.gl;\n    //vertex\n    this.locations.modelLoc = gl.getUniformLocation(this.shaders.program.program, 'model');\n    this.locations.viewLoc = gl.getUniformLocation(this.shaders.program.program, 'view');\n    this.locations.projLoc = gl.getUniformLocation(this.shaders.program.program, 'projection');\n    //fragment\n    this.locations.viewPosLoc = gl.getUniformLocation(this.shaders.program.program, 'viewPos');\n    this.locations.materialLocs = {};\n    this.locations.materialLocs.ambient = gl.getUniformLocation(this.shaders.program.program, 'material.ambient');\n    this.locations.materialLocs.diffuse = gl.getUniformLocation(this.shaders.program.program, 'material.diffuse');\n    this.locations.materialLocs.specular = gl.getUniformLocation(this.shaders.program.program, 'material.specular');\n    this.locations.materialLocs.shininess = gl.getUniformLocation(this.shaders.program.program, 'material.shininess');\n\n    if(lights && lights.length > 0){\n      this.locations.lights = [];\n      for (let i = 0; i < lights.length; i++) {\n        if (lights[i].type == LightTypes.DirectionalLight) {\n          this.locations.lights.push(this.getDirectionalLightLocations(gl, 'light' + i));\n        } else if (lights[i].type == LightTypes.PointLight) {\n          this.locations.lights.push(this.getPointLightLocations(gl, 'light' + i));\n        } else if (lights[i].type == LightTypes.SpotLight) {\n          this.locations.lights.push(this.getSpotLightLocations(gl, 'light' + i));\n        }\n      }\n    }\n  }\n\n  updateShadersAndProgram(material, lights, lightsTypes, name){\n    this.shaderUpdated = true;\n      const props = { id: name,\n        material: {\n          ...material,\n          textures:  this.textures\n        },\n        lights: {\n          lights: lights,\n          lightsTypes: lightsTypes\n        }\n      }\n      \n      let v = ShaderFactory.CreateVertexShaderFromProperties(props);\n      let f = ShaderFactory.CreateFragmentShaderFromProperties(props, name);\n      this.shaders.vertex = new Shader(this.gl, 'vertex', v);;\n      this.shaders.fragment = new Shader(this.gl, 'fragment', f);\n\n      console.log(this.id, name, this.textures, props);\n\n      let shaders = [];\n      for(let key in this.shaders){\n        if (key != 'program' && key != 'set'){\n          shaders.push(this.shaders[key].shader);\n        }\n      }\n\n      this.shaders.program = new ShaderProgram(this.gl, shaders);\n      if (this.opt && !this.opt.keepData) {\n        this.shaders.vertex= null;\n        this.shaders.fragment = null;\n      }\n\n      this.getLocations(lights);\n      this.createAndLoadBuffers(this.gl);\n  }\n\n  render(gl, camera, transform = {}, type, material, lights, lightsTypes, n) {\n    //Update shader\n    if(!this.shaderUpdated) this.updateShadersAndProgram(material, lights, lightsTypes, n);\n    \n    gl.useProgram(this.shaders.program.program); \n    gl.bindVertexArray(this.VAO);\n\n    let modelMatrix = this.getModelMatrix(transform);\n    let projMatrix = camera.getProjectionMatrix();\n    let viewMatrix = camera.getViewMatrix();\n\n    if (this.locations.modelLoc) {\n      gl.uniformMatrix4fv(this.locations.modelLoc, false, flatten(modelMatrix));\n    }\n    if (this.locations.viewLoc) {\n      gl.uniformMatrix4fv(this.locations.viewLoc, false, flatten(viewMatrix));\n    }\n    if (this.locations.projLoc) {\n      gl.uniformMatrix4fv(this.locations.projLoc, false, flatten(projMatrix));\n    }\n    if (this.locations.viewPosLoc) {\n      gl.uniform3fv(this.locations.viewPosLoc, camera.getFrontVector());\n    }\n\n    if (this.locations.materialLocs){\n      if (!material){ material = new Material(); }\n      gl.uniform3fv(this.locations.materialLocs.ambient, flatten(material.ambient));\n      gl.uniform3fv(this.locations.materialLocs.diffuse, material.diffuse);\n      gl.uniform3fv(this.locations.materialLocs.specular, material.specular);\n      gl.uniform1f(this.locations.materialLocs.shininess, material.shininess);\n    }\n\n    if (this.locations.lights){\n      for (let i = 0; i < this.locations.lights.length; i++){\n        if (this.locations.lights[i].type === LightTypes.DirectionalLight) {\n          this.setupDirectionalLight(gl, this.locations.lights[i], lights[i]);\n        } else if (this.locations.lights[i].type === LightTypes.PointLight) {\n          this.setupPointLight(gl, this.locations.lights[i], lights[i]);\n        } else if (this.locations.lights[i].type === LightTypes.SpotLight) {\n          this.setupSpotLight(gl, this.locations.lights[i], lights[i]);\n        }\n      }\n    }\n\n    Object.values(this.textures).forEach(texture => {\n      //load texture path\n      if (texture) texture.ActiveTexture(gl);\n    });\n\n    if (this.indices) {//draw elements\n      gl.drawElements(type || gl.TRIANGLES, this.indices.length, gl.UNSIGNED_SHORT, 0);\n    } else { //draw arrays\n      gl.drawArrays(type || gl.TRIANGLES, 0, this.vertices.length);\n    }\n\n    Object.values(this.textures).forEach(texture => {\n      if (texture) texture.DisactiveTexture(gl);\n    });\n    \n    gl.bindVertexArray(null);\n    gl.useProgram(null);\n  }\n\n  destroyShader(shader, gl){\n    gl.deleteShader(shader);\n  }\n\n  destroyShaders(gl){\n\n  }\n\n  destroyProgram(program, gl){\n\n  }\n\n  destroy(gl){\n    this.destroyProgram(gl);\n    this.destroyShaders(gl);\n  }\n\n  setupDirectionalLight(gl, lightLocs, light){\n    gl.uniform3fv(lightLocs.ambient, light.light.ambient);\n    gl.uniform3fv(lightLocs.diffuse, light.light.diffuse);\n    gl.uniform3fv(lightLocs.specular, light.light.specular);\n    gl.uniform3fv(lightLocs.direction, light.light.direction);\n  }\n\n  setupPointLight(gl, lightLocs, light) {\n    gl.uniform3fv(lightLocs.position, light.light.position);\n    gl.uniform3fv(lightLocs.ambient, light.light.ambient);\n    gl.uniform3fv(lightLocs.diffuse, light.light.diffuse);\n    gl.uniform3fv(lightLocs.specular, light.light.specular);\n    gl.uniform1f(lightLocs.constant, light.light.constant);\n    gl.uniform1f(lightLocs.linear, light.light.linear);\n    gl.uniform1f(lightLocs.quadratic, light.light.quadratic);\n  }\n\n  setupSpotLight(gl, lightLocs, light) {\n    gl.uniform3fv(lightLocs.position, light.light.position);\n    gl.uniform3fv(lightLocs.ambient, light.light.ambient);\n    gl.uniform3fv(lightLocs.diffuse, light.light.diffuse);\n    gl.uniform3fv(lightLocs.specular, light.light.specular);\n    gl.uniform1f(lightLocs.constant, light.light.constant);\n    gl.uniform1f(lightLocs.linear, light.light.linear);\n    gl.uniform1f(lightLocs.quadratic, light.light.quadratic);\n    gl.uniform1f(lightLocs.cutOff, light.light.cutOff);\n    gl.uniform1f(lightLocs.outerCutOff, light.light.outerCutOff);\n    gl.uniform3fv(lightLocs.direction, light.light.direction);\n  }\n}","import {TextureTypes} from './Utils/constants'\r\n\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Class that represents a single Texture of a Mesh.\r\n */\r\nexport class Texture{\r\n    static nextId = 1;\r\n\r\n    id;\r\n    textureUnit = 0;\r\n    imagePath;\r\n    textureSource;\r\n    texture;\r\n    s_texelType;\r\n    texelType;\r\n    params;\r\n    /**\r\n    *\r\n    * @param {number} textureUnit The texture unit associated to the Texture\r\n    * @param {GL_ENUM} gl_type The texture type (e.g. TEXTURE_2D)\r\n    * @param {vec3} up The up vector of the camera\r\n    * @param {GL_ENUM} s_texelType The texel's type of the source data of the texture.\r\n    * @param {GL_ENUM} texelType The texel's type of the data of the texture stored into the GPU.\r\n    * @param {Array} params Array of params objects {key[GL_ENUM]:value} where the key is a GL_ENUM that specifies the texture parameter and the value is the value to apply.\r\n    * @param {TextureTypes} type The type of the texture: one of the values of the constant TextureTypes (eg. NormalMap).\r\n    */\r\n    constructor(textureUnit, gl_type, imagePath, s_texelType, texelType, params, type){\r\n        Texture.nextId++;\r\n        this.id = Texture.nextId;\r\n        this.textureUnit = textureUnit || 0;\r\n        this.gl_type = type;\r\n        this.imagePath = imagePath;\r\n        this.s_texelType = s_texelType;\r\n        this.texelType = texelType;\r\n        this.params = params;\r\n        this.type = type;\r\n    }\r\n\r\n    CreateTextureFromArray(gl){\r\n        this.texture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, this.texelType, 1, 1,\r\n            0, this.s_texelType, gl.UNSIGNED_BYTE, new Uint8Array([255, 255, 255, 255]));\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n\r\n    LoadTexture(gl){\r\n        this.textureSource = new Image();\r\n        this.textureSource.crossOrigin = \"\";\r\n        this.textureSource.src = this.imagePath;\r\n        this.texture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n        //set texture params\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, this.texelType, 1, 1,\r\n            0, this.s_texelType, gl.UNSIGNED_BYTE, new Uint8Array([0, 0, 255, 255]));\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n        let _loaded = () => {\r\n            gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n            console.log(\"TEXTURE LOADED\", this.id);\r\n            gl.texImage2D(gl.TEXTURE_2D, 0, this.texelType, this.textureSource.width, this.textureSource.height,\r\n                0, this.s_texelType, gl.UNSIGNED_BYTE, this.textureSource);\r\n            gl.generateMipmap(gl.TEXTURE_2D);\r\n            this.textureSource.removeEventListener('load', _loaded);\r\n            this.textureSource = null;\r\n            gl.bindTexture(gl.TEXTURE_2D, null);\r\n        }\r\n        this.textureSource.addEventListener('load', _loaded);  \r\n    }\r\n\r\n    UseTexture(gl, textureUnit){\r\n        gl.activeTexture(gl.TEXTURE0 + textureUnit);\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n    }\r\n\r\n    ActiveTexture(gl){\r\n        gl.activeTexture(gl.TEXTURE0 + this.textureUnit);\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n    }\r\n\r\n    DisactiveTexture(gl){\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n\r\n    deleteTextyre(gl){\r\n        gl.deleteTexture(this.texture);\r\n    }\r\n\r\n}","import {Component} from '../Component';\r\nimport { SceneObject } from '../Object';\r\nimport { Scene } from '../Scene';\r\nimport { LightTypes } from '../Utils/constants';\r\nimport { vec3 } from \"../Utils/Vector_Matrix\";\r\nconst lightTypes = LightTypes;\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Components that makes the object to which it is attached a source light.\r\n */\r\nexport class Light extends Component{\r\n    static nextId = 1;\r\n    id;\r\n    diffuse = vec3(0.5,0.5,0.5);\r\n    ambient = vec3(0.1, 0.1, 0.1);\r\n    specular = vec3(0.8, 0.8, 0.8);\r\n    /**\r\n     * \r\n     * @param {vec3} diffuse Diffuse component of the light\r\n     * @param {vec3} ambient Ambient component of the light\r\n     * @param {vec3} specular Specular component of the light\r\n     */\r\n    constructon(diffuse, ambient, specular){\r\n        this.id = Light.nextId;\r\n        Light.nextId++;\r\n        this.name = 'Light';\r\n        this.diffuse = diffuse;\r\n        this.ambient = ambient;\r\n        this.specular = specular;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {SceneObject} parent \r\n     * @param {Scene} scene \r\n     */\r\n    onAfterAdded(parent, scene){\r\n        scene.registerLight(lightTypes[this.constructor.name], this);\r\n    }\r\n\r\n    onAfterRemoved(parent, scene){\r\n        scene.unregisterLight(lightTypes[this.constructor.name], this);\r\n    }\r\n}","import { Light } from \"./Light\";\r\nimport { vec3 } from \"../Utils/Vector_Matrix\";\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Components that represents a directional global light.\r\n */\r\nexport class DirectionalLight extends Light{\r\n\r\n    direction;\r\n\r\n    constructor(diffuse, ambient, specular, direction){\r\n        super(diffuse, ambient, specular);\r\n        this.name = 'DirectionalLight';\r\n        this.direction = direction || vec3(0,-1,0);\r\n    }\r\n\r\n    static getDirectionForShader(){\r\n        return 'vec3 lightDir = normalize(-light.direction);';\r\n    }\r\n\r\n}","import { Light } from \"./Light\";\r\nimport { vec3 } from \"../Utils/Vector_Matrix\";\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Components that represents a point light.\r\n */\r\nexport class PointLight extends Light{\r\n    position\r\n    constant;\r\n    linear;\r\n    quadratic;\r\n\r\n    constructor(diffuse, ambient, specular, position, constant, linear, quadratic){\r\n        super();\r\n        this.name = 'PointLight';\r\n        this.constant = constant || 1.0;\r\n        this.linear = linear || 0.09;\r\n        this.quadratic = quadratic || 0.032;\r\n        this.position = position || vec3(0, 5, 0);\r\n    }\r\n\r\n}","import { Light } from \"./Light\";\r\nimport { vec3 } from \"../Utils/Vector_Matrix\";\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Components that represents a spot light.\r\n */\r\nexport class SpotLight extends Light{\r\n    position;\r\n    cutOff;\r\n    outerCutOff;\r\n    constant;\r\n    linear;\r\n    quadratic;\r\n    direction;\r\n\r\n    constructor(diffuse, ambient, specular, position, constant, linear, quadratic, cutOff, outerCutOff, direction){\r\n        super(diffuse, ambient, specular);\r\n        this.name = 'SpotLight';\r\n        this.constant = constant || 1.0;\r\n        this.linear = linear || 0.09;\r\n        this.quadratic = quadratic || 0.032;\r\n        this.cutOff = cutOff || 0.4;\r\n        this.outerCutOff = outerCutOff || 0.5;\r\n        this.direction = direction || vec3(1, -1, 0);\r\n        this.position = position || vec3(0,0,0);\r\n    }\r\n\r\n}","/**\n * @author Alberto Contorno\n */\nimport \"./styles.css\";\nimport { WebGLUtils } from \"./common/webgl-utils\";\nimport { Engine } from \"./common/Engine\";\nimport { InputManager } from \"./common/inputManager\";\nimport { Scene } from \"./common/Scene\";\nimport { Camera } from \"./common/Camera\";\nimport { SceneObject } from \"./common/Object\";\nimport { Mesh } from \"./common/Mesh\";\nimport { Texture } from \"./common/Texture\";\nimport { DirectionalLight } from \"./common/Components/DirectionalLight\";\nimport { PointLight } from './common/Components/PointLight';\nimport { SpotLight } from './common/Components/SpotLight';\nimport { vec2, vec3, vec4, perspective, lookAt, scale, add, subtract,  } from \"./common/Utils/Vector_Matrix\";\nimport { Material } from \"./common/Material\";\nvar inputs = new InputManager();\n\nconst up = vec3(0.0, 1.0, 0.0);\n\nconst canvas = document.getElementById(\"app\");\ninputs.lockMouse(canvas);\nconst gl = WebGLUtils.setupWebGL(canvas);\nvar aspect = gl.drawingBufferWidth / gl.drawingBufferHeight;\nvar camera = new Camera(vec3(0, 0, 0), up, 5, \"perspective\", {},\n  { fov: 45, aspect: aspect, near: 0.1, far: 100 },\n  25, { maxLevel: 3, 0: 30, 1: 45, 2: 75, 3: 90 }, 1\n);\n/* var camera = new Camera(vec3(0, 0, 0), up, 5, \"orthographic\", {},\n  { left: -1, right: 1, up: 1, bottom: -1, near: 0.1, far: 100 },\n  25, { maxLevel: 3, 0: 30, 1: 45, 2: 75, 3: 90 }, 1\n); */\ngl.enable(gl.DEPTH_TEST);\ngl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\ngl.clearColor(0.0, 0.0, 0.0, 1.0);\nvar engine = new Engine(gl, {showFps: true});\nvar scene = new Scene();\n\nlet vertices = [\n  vec4(-0.5, -0.5, 0.5, 1.0), //l b 0 0\n  vec4(-0.5, 0.5, 0.5, 1.0), //l t  0 1\n  vec4(0.5, -0.5, 0.5, 1.0), //r b 1 0\n  vec4(0.5, 0.5, 0.5, 1.0), //r t 1 1\n\n  vec4(-0.5, -0.5, -0.5, 1.0), //4 l b \n  vec4(-0.5, 0.5, -0.5, 1.0), //5 l t\n  vec4(0.5, -0.5, -0.5, 1.0), //6 r b\n  vec4(0.5, 0.5, -0.5, 1.0) //7 r t\n];\n\nlet vertices1 = [\n  vec4(-0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, 0.5, -0.5, 1.0),\n  vec4(0.5, 0.5, -0.5, 1.0),\n  vec4(-0.5, 0.5, -0.5, 1.0),\n  vec4(-0.5, -0.5, -0.5, 1.0),\n\n  vec4(-0.5, -0.5, 0.5, 1.0),\n  vec4(0.5, -0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, -0.5, 0.5, 1.0),\n\n  vec4(-0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, -0.5, 1.0),\n  vec4(-0.5, -0.5, -0.5, 1.0),\n  vec4(-0.5, -0.5, -0.5, 1.0),\n  vec4(-0.5, -0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, 0.5, 1.0),\n\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n\n  vec4(-0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, 0.5, 1.0),\n  vec4(0.5, -0.5, 0.5, 1.0),\n  vec4(-0.5, -0.5, 0.5, 1.0),\n  vec4(-0.5, -0.5, -0.5, 1.0),\n\n  vec4(-0.5, 0.5, -0.5, 1.0),\n  vec4(0.5, 0.5, -0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, -0.5, 1.0)\n];\n\nvar normals = [\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0)\n]\n\nvar floorTextCoords = [\n  vec2(0, 0),\n  vec2(1, 0),\n  vec2(1,1),//\n  vec2(1, 1),\n  vec2(0, 1),\n  vec2(0, 0),//\n\n  vec2(0, 0),\n  vec2(1, 0),\n  vec2(1, 1),//\n  vec2(1, 1),\n  vec2(0, 1),\n  vec2(0, 0),//\n\n  vec2(0, 0),\n  vec2(1, 0),\n  vec2(1, 1),//\n  vec2(1, 1),\n  vec2(0, 1),\n  vec2(0, 0),//\n\n  vec2(0, 0),\n  vec2(1, 0),\n  vec2(1, 1),//\n  vec2(1, 1),\n  vec2(0, 1),\n  vec2(0, 0),//\n\n  vec2(0, 0),\n  vec2(1, 0),\n  vec2(1, 1),//\n  vec2(1, 1),\n  vec2(0, 1),\n  vec2(0, 0),//\n  \n  vec2(0, 0),\n  vec2(1, 0),\n  vec2(1, 1),//\n  vec2(1, 1),\n  vec2(0, 1),\n  vec2(0, 0),//\n];\n\nlet indices = [\n  //front\n  0,  1,  2,\n  2,  1,  3,  \n  //back\n  4,  5,  6,\n  6,  5,  7,\n  //left\n  0,  1,  4,\n  4,  1,  5,\n    //right\n  2,  3,  6,  \n  6,  3,  7,\n  //top\n  3,  1,  7,\n  7,  1,  5,\n  //bottom\n  2,  0,  6,\n  6,  0,  4\n];\n\nfunction handleInputs() {\n  if (\n    inputs.isKeyDown(inputs.keyCodes.KEYNAMES.shift) &&\n    inputs.isKeyDown(inputs.keyCodes.KEYNAMES.w)\n  ) {\n    camera.moveUp(engine.time.deltaTime);\n  } else if (\n    inputs.isKeyDown(inputs.keyCodes.KEYNAMES.shift) &&\n    inputs.isKeyDown(inputs.keyCodes.KEYNAMES.s)\n  ) {\n    camera.moveDown(engine.time.deltaTime);\n  } else {\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.a)) {\n      camera.moveLeft(engine.time.deltaTime);\n    }\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.s)) {\n      camera.moveBackwards(engine.time.deltaTime);\n    }\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.d)) {\n      camera.moveRight(engine.time.deltaTime);\n    }\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.w)) {\n      camera.moveForward(engine.time.deltaTime);\n    }\n\n    if(inputs.isKeyDown(inputs.keyCodes.KEYNAMES.q)){\n      obj3.transform.rotation[0] +=4;\n      obj3.transform.rotation[1] += 5;\n      obj3.transform.rotation[2] += 4;\n    }\n\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.r)) {\n      robotLowerArm.transform.rotation[0] += 4;\n    }\n\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.t) ) {\n      robotBody.transform.rotation[1] += 4;\n    }\n\n    if(inputs.isKeyDown(inputs.keyCodes.KEYNAMES.o)) {\n      pointLight_obj.transform.position[0] = 4 * Math.sin(engine.time.time);\n      pointLight.position[0] = 4 * Math.sin(engine.time.time);\n\n      pointLight_obj.transform.position[2] = 4 * Math.cos(engine.time.time);\n      pointLight.position[2] = 4 * Math.cos(engine.time.time);\n    } \n  }\n\n  camera.updateCameraDirection(\n    inputs.getMouseMovX(),\n    inputs.getMouseMovY(),\n    engine.time.deltaTime\n  );\n}\n\nvar obj = new SceneObject(null, 'obj');\nvar obj2 = new SceneObject(null, 'obj2');\nvar obj3 = new SceneObject(null, 'obj3');\nvar lightsObj = new SceneObject(null, 'lights');\nvar robotBody = new SceneObject(null, 'robotBody');\nvar robotUpperArm = new SceneObject(null, 'robotUpperArm');\nvar robotLowerArm = new SceneObject(null, 'robotLowerArm');\n\nvar mat = new Material(vec3(0.0, 0.0,0.1), vec3(0.1, 0.0, 0.7));\nmat.shininess = 256;\nobj.material = mat;\nobj2.material = mat;\nobj3.material = mat;\n\nrobotBody.material = new Material(vec3(0.2, 0.0,0.0), vec3(0.9, 0.1, 0.2));\nrobotUpperArm.material = mat;\nrobotLowerArm.material = mat;\n\nvar floor = new SceneObject(null, 'floor');\nfloor.material = new Material(vec3(0.2, 0.0,0.0), vec3(0.9, 0.1, 0.2));\nfloor.transform.position = [0, -0.75, 0];\nfloor.transform.scale = [5, 0.5, 5];\nlet floorMesh = new Mesh(gl, vertices1, null, null, null, null,  floorTextCoords, normals);\nvar textureFloor = new Texture(0, null, 'assets/download.jpg', gl.RGB, gl.RGB);\ntextureFloor.LoadTexture(gl);\nfloorMesh.textures.DIFFUSE_MAP = textureFloor;\nfloor.addMesh(floorMesh);\n\nscene.addObject(floor);\nscene.addObject(obj);\nscene.addObject(obj2);\nscene.addObject(obj3);\nscene.addObject(robotBody);\nscene.addObject(robotUpperArm);\nscene.addObject(robotLowerArm);\nscene.addObject(lightsObj);\n\nlet cube = new Mesh(gl, vertices1, null, null, null, null, null, normals);\nlet cube2 = new Mesh(gl, vertices1, null, null, null, null, null, normals);\nlet cube3 = new Mesh(gl, vertices1, null, null, null, null, null, normals);\n\nobj.addMesh(cube);\nobj.transform.rotation = [0, 0, 0];\n\nobj2.addMesh(cube2);\nobj2.transform.position = [2, 0, 0];\nobj2.transform.rotation = [0, 50, 0];\nobj3.addMesh(cube3);\n\nobj2.addChild(obj3);\nobj3.transform.position = [-1, 0, -3];\nobj3.transform.scale = [1, 1, 2];\n//obj.addMesh(cube3);\n\nrobotBody.addMesh(cube3);\nrobotBody.addChild(robotLowerArm);\nrobotBody.transform.position = [1, 2, 0];\nrobotBody.transform.rotation = [0, 30, 0];\nrobotLowerArm.addMesh(cube3);\nrobotLowerArm.addChild(robotUpperArm);\nrobotLowerArm.transform.position = [0, 1, 0];\nrobotLowerArm.transform.scale = [0.5, 1, 0.5];\nrobotLowerArm.transform.rotation = [0, 30, 0];\nrobotUpperArm.addMesh(cube3);\nrobotUpperArm.transform.position = [0, 1, 0];\nrobotUpperArm.transform.scale = [0.3, 1, 0.3];\n\nlet dirLight = new DirectionalLight();\ndirLight.ambient = vec3(0.1, 0.1, 0.1);\ndirLight.diffuse = vec3(1.0, 1.0, 1.0);\n\nvar pointLight_obj = new SceneObject(null, 'dirLight');\npointLight_obj.material = new Material(vec3(1.0, 1.0, 1.0), vec3(1.0, 1.0, 1.0));\nscene.addObject(pointLight_obj);\npointLight_obj.addMesh(cube);\npointLight_obj.transform.position = [0.0, 4.0, -7.0];\npointLight_obj.transform.scale = [.2, .2, .2];\n\nlet pointLight = new PointLight();\npointLight.position = vec3(0.0, 4.0, -7.0);\npointLight.diffuse = vec3(1.0, 1.0, 1.0);\n\nvar pointLight_obj2 = new SceneObject(null, 'dirLight');\npointLight_obj2.material = new Material(vec3(1.0, 1.0, 1.0), vec3(1.0, 1.0, 1.0));\nscene.addObject(pointLight_obj2);\npointLight_obj2.addMesh(cube);\npointLight_obj2.transform.position = [0.0, -3.0, 0.0];\npointLight_obj2.transform.scale = [.2, .2, .2];\n\nlet pointLight2 = new PointLight();\npointLight2.position = vec3(0.0, -3.0, 0.0);\npointLight2.diffuse = vec3(1.0, 1.0, 1.0);\n\nlet spotLight = new SpotLight();\nspotLight.direction = vec3(0, 1.0, 0.0);\nspotLight.position = vec3(0.0, 2.0, -3.0);\nspotLight.cutOff = 0.011;\nspotLight.outerCutOff = 0.512;\nspotLight.ambient = vec3(1.0, 0.1, 0.1);\nlightsObj.addComponent(dirLight);\nlightsObj.addComponent(pointLight);\nlightsObj.addComponent(pointLight2);\n//obj3.addComponent(spotLight);\nvar gameManager = new SceneObject(null, 'gm');\nconsole.log(engine);\ngameManager.onUpdate =  function(){\n  handleInputs();\n  inputs.clearMousePosition();\n  obj.transform.rotation[1] += 0.1;\n  obj3.transform.rotation[1] += 0.1;\n}\nscene.addObject(gameManager);\nscene.addCamera(camera);\nengine.addScene(scene);\n\n\nfunction main() {\n  engine.doRendering(); \n}\n\nmain();\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}