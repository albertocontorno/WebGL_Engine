{"version":3,"sources":["src/common/webgl-utils.js","node_modules/@babel/runtime/helpers/arrayLikeToArray.js","node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","node_modules/@babel/runtime/helpers/iterableToArray.js","node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","node_modules/@babel/runtime/helpers/nonIterableSpread.js","node_modules/@babel/runtime/helpers/toConsumableArray.js","node_modules/@babel/runtime/helpers/classCallCheck.js","node_modules/@babel/runtime/helpers/createClass.js","node_modules/@babel/runtime/helpers/defineProperty.js","src/common/shadersUtils.js","src/common/Time.js","src/common/Engine.js","src/common/keyCodes.js","src/common/inputManager.js","node_modules/@babel/runtime/helpers/typeof.js","node_modules/@babel/runtime/helpers/assertThisInitialized.js","node_modules/@babel/runtime/helpers/setPrototypeOf.js","node_modules/@babel/runtime/helpers/inherits.js","node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","node_modules/@babel/runtime/helpers/getPrototypeOf.js","src/common/Component.js","src/common/Components/Transform.js","src/common/Utils/Vector_Matrix.js","src/common/Camera.js","src/common/Object.js","src/common/Scene.js","node_modules/@babel/runtime/helpers/arrayWithHoles.js","node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","node_modules/@babel/runtime/helpers/nonIterableRest.js","node_modules/@babel/runtime/helpers/slicedToArray.js","src/common/Shader.js","src/common/ShaderProgram.js","src/common/Utils/constants.js","src/shaders/shaderDefaults.js","src/common/Material.js","src/shaders/ShaderFactory.js","src/common/Mesh.js","src/common/Texture.js","src/common/Components/Light.js","src/common/Components/DirectionalLight.js","src/common/Components/PointLight.js","src/common/Components/SpotLight.js","node_modules/regenerator-runtime/runtime.js","node_modules/@babel/runtime/regenerator/index.js","node_modules/@babel/runtime/helpers/asyncToGenerator.js","src/common/Utils/Request.js","src/common/Loaders/ModelLoader.js","src/common/Loaders/ObjLoader.js","src/common/Utils/NormalsGenerator.js","src/index.js","node_modules/parcel-bundler/src/builtins/bundle-url.js","node_modules/parcel-bundler/src/builtins/css-loader.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["WebGLUtils","makeFailHTML","msg","GET_A_WEBGL_BROWSER","OTHER_PROBLEM","setupWebGL","canvas","opt_attribs","showLink","str","container","parentNode","innerHTML","window","WebGLRenderingContext","context","create3DContext","names","ii","length","getContext","e","console","log","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","element","setTimeout","ShaderUtils","gl","shaders","shaderProgram","createProgram","forEach","shader","compiledShader","loadAndCompileShader","type","source","attachShader","linkProgram","createShader","shaderSource","compileShader","deleteShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","program","getProgramParameter","LINK_STATUS","getProgramInfoLog","deleteProgram","name","value","glUniform1f","getUniformLocation","glUniform1i","glUniform4fv","Time","currentTime","lastTime","performance","Date","now","updateTime","frames","secondsCounter","notifyFps","deltaTime","time","fpsFnSub","fn","Engine","opt","clearColor","Math","radians","degrees","pi","PI","clamp","number","min","max","setGlContext","showFps","setFpsCounter","scene","scenes","push","onAfterSceneAdded","activeScene","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","mainCamera","renderScene","doRendering","bind","document","createElement","idNum","round","random","setAttribute","id","text","appendChild","body","subscribeFps","keys","KEYMAP","STRG","CTRL","CTRLRIGHT","CTRLR","SHIFT","RETURN","ENTER","BACKSPACE","BCKSP","ALT","ALTR","ALTRIGHT","SPACE","WIN","MAC","FN","UP","DOWN","LEFT","RIGHT","ESC","DEL","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","KEYNAMES","backspace","tab","enter","shift","ctrl","alt","pause_break","caps_lock","escape","page_up","end","home","left_arrow","up_arrow","right_arrow","down_arrow","insert","delete","a","b","c","d","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","select_key","multiply","add","subtract","divide","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","num_lock","scroll_lock","semi_colon","equal_sign","comma","dash","period","forward_slash","grave_accent","open_bracket","backslash","closebracket","single_quote","KEYCODES","MOUSECODES","MOUSENAMES","left","center","right","InputManager","movX","movY","start","onkeydown","which","updateKeyPressed","onkeyup","updateKeyUnPressed","onmousedown","updateMousePressed","onmouseup","updateMouseUnPressed","onmousemove","clientX","clientY","movementX","movementY","updateMousePosition","keysPressed","mousePosition","el","requestPointerLock","mozRequestPointerLock","exitPointerLock","mozExitPointerLock","onclick","mouseLockedEl","mouseLocked","keyCode","code","mousePressed","lastMousePosition","Y","Component","nextId","registeredComponents","Transform","parent","t1","t2","transform","position","rotation","scale","_argumentsToArray","args","concat","apply","Array","prototype","slice","equal","matrix","vec2","result","arguments","splice","vec3","vec4","scalarProduct","mat2","mat3","mat4","mult","sum","translate","isArray","rotate","angle","axis","normalize","cos","omc","sin","rotateX","theta","rx","rotateY","ry","rotateZ","rz","scalem","lookAt","eye","at","up","cross","negate","dot","ortho","bottom","top","near","far","perspective","fovy","aspect","tan","transpose","sqrt","excludeLastComponent","last","pop","len","isFinite","mix","flatten","elemsAreArrays","floats","Float32Array","idx","sizeof","byteLength","printm","det2","det3","det4","m0","m1","m2","m3","det","inverse2","inverse3","a00","a01","a02","a10","a11","a12","a20","a21","a22","inverse4","a03","a13","a23","a30","a31","a32","a33","inverse","normalMatrix","flag","Camera","speed","moveKeys","projOptions","sensitivity","zooms","forward","backward","addEventListener","event","zoomLevel","sign","deltaY","maxLevel","setZoomLevel","proj","fov","updateCameraDirection","_updateCameraDirection","ytop","direction","getFrontVector","offsetX","offsetY","yaw","pitch","newPos","level","SceneObject","startCallback","onStart","components","mesh","meshes","warning","child","children","transformToRender","summed","getTransformToRender","camera","lights","lightsTypes","render","material","component","warn","onAfterAdded","onAfterRemoved","Scene","vertex","fragment","engine","cameras","cam","alreadyPresent","obj","objects","objectsMap","light","parentObj","lightIndex","findIndex","onUpdate","Shader","VERTEX_SHADER","FRAGMENT_SHADER","shaderError","checkShaderCompilingErrors","errors","other","ShaderProgram","createShaderProgramFromShaders","checkShaderProgramLinkingErrors","LightTypes","DirectionalLight","PointLight","SpotLight","TextureTypes","DiffuseMap","SpecularMap","NormalMap","LightMap","BumpMap","ShadowMap","EmptyTexture","width","height","border","srcFormat","internalFormat","srcType","pixels","Uint8Array","DefTextCoords","vMainBody_fPos_Calc","vMainBody_fPos_Calc_TBN","vColor_In","vColor_Out","vColor_Assign","vTextureCoords_In","vTextureCoords_Out","vTextureCoords_Assign","vTangent_In","vTangent_Out","vTangent_Assign","vTangentCalc","vTbn_Out","vTbn_Assing","vertexCompleteShaderObj","version","lightsPosUniform","lightsPosOut","colorIn","textureCoordsIn","textureCoordsOut","normalIn","tangentIn","tangentOut","modelViewProj","colorOut","normalOut","tbnOut","fragPosOut","mainStart","mainBodyNormalCalc","textureCoordsAssign","tangentAssign","tbnCalc","tbnAssign","mainBodyFPos","colorAssign","mainBodyOutput","materialStruct","DirectionalLightShader","PointLightShader","PointLightShader_NoPos","SpotLightShader","SpotLightShader_NoPos","DirLightFuncDec","PointLightFuncDec","SpotLightFuncDec","LightAmbientWithTexture_Diff_Spec","LightDiffuseWithTexture_Diff_Spec","LightSpecularWithTexture_Diff_Spec","LightAmbientWithTexture_Diff","LightDiffuseWithTexture_Diff","LightSpecularWithTexture_Diff","LightAmbientWithTexture_Spec","LightDiffuseWithTexture_Spec","LightSpecularWithTexture_Spec","DirLightFuncImplObj","signature","bodyStandandPart","bodyAmbient","bodyDiffuse","bodySpecular","bodyReturn","PointLightFuncImplObj","bodyAttenuation","SpotLightFuncImplObj","materialVar","fColorIn","diffuseMapVar","specularMapVar","lightMapVar","bumbMapVar","shadowMapVar","normalMapVar","fTextureCoords","fDiffuseCoords","fOutput_Lights","fOutput_Lights_Color","fNormalCalc_noTangents","fNormalCalc_Tangents","fTBN_In","fTangent_In","fTbn_Calc","fragmentShaderCompleteObj","precision","lightsStructs","lightsFuncDec","tbnIn","fragPosIn","texturesCoords","samplers","viewPos","lightsUniform","normalCalc","lightsCalc","textureCalc","fragOutput","mainEnd","lightsFuncImpl","textureFuncImpl","Material","ambient","diffuse","specular","shininess","ShaderFactory","props","vertexSource","shaderDefault","vertexColoring","textures","Object","values","join","fragmentSource","hasLights","getTexturesCalc","getLightsStructsFromLights","getLightsFuncDec","getLightsVarsFromLights","doLightCalcs","getLightsFuncImpl","sources","lightSource","setLightSourceTextures","inUniforms","outPos","lightType","tangentLightsCalc","Mesh","vertices","indices","textCoords","normals","tangents","colors","set","keepData","TRIANGLES","assign","DIFFUSE_MAP","SPECULAR_MAP","NORMAL_MAP","LIGHT_MAP","BUMP_MAP","SHADOW_MAP","VAO","createVertexArray","bindVertexArray","VBO","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","positionLoc","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","NBO","normalLoc","TBO","tangentLoc","locations","textCoordBuffer","textCoordLoc","EBO","ELEMENT_ARRAY_BUFFER","Uint16Array","CBO","colorsLoc","modelLoc","viewLoc","projLoc","unbindVAO","object","modelMatrix","traslationMatrix","rotationMatrixX","rotationMatrixY","rotationMatrixZ","scaleMatrix","getModelMatrix","lightName","lightLocs","constant","linear","quadratic","cutOff","outerCutOff","viewPosLoc","materialLocs","getDirectionalLightLocations","getPointLightLocations","getSpotLightLocations","texturesLocs","entries","texture","shaderUpdated","CreateVertexShaderFromProperties","CreateFragmentShaderFromProperties","key","getLocations","createAndLoadBuffers","updateShadersAndProgram","useProgram","projMatrix","getProjectionMatrix","viewMatrix","getViewMatrix","uniformMatrix4fv","uniform3fv","uniform1f","setupDirectionalLight","setupPointLight","setupSpotLight","loc","uniform1i","textureUnit","ActiveTexture","drawElements","UNSIGNED_SHORT","drawArrays","DisactiveTexture","destroyProgram","destroyShaders","Texture","gl_type","imagePath","s_texelType","texelType","params","createTexture","bindTexture","TEXTURE_2D","texImage2D","UNSIGNED_BYTE","textureSource","Image","crossOrigin","src","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","TEXTURE_MAG_FILTER","LINEAR","_loaded","generateMipmap","removeEventListener","activeTexture","TEXTURE0","pixelStorei","UNPACK_FLIP_Y_WEBGL","flipY","deleteTexture","lightTypes","Light","registerLight","constructor","unregisterLight","HTTP_METHOD","HEAD","GET","POST","PUT","PATCH","DELETE","HTTP_RESPONSE_STATUS","OK","CREATED","FORBIDDEN","NOT_FOUND","INTERNAL_SERVER_ERROR","Request","url","method","options","data","Promise","resolve","reject","_options","methods","headers","contentType","JSON","stringify","fetch","then","res","header","includes","json","catch","err","ModelLoader","path","ObjLoader","objPositions","objTexcoords","objNormals","objColors","objVertexData","webglVertexData","materialLibs","geometries","geometry","groups","noop","newGeometry","undefined","setGeometry","texcoord","normal","color","addVertex","vert","ptn","split","objIndexStr","objIndex","parseInt","index","keywords","parts","map","parseFloat","vn","vt","numTriangles","tri","mtllib","unparsedArgs","usemtl","keywordRE","lines","lineNo","line","trim","startsWith","exec","keyword","handler","fromEntries","filter","array","materials","newmtl","Ns","Ka","Kd","Ks","Ke","emissive","map_Kd","diffuseMap","parseMapArgs","map_Ns","specularMap","map_Bump","normalMap","Ni","opticalDensity","opacity","illum","toVec3","generateTangents","verteces","texcoords","numFaces","p1","p2","p3","uv1","uv2","uv3","edge1","edge2","deltaUV1","deltaUV2","tangent","Number","inputs","getElementById","lockMouse","drawingBufferWidth","drawingBufferHeight","enable","DEPTH_TEST","viewport","req","reqMtl","all","send","mat","loader","parse","addObject","mtl","parseMTL","oo","verts","verts_n","text_coords","ooMat","tangents_","ooMesh","addMesh","RGB","LoadTexture","handleInputs","isKeyDown","keyCodes","moveUp","moveDown","moveLeft","moveBackwards","moveRight","moveForward","obj3","robotLowerArm","robotBody","pointLight_obj","pointLight","getMouseMovX","getMouseMovY","vertices1","cube","lightsObj","dirLight","spotLight","addComponent","gameManager","clearMousePosition","addCamera","addScene","main","bundleURL","getBundleURLCached","getBundleURL","Error","matches","stack","match","getBaseURL","replace","exports","bundle","require","updateLink","link","newLink","cloneNode","onload","remove","href","insertBefore","nextSibling","cssTimeout","reloadCSS","links","querySelectorAll","module","OVERLAY_ID","OldModule","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","overlay","createErrorOverlay","stackTrace","innerText","getParents","modules","parents","dep","Function","deps","cached","cache","some","cb"],"mappings":"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L,GAAmBA,WAAW,IAAI,GAAlC;AACA,UAAKzQ,SAAL,GAAiBA,SAAS,IAAI,yBAAK,CAAL,EAAQ,CAAC,CAAT,EAAY,CAAZ,CAA9B;AACA,UAAK3H,QAAL,GAAgBA,QAAQ,IAAI,yBAAK,CAAL,EAAO,CAAP,EAAS,CAAT,CAA5B;AAT0G;AAU7G;;;EAnB0B0c;;;;ACP/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["/*\r\n * Copyright 2010, Google Inc.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are\r\n * met:\r\n *\r\n *     * Redistributions of source code must retain the above copyright\r\n * notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above\r\n * copyright notice, this list of conditions and the following disclaimer\r\n * in the documentation and/or other materials provided with the\r\n * distribution.\r\n *     * Neither the name of Google Inc. nor the names of its\r\n * contributors may be used to endorse or promote products derived from\r\n * this software without specific prior written permission.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\r\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\r\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\r\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\r\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\r\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\r\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n */\r\n\r\n\r\n/**\r\n * @fileoverview This file contains functions every webgl program will need\r\n * a version of one way or another.\r\n *\r\n * Instead of setting up a context manually it is recommended to\r\n * use. This will check for success or failure. On failure it\r\n * will attempt to present an approriate message to the user.\r\n *\r\n *       gl = WebGLUtils.setupWebGL(canvas);\r\n *\r\n * For animated WebGL apps use of setTimeout or setInterval are\r\n * discouraged. It is recommended you structure your rendering\r\n * loop like this.\r\n *\r\n *       function render() {\r\n *         window.requestAnimFrame(render, canvas);\r\n *\r\n *         // do rendering\r\n *         ...\r\n *       }\r\n *       render();\r\n *\r\n * This will call your rendering function up to the refresh rate\r\n * of your display but will stop rendering if your app is not\r\n * visible.\r\n */\r\n\r\nexport const WebGLUtils = function() {\r\n\r\n/**\r\n * Creates the HTLM for a failure message\r\n * @param {string} canvasContainerId id of container of th\r\n *        canvas.\r\n * @return {string} The html.\r\n */\r\nvar makeFailHTML = function(msg) {\r\n  return '' +\r\n    '<table style=\"background-color: #8CE; width: 100%; height: 100%;\"><tr>' +\r\n    '<td align=\"center\">' +\r\n    '<div style=\"display: table-cell; vertical-align: middle;\">' +\r\n    '<div style=\"\">' + msg + '</div>' +\r\n    '</div>' +\r\n    '</td></tr></table>';\r\n};\r\n\r\n/**\r\n * Mesasge for getting a webgl browser\r\n * @type {string}\r\n */\r\nvar GET_A_WEBGL_BROWSER = '' +\r\n  'This page requires a browser that supports WebGL.<br/>' +\r\n  '<a href=\"http://get.webgl.org\">Click here to upgrade your browser.</a>';\r\n\r\n/**\r\n * Mesasge for need better hardware\r\n * @type {string}\r\n */\r\nvar OTHER_PROBLEM = '' +\r\n  \"It doesn't appear your computer can support WebGL.<br/>\" +\r\n  '<a href=\"http://get.webgl.org/troubleshooting/\">Click here for more information.</a>';\r\n\r\n/**\r\n * Creates a webgl context. If creation fails it will\r\n * change the contents of the container of the <canvas>\r\n * tag to an error message with the correct links for WebGL.\r\n * @param {Element} canvas. The canvas element to create a\r\n *     context from.\r\n * @param {WebGLContextCreationAttirbutes} opt_attribs Any\r\n *     creation attributes you want to pass in.\r\n * @return {WebGLRenderingContext} The created context.\r\n */\r\nvar setupWebGL = function(canvas, opt_attribs) {\r\n  function showLink(str) {\r\n    var container = canvas.parentNode;\r\n    if (container) {\r\n      container.innerHTML = makeFailHTML(str);\r\n    }\r\n  };\r\n\r\n  if (!window.WebGLRenderingContext) {\r\n    showLink(GET_A_WEBGL_BROWSER);\r\n    return null;\r\n  }\r\n\r\n  var context = create3DContext(canvas, opt_attribs);\r\n  if (!context) {\r\n    showLink(OTHER_PROBLEM);\r\n  }\r\n  return context;\r\n};\r\n\r\n/**\r\n * Creates a webgl context.\r\n * @param {!Canvas} canvas The canvas tag to get context\r\n *     from. If one is not passed in one will be created.\r\n * @return {!WebGLContext} The created context.\r\n */\r\nvar create3DContext = function(canvas, opt_attribs) {\r\n  var names = [\"webgl2\", \"webgl\", \"experimental-webgl\", \"webkit-3d\", \"moz-webgl\"];\r\n  var context = null;\r\n  for (var ii = 0; ii < names.length; ++ii) {\r\n    try {\r\n      context = canvas.getContext(names[ii], opt_attribs);\r\n    } catch(e) {}\r\n    if (context) {\r\n      console.log(context);\r\n      break;\r\n    }\r\n  }\r\n  return context;\r\n}\r\n\r\nreturn {\r\n  create3DContext: create3DContext,\r\n  setupWebGL: setupWebGL\r\n};\r\n}();\r\n\r\n/**\r\n * Provides requestAnimationFrame in a cross browser way.\r\n */\r\nwindow.requestAnimFrame = (function() {\r\n  return window.requestAnimationFrame ||\r\n         window.webkitRequestAnimationFrame ||\r\n         window.mozRequestAnimationFrame ||\r\n         window.oRequestAnimationFrame ||\r\n         window.msRequestAnimationFrame ||\r\n         function(/* function FrameRequestCallback */ callback, /* DOMElement Element */ element) {\r\n           window.setTimeout(callback, 1000/60);\r\n         };\r\n})();\r\n\r\n\r\n","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","export class ShaderUtils {\n\n    gl;\n\n    constructor(gl) {\n      this.gl = gl;\n    }\n\n    static setGlContext(gl){\n      this.gl = gl;\n    }\n\n    static compileShadersAndcreateProgram(shaders) {\n      const shaderProgram = this.gl.createProgram();\n      shaders.forEach(shader => {\n          let compiledShader = this.loadAndCompileShader(shaders.type, shaders.source);\n          this.gl.attachShader(shaderProgram, compiledShader);\n      });\n      this.gl.linkProgram(shaderProgram);\n      return shaderProgram;\n    }\n\n    static loadAndCompileShader(type, source) {\n      console.log('[SHADER] Compiling ->', ' Type: ', type, '- Source: '/* , source */)\n      let shader = this.gl.createShader(type);\n      this.gl.shaderSource(shader, source);\n      this.gl.compileShader(shader);\n      return shader;\n    }\n\n    /**\n     * @param {[vertex, fragment]} shaders \n     */\n    static createShaderProgramFromShaders(shaders) {\n      console.log('[SHADER_PROGRAM] Creating ->', ' Shaders: ', shaders);\n      const shaderProgram = this.gl.createProgram();\n    \n      shaders.forEach(shader => {\n        this.gl.attachShader(shaderProgram, shader);\n        this.gl.deleteShader(shader);\n      });\n      this.gl.linkProgram(shaderProgram);\n      return shaderProgram;\n    }\n\n    static checkShaderCompilingErrors(shader) {\n      if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\n          return this.gl.getShaderInfoLog(shader);\n      } else return null;\n    }\n\n    static checkShaderProgramLinkingErrors(program) {\n      if (!this.gl.getProgramParameter(program, this.gl.LINK_STATUS)) {\n          return this.gl.getProgramInfoLog(program);\n      } else return null;\n    }\n\n    static destroyShaderProgram(program){\n      this.gl.deleteProgram(program);\n    }\n\n    static destroyShader(shader){\n      this.gl.deleteShader(shader);\n    }\n\n    static setFloat(name, value) {\n      this.gl.glUniform1f(this.gl.getUniformLocation(name), value);\n    }\n\n    static setBool(name, value) {\n      this.gl.glUniform1i(this.gl.getUniformLocation(name), value);\n    }\n\n    static setInt(name, value) {\n      this.gl.glUniform1i(this.gl.getUniformLocation(name), value);\n    }\n\n    static setMatrix(name, value){\n      this.gl.glUniform4fv(this.gl.getUniformLocation(name), value);\n    }\n\n}\n","/** \r\n * @author Alberto Contorno\r\n * @class\r\n * Class representing the time. \r\n * It provides the current time (in ms from the start of the Engine)\r\n * a deltaTime between frames \r\n * and a FPS counter service to which something can subscribe\r\n */\r\nexport class Time{\r\n    /**\r\n     * @property {number} deltaTime- The time passed between the last frame (in ms) and the current one. Use it to make things indipendent from the frame rate.\r\n     * @property {number} time- The time passed since the start (in ms).\r\n     * @property {number} frames- The current number of frames passed since last second (not precise).\r\n     */\r\n    deltaTime = 0;\r\n    \r\n    time = 0;\r\n    currentTime = 0;\r\n    lastTime = 0;\r\n    secondsCounter = 0;\r\n    frames = 0;\r\n    fpsFnSub = null;\r\n    constructor() {\r\n        /**\r\n         * someProperty is an example property that is set to `true`\r\n         * @type {boolean}\r\n         * @public\r\n         */\r\n        this.currentTime = this.lastTime = (performance ? performance : Date).now();\r\n        this.updateTime();\r\n    }\r\n    /**\r\n     * Function that update the time\r\n     */\r\n    updateTime(){\r\n        this.frames++;\r\n        if(this.secondsCounter>=1){\r\n            this.notifyFps();\r\n            this.secondsCounter=0;\r\n            this.frames = 0;\r\n        }\r\n        this.currentTime = (performance ? performance : Date).now();\r\n        this.deltaTime = (this.currentTime - this.lastTime) * 0.001;\r\n        this.lastTime = this.currentTime;\r\n        this.time += this.deltaTime;\r\n        this.secondsCounter += this.deltaTime;\r\n        //window.requestAnimationFrame(this.updateTime.bind(this));\r\n    }\r\n\r\n    notifyFps(){ //subscribe\r\n        if (this.fpsFnSub){this.fpsFnSub();}\r\n    }\r\n\r\n    subscribeFps(fn){\r\n        this.fpsFnSub = fn;\r\n    }\r\n\r\n}\r\n","import {ShaderUtils} from './shadersUtils'\nimport { Time } from './Time';\n/**\n * @author Alberto Contorno\n * @class\n * class that represent the entire Engine.\n * It takes care of the main loop fo the rendering and of the updating of the time\n * It initialize the GL context, and maintains the list of scenes, of which only one is the active (rendered) one.\n */\nexport class Engine{ //TODO SCENE MANAGER\n    scenes = [];\n    activeScene;\n    gl;\n    time;\n    opt;\n    /**\n     * Create a new Engine and do the setup of all the environment.\n     * @param {WebGL_Context} gl The WebGl context obtained from a canvas. This will be the context of the entire Engine.\n     * used as the context of every Shader.\n     */\n    constructor(gl, opt = {clearColor: [0.0, 0.0, 0.0, 1.0]}){\n      Math.radians = degrees => {\n        var pi = Math.PI;\n        return degrees * (pi / 180);\n      };\n\n      Math.clamp = function (number, min, max) {\n        return Math.max(min, Math.min(number, max));\n      };\n      this.gl = gl;\n      this.time = new Time();\n      this.opt = opt;\n      ShaderUtils.setGlContext(this.gl);\n\n      if(this.opt){\n        if(this.opt.showFps){\n          this.setFpsCounter();\n        }\n        if(!this.opt.clearColor){\n          this.opt.clearColor = [0.0, 0.0, 0.0, 1.0];\n        }\n      }\n    }\n\n    /**\n     * \n     * @param {Scene} scene add a scene to the list of scenes that the Engine manages.\n     * If there is no active scene, the added scene is set as the active one.\n     */\n    addScene(scene){\n      this.scenes.push(scene);\n      scene.onAfterSceneAdded(this);\n      if (!this.activeScene){\n        this.activeScene = this.scenes.length - 1;\n      }\n    }\n\n    /**\n     * Starts the rendering and the update of the time at every frame.\n     */\n    doRendering() {\n      this.gl.clearColor(...this.opt.clearColor);\n      this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\n      if (this.scenes[this.activeScene] && this.scenes[this.activeScene].mainCamera){\n        this.scenes[this.activeScene].renderScene(this.gl);\n      }\n      this.time.updateTime();\n      window.requestAnimationFrame(this.doRendering.bind(this));\n    }\n\n    setFpsCounter(){\n      let container = document.createElement('div');\n      let idNum = Math.round(Math.random(0, 1) * 100);\n      container.setAttribute(\"style\",\n      `position: absolute;\n      top: 10px;\n      left: 20px;\n      color: lime;`);\n      container.id = 'glFpsCounterContainer_' + idNum;\n      let text = document.createElement('p');\n      text.id = 'glFpsCounterText_'+ idNum;\n      container.appendChild(text);\n      document.body.appendChild(container);\n      this.time.subscribeFps(() => { text.innerHTML = 'FPS: ' + this.time.frames; })\n    }\n}","export const keys = {\n\tKEYMAP: {\n\t\tSTRG: 17,\n\t\tCTRL: 17,\n\t\tCTRLRIGHT: 18,\n\t\tCTRLR: 18,\n\t\tSHIFT: 16,\n\t\tRETURN: 13,\n\t\tENTER: 13,\n\t\tBACKSPACE: 8,\n\t\tBCKSP: 8,\n\t\tALT: 18,\n\t\tALTR: 17,\n\t\tALTRIGHT: 17,\n\t\tSPACE: 32,\n\t\tWIN: 91,\n\t\tMAC: 91,\n\t\tFN: null,\n\t\tUP: 38,\n\t\tDOWN: 40,\n\t\tLEFT: 37,\n\t\tRIGHT: 39,\n\t\tESC: 27,\n\t\tDEL: 46,\n\t\tF1: 112,\n\t\tF2: 113,\n\t\tF3: 114,\n\t\tF4: 115,\n\t\tF5: 116,\n\t\tF6: 117,\n\t\tF7: 118,\n\t\tF8: 119,\n\t\tF9: 120,\n\t\tF10: 121,\n\t\tF11: 122,\n\t\tF12: 123\n\t},\n\tKEYNAMES: {\n\t\tbackspace: '8',\n\t\ttab: '9',\n\t\tenter: '13',\n\t\tshift: '16',\n\t\tctrl: '17',\n\t\talt: '18',\n\t\tpause_break: '19',\n\t\tcaps_lock: '20',\n\t\tescape: '27',\n\t\tpage_up: '33',\n\t\t'page down': '34',\n\t\tend: '35',\n\t\thome: '36',\n\t\tleft_arrow: '37',\n\t\tup_arrow: '38',\n\t\tright_arrow: '39',\n\t\tdown_arrow: '40',\n\t\tinsert: '45',\n\t\tdelete: '46',\n\t\t'0': '48',\n\t\t'1': '49',\n\t\t'2': '50',\n\t\t'3': '51',\n\t\t'4': '52',\n\t\t'5': '53',\n\t\t'6': '54',\n\t\t'7': '55',\n\t\t'8': '56',\n\t\t'9': '57',\n\t\ta: '65',\n\t\tb: '66',\n\t\tc: '67',\n\t\td: '68',\n\t\te: '69',\n\t\tf: '70',\n\t\tg: '71',\n\t\th: '72',\n\t\ti: '73',\n\t\tj: '74',\n\t\tk: '75',\n\t\tl: '76',\n\t\tm: '77',\n\t\tn: '78',\n\t\to: '79',\n\t\tp: '80',\n\t\tq: '81',\n\t\tr: '82',\n\t\ts: '83',\n\t\tt: '84',\n\t\tu: '85',\n\t\tv: '86',\n\t\tw: '87',\n\t\tx: '88',\n\t\ty: '89',\n\t\tz: '90',\n\t\t'left_window key': '91',\n\t\t'right_window key': '92',\n\t\tselect_key: '93',\n\t\t'numpad 0': '96',\n\t\t'numpad 1': '97',\n\t\t'numpad 2': '98',\n\t\t'numpad 3': '99',\n\t\t'numpad 4': '100',\n\t\t'numpad 5': '101',\n\t\t'numpad 6': '102',\n\t\t'numpad 7': '103',\n\t\t'numpad 8': '104',\n\t\t'numpad 9': '105',\n\t\tmultiply: '106',\n\t\tadd: '107',\n\t\tsubtract: '109',\n\t\t'decimal point': '110',\n\t\tdivide: '111',\n\t\tf1: '112',\n\t\tf2: '113',\n\t\tf3: '114',\n\t\tf4: '115',\n\t\tf5: '116',\n\t\tf6: '117',\n\t\tf7: '118',\n\t\tf8: '119',\n\t\tf9: '120',\n\t\tf10: '121',\n\t\tf11: '122',\n\t\tf12: '123',\n\t\tnum_lock: '144',\n\t\tscroll_lock: '145',\n\t\tsemi_colon: '186',\n\t\tequal_sign: '187',\n\t\tcomma: '188',\n\t\tdash: '189',\n\t\tperiod: '190',\n\t\tforward_slash: '191',\n\t\tgrave_accent: '192',\n\t\topen_bracket: '219',\n\t\tbackslash: '220',\n\t\tclosebracket: '221',\n\t\tsingle_quote: '222'\n\t},\n\tKEYCODES: {\n\t\t8: 'backspace',\n\t\t9: 'tab',\n\t\t13: 'enter',\n\t\t16: 'shift',\n\t\t17: 'ctrl',\n\t\t18: 'alt',\n\t\t19: 'pause_break',\n\t\t20: 'caps_lock',\n\t\t27: 'escape',\n\t\t33: 'page_up',\n\t\t34: 'page down',\n\t\t35: 'end',\n\t\t36: 'home',\n\t\t37: 'left_arrow',\n\t\t38: 'up_arrow',\n\t\t39: 'right_arrow',\n\t\t40: 'down_arrow',\n\t\t45: 'insert',\n\t\t46: 'delete',\n\t\t48: '0',\n\t\t49: '1',\n\t\t50: '2',\n\t\t51: '3',\n\t\t52: '4',\n\t\t53: '5',\n\t\t54: '6',\n\t\t55: '7',\n\t\t56: '8',\n\t\t57: '9',\n\t\t65: 'a',\n\t\t66: 'b',\n\t\t67: 'c',\n\t\t68: 'd',\n\t\t69: 'e',\n\t\t70: 'f',\n\t\t71: 'g',\n\t\t72: 'h',\n\t\t73: 'i',\n\t\t74: 'j',\n\t\t75: 'k',\n\t\t76: 'l',\n\t\t77: 'm',\n\t\t78: 'n',\n\t\t79: 'o',\n\t\t80: 'p',\n\t\t81: 'q',\n\t\t82: 'r',\n\t\t83: 's',\n\t\t84: 't',\n\t\t85: 'u',\n\t\t86: 'v',\n\t\t87: 'w',\n\t\t88: 'x',\n\t\t89: 'y',\n\t\t90: 'z',\n\t\t91: 'left_window key',\n\t\t92: 'right_window key',\n\t\t93: 'select_key',\n\t\t96: 'numpad 0',\n\t\t97: 'numpad 1',\n\t\t98: 'numpad 2',\n\t\t99: 'numpad 3',\n\t\t100: 'numpad 4',\n\t\t101: 'numpad 5',\n\t\t102: 'numpad 6',\n\t\t103: 'numpad 7',\n\t\t104: 'numpad 8',\n\t\t105: 'numpad 9',\n\t\t106: 'multiply',\n\t\t107: 'add',\n\t\t109: 'subtract',\n\t\t110: 'decimal point',\n\t\t111: 'divide',\n\t\t112: 'f1',\n\t\t113: 'f2',\n\t\t114: 'f3',\n\t\t115: 'f4',\n\t\t116: 'f5',\n\t\t117: 'f6',\n\t\t118: 'f7',\n\t\t119: 'f8',\n\t\t120: 'f9',\n\t\t121: 'f10',\n\t\t122: 'f11',\n\t\t123: 'f12',\n\t\t144: 'num_lock',\n\t\t145: 'scroll_lock',\n\t\t186: 'semi_colon',\n\t\t187: 'equal_sign',\n\t\t188: 'comma',\n\t\t189: 'dash',\n\t\t190: 'period',\n\t\t191: 'forward_slash',\n\t\t192: 'grave_accent',\n\t\t219: 'open_bracket',\n\t\t220: 'backslash',\n\t\t221: 'closebracket',\n\t\t222: 'single_quote'\n\t},\n\tMOUSECODES: {\n\t\t0: 'left',\n\t\t1: 'center',\n\t\t2: 'right'\n\t},\n\tMOUSENAMES: { left: 0, center: 1, right: 2 }\n};\n","import {keys} from './keyCodes';\n/**\n * @author Alberto Contorno\n * @class\n * Class used to manage the user inputs. It can manage keyboard and mouse.\n */\nexport class InputManager{\n  keysPressed = {};\n  mousePressed = {};\n  mousePosition = {x: 0, y: 0, movX: 0, movY: 0};\n  lastMousePosition = {x: 0, y: 0};\n\n  keyCodes = keys;\n  mouseLocked = false;\n  mouseLockedEl = null;\n\n  constructor(){\n    this.start();\n  }\n\n  start(){\n    window.onkeydown = ({ which }) => {\n      this.updateKeyPressed(which);\n    };\n    window.onkeyup = ({ which }) => {\n      this.updateKeyUnPressed(which);\n    }\n    window.onmousedown = ({ which }) => {\n      this.updateMousePressed(which);\n    }\n    window.onmouseup = ({ which }) => {\n      this.updateMouseUnPressed(which);\n    }\n    window.onmousemove = ({clientX, clientY, movementX, movementY}) => {\n      this.updateMousePosition(clientX, clientY, movementX, movementY);\n    }\n  }\n\n  stop(){\n    window.onkeydown = null;\n    window.onkeyup = null;\n    window.onmousedown = null;\n    window.onmouseup = null;\n    window.onmousemove = null;\n  }\n\n  clearKeyPressed() {\n    this.keysPressed = { };\n  }\n\n  clearMousePosition() {\n    this.mousePosition = {x:0, y:0, movX: 0, movY: 0};\n  }\n\n  lockMouse(el){\n    el.requestPointerLock = el.requestPointerLock ||\n      el.mozRequestPointerLock;\n\n    document.exitPointerLock = document.exitPointerLock ||\n      document.mozExitPointerLock;\n    \n    el.onclick = () => {\n      el.requestPointerLock();\n      this.mouseLockedEl = el;\n      this.mouseLocked = true;\n    }\n \n  }\n\n  unlockMouse(){\n    document.exitPointerLock();\n    this.mouseLocked = false;\n    this.mouseLockedEl.requestPointerLock = null;\n    document.exitPointerLock = null;\n    this.mouseLockedEl = null;\n  }\n\n  updateKeyPressed(keyCode){\n    this.keysPressed[keys.KEYCODES[keyCode]] = true;\n  }\n\n  updateKeyUnPressed(keyCode) {\n    this.keysPressed[keys.KEYCODES[keyCode]] = false;\n  }\n\n  updateMousePressed(code){\n    this.mousePressed[keys.MOUSECODES[code]] = true;\n  }\n\n  updateMouseUnPressed(code) {\n    this.mousePressed[keys.MOUSECODES[code]] = false;\n  }\n\n  updateMousePosition(x, y, movX, movY){\n    this.lastMousePosition.x = this.mousePosition.x;\n    this.lastMousePosition.y = this.mousePosition.y;\n    this.lastMousePosition.movX = this.mousePosition.movX;\n    this.lastMousePosition.movY = this.mousePosition.movY;\n\n    this.mousePosition.x = x;\n    this.mousePosition.y = y;\n    this.mousePosition.movX = movX;\n    this.mousePosition.movY = movY;\n  }\n\n  isKeyDown(keyCode){\n    return this.keysPressed[keys.KEYCODES[keyCode]] || false;\n  }\n\n  isKeyUp(keyCode){\n    return !this.keysPressed[keys.KEYCODES[keyCode]] || true\n  }\n\n  isMouseDown(code){\n    return this.mousePressed[keys.MOUSECODES[code]] || false;\n  }\n\n  isMouseUp(code){\n    return !this.mousePressed[keys.MOUSECODES[code]] || true;\n  }\n\n  getMousePosition(){\n    return this.mousePosition;\n  }\n\n  getMouseX(){\n    return this.mousePosition.x;\n  }\n\n  getMouseY(){\n    return this.mousePosition.y;\n  }\n\n  getMouseLastX() {\n    return this.lastMousePosition.x;\n  }\n\n  getMouseLastY() {\n    return this.lastMousePosition.Y;\n  }\n\n  getMouseDeltaX(){\n    return this.mousePosition.x - this.lastMousePosition.x;\n  }\n\n  getMouseDeltaY(){\n    return this.mousePosition.y - this.lastMousePosition.y;\n  }\n\n  getMouseMovX(){\n    return this.mousePosition.movX;\n  }\n\n  getMouseMovY() {\n    return this.mousePosition.movY;\n  }\n\n  isMouseLocked(){\n    return this.mouseLocked;\n  }\n  \n}","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","/**\r\n * @author Alberto Contorno\r\n * @class\r\n */\r\nexport class Component{\r\n    static nextId = 1;\r\n    name;\r\n    parent;\r\n\r\n    constructor(){\r\n        Component.nextId++;\r\n        this.id = Component.nextId;\r\n    }\r\n\r\n    onAfterAdded() {}\r\n\r\n    onAfterRemoved() {}\r\n}\r\n\r\nexport const registeredComponents = {\r\n    'transform': 0,\r\n    'mesh': 1,\r\n    'light': 2,\r\n    'material': 3\r\n}","import {Component} from '../Component';\n\n/**\n * @author Alberto Contorno\n * @class\n */\nexport class Transform extends Component{\n    position = [0, 0, 0];\n    rotation = [0, 0, 0]\n    scale = [1, 1, 1];\n\n    constructor(parent){\n        super();\n        this.parent = parent;\n        this.name = 'transform';\n\n    }\n\n    static summed(t1, t2){\n        if(t1 == null || t2 == null){ return null; }\n        let transform = new Transform();\n\n        transform.position[0] = t1.position[0] + t2.position[0];\n        transform.position[1] = t1.position[1] + t2.position[1];\n        transform.position[2] = t1.position[2] + t2.position[2];\n\n        transform.rotation[0] = t1.rotation[0] + t2.rotation[0];\n        transform.rotation[1] = t1.rotation[1] + t2.rotation[1];\n        transform.rotation[2] = t1.rotation[2] + t2.rotation[2];\n\n        transform.scale[0] = t1.scale[0] * t2.scale[0];\n        transform.scale[1] = t1.scale[1] * t2.scale[1];\n        transform.scale[2] = t1.scale[2] * t2.scale[2];\n\n        return transform;\n    }\n}","function _argumentsToArray( args )\r\n{\r\n    return [].concat.apply( [], Array.prototype.slice.apply(args) );\r\n}\r\n\r\n\r\nfunction radians( degrees ) {\r\n  return degrees * Math.PI / 180.0;\r\n}\r\n\r\nfunction equal( u, v )\r\n{\r\n    if ( u.length != v.length ) { return false; }\r\n\r\n    if ( u.matrix && v.matrix ) {\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i].length != v[i].length ) { return false; }\r\n            for ( var j = 0; j < u[i].length; ++j ) {\r\n                if ( u[i][j] !== v[i][j] ) { return false; }\r\n            }\r\n        }\r\n    }\r\n    else if ( u.matrix && !v.matrix || !u.matrix && v.matrix ) {\r\n        return false;\r\n    }\r\n    else {\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i] !== v[i] ) { return false; }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nexport const vec2 = function vec2(){\r\n  var result = _argumentsToArray( arguments );\r\n\r\n  switch ( result.length ) {\r\n    case 0: result.push( 0.0 );\r\n    case 1: result.push( 0.0 );\r\n  }\r\n\r\n  return result.splice( 0, 2 );\r\n}\r\n\r\nexport const vec3 = function vec3() {\r\n  var result = _argumentsToArray( arguments );\r\n\r\n  switch ( result.length ) {\r\n    case 0: result.push( 0.0 );\r\n    case 1: result.push( 0.0 );\r\n    case 2: result.push( 0.0 );\r\n  }\r\n\r\n  return result.splice( 0, 3 );\r\n}\r\n\r\nexport const vec4 = function vec4() {\r\n  var result = _argumentsToArray( arguments );\r\n\r\n  switch ( result.length ) {\r\n        case 0: result.push( 0.0 );\r\n        case 1: result.push( 0.0 );\r\n        case 2: result.push( 0.0 );\r\n        case 3: result.push( 1.0 );\r\n  }\r\n\r\n  return result.splice( 0, 4 );\r\n}\r\n\r\nexport const scalarProduct = function scalarProduct(v, s){\r\n  v.forEach( (v,i) => v[i] = v * s );\r\n}\r\n\r\n\r\n/////////////////////////////////////////////////////\r\nexport const mat2 = function mat2()\r\n{\r\n    var v = _argumentsToArray( arguments );\r\n\r\n    var m = [];\r\n    switch ( v.length ) {\r\n    case 0:\r\n        v[0] = 1;\r\n    case 1:\r\n        m = [\r\n            vec2( v[0],  0.0 ),\r\n            vec2(  0.0, v[0] )\r\n        ];\r\n        break;\r\n\r\n    default:\r\n        m.push( vec2(v) );  v.splice( 0, 2 );\r\n        m.push( vec2(v) );\r\n        break;\r\n    }\r\n\r\n    m.matrix = true;\r\n\r\n    return m;\r\n}\r\n\r\nexport const mat3 = function mat3()\r\n{\r\n    var v = _argumentsToArray( arguments );\r\n\r\n    var m = [];\r\n    switch ( v.length ) {\r\n    case 0:\r\n        v[0] = 1;\r\n    case 1:\r\n        m = [\r\n            vec3( v[0],  0.0,  0.0 ),\r\n            vec3(  0.0, v[0],  0.0 ),\r\n            vec3(  0.0,  0.0, v[0] )\r\n        ];\r\n        break;\r\n\r\n    default:\r\n        m.push( vec3(v) );  v.splice( 0, 3 );\r\n        m.push( vec3(v) );  v.splice( 0, 3 );\r\n        m.push( vec3(v) );\r\n        break;\r\n    }\r\n\r\n    m.matrix = true;\r\n\r\n    return m;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const mat4 = function mat4()\r\n{\r\n    var v = _argumentsToArray( arguments );\r\n\r\n    var m = [];\r\n    switch ( v.length ) {\r\n    case 0:\r\n        v[0] = 1;\r\n    case 1:\r\n        m = [\r\n            vec4( v[0], 0.0,  0.0,   0.0 ),\r\n            vec4( 0.0,  v[0], 0.0,   0.0 ),\r\n            vec4( 0.0,  0.0,  v[0],  0.0 ),\r\n            vec4( 0.0,  0.0,  0.0,  v[0] )\r\n        ];\r\n        break;\r\n\r\n    default:\r\n        m.push( vec4(v) );  v.splice( 0, 4 );\r\n        m.push( vec4(v) );  v.splice( 0, 4 );\r\n        m.push( vec4(v) );  v.splice( 0, 4 );\r\n        m.push( vec4(v) );\r\n        break;\r\n    }\r\n\r\n    m.matrix = true;\r\n\r\n    return m;\r\n}\r\n\r\nexport const subtract = function subtract( u, v )\r\n{\r\n    var result = [];\r\n\r\n    if ( u.matrix && v.matrix ) {\r\n        if ( u.length != v.length ) {\r\n            throw \"subtract(): trying to subtract matrices\" +\r\n                \" of different dimensions\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i].length != v[i].length ) {\r\n                throw \"subtract(): trying to subtact matrices\" +\r\n                    \" of different dimensions\";\r\n            }\r\n            result.push( [] );\r\n            for ( var j = 0; j < u[i].length; ++j ) {\r\n                result[i].push( u[i][j] - v[i][j] );\r\n            }\r\n        }\r\n\r\n        result.matrix = true;\r\n\r\n        return result;\r\n    }\r\n    else if ( u.matrix && !v.matrix || !u.matrix && v.matrix ) {\r\n        throw \"subtact(): trying to subtact  matrix and non-matrix variables\";\r\n    }\r\n    else {\r\n        if ( u.length != v.length ) {\r\n            throw \"subtract(): vectors are not the same length\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            result.push( u[i] - v[i] );\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const mult = function mult( u, v )\r\n{\r\n    var result = [];\r\n\r\n    if ( u.matrix && v.matrix ) {\r\n        if ( u.length != v.length ) {\r\n            throw \"mult(): trying to add matrices of different dimensions\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i].length != v[i].length ) {\r\n                throw \"mult(): trying to add matrices of different dimensions\";\r\n            }\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            result.push( [] );\r\n\r\n            for ( var j = 0; j < v.length; ++j ) {\r\n                var sum = 0.0;\r\n                for ( var k = 0; k < u.length; ++k ) {\r\n                    sum += u[i][k] * v[k][j];\r\n                }\r\n                result[i].push( sum );\r\n            }\r\n        }\r\n\r\n        result.matrix = true;\r\n\r\n        return result;\r\n    }\r\n\r\n      if(u.matrix&& (u.length == v.length)) {\r\n        for(var i = 0; i<v.length; i++) {\r\n          var sum = 0.0;\r\n          for(var j=0; j<v.length; j++) {\r\n            sum += u[i][j]*v[j];\r\n          }\r\n          result.push(sum);\r\n        }\r\n      return result;\r\n      }\r\n\r\n\r\n\r\n    else {\r\n        if ( u.length != v.length ) {\r\n            throw \"mult(): vectors are not the same dimension\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            result.push( u[i] * v[i] );\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  Basic Transformation Matrix Generators\r\n//\r\n\r\nexport const add = function add( u, v )\r\n{\r\n    var result = [];\r\n\r\n    if ( u.matrix && v.matrix ) {\r\n        if ( u.length != v.length ) {\r\n            throw \"add(): trying to add matrices of different dimensions\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            if ( u[i].length != v[i].length ) {\r\n                throw \"add(): trying to add matrices of different dimensions\";\r\n            }\r\n            result.push( [] );\r\n            for ( var j = 0; j < u[i].length; ++j ) {\r\n                result[i].push( u[i][j] + v[i][j] );\r\n            }\r\n        }\r\n\r\n        result.matrix = true;\r\n\r\n        return result;\r\n    }\r\n    else if ( u.matrix && !v.matrix || !u.matrix && v.matrix ) {\r\n        throw \"add(): trying to add matrix and non-matrix variables\";\r\n    }\r\n    else {\r\n        if ( u.length != v.length ) {\r\n            throw \"add(): vectors are not the same dimension\";\r\n        }\r\n\r\n        for ( var i = 0; i < u.length; ++i ) {\r\n            result.push( u[i] + v[i] );\r\n        }\r\n\r\n        return result;\r\n    }\r\n}\r\n\r\nexport const translate = function translate( x, y, z )\r\n{\r\n    if ( Array.isArray(x) && x.length == 3 ) {\r\n        z = x[2];\r\n        y = x[1];\r\n        x = x[0];\r\n    }\r\n\r\n    var result = mat4();\r\n    result[0][3] = x;\r\n    result[1][3] = y;\r\n    result[2][3] = z;\r\n\r\n    return result;\r\n}\r\n\r\nexport const rotate = function rotate( angle, axis )\r\n{\r\n    if ( !Array.isArray(axis) ) {\r\n        axis = [ arguments[1], arguments[2], arguments[3] ];\r\n    }\r\n\r\n    var v = normalize( axis );\r\n\r\n    var x = v[0];\r\n    var y = v[1];\r\n    var z = v[2];\r\n\r\n    var c = Math.cos( radians(angle) );\r\n    var omc = 1.0 - c;\r\n    var s = Math.sin( radians(angle) );\r\n\r\n    var result = mat4(\r\n        vec4( x*x*omc + c,   x*y*omc - z*s, x*z*omc + y*s, 0.0 ),\r\n        vec4( x*y*omc + z*s, y*y*omc + c,   y*z*omc - x*s, 0.0 ),\r\n        vec4( x*z*omc - y*s, y*z*omc + x*s, z*z*omc + c,   0.0 ),\r\n        vec4()\r\n    );\r\n\r\n    return result;\r\n}\r\n\r\nexport const rotateX = function rotateX(theta) {\r\n  var c = Math.cos( radians(theta) );\r\n  var s = Math.sin( radians(theta) );\r\n  var rx = mat4( 1.0,  0.0,  0.0, 0.0,\r\n      0.0,  c,  -s, 0.0,\r\n      0.0, s,  c, 0.0,\r\n      0.0,  0.0,  0.0, 1.0 );\r\n  return rx;\r\n}\r\nexport const rotateY = function rotateY(theta) {\r\n  var c = Math.cos( radians(theta) );\r\n  var s = Math.sin( radians(theta) );\r\n  var ry = mat4( c, 0.0, s, 0.0,\r\n      0.0, 1.0,  0.0, 0.0,\r\n      -s, 0.0,  c, 0.0,\r\n      0.0, 0.0,  0.0, 1.0 );\r\n  return ry;\r\n}\r\nexport const rotateZ = function rotateZ(theta) {\r\n  var c = Math.cos( radians(theta) );\r\n  var s = Math.sin( radians(theta) );\r\n  var rz = mat4( c, -s, 0.0, 0.0,\r\n      s,  c, 0.0, 0.0,\r\n      0.0,  0.0, 1.0, 0.0,\r\n      0.0,  0.0, 0.0, 1.0 );\r\n  return rz;\r\n}\r\n\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const scalem = function scalem( x, y, z )\r\n{\r\n    if ( Array.isArray(x) && x.length == 3 ) {\r\n        z = x[2];\r\n        y = x[1];\r\n        x = x[0];\r\n    }\r\n\r\n    var result = mat4();\r\n    result[0][0] = x;\r\n    result[1][1] = y;\r\n    result[2][2] = z;\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  ModelView Matrix Generators\r\n//\r\n\r\nexport const lookAt = function lookAt( eye, at, up )\r\n{\r\n    if ( !Array.isArray(eye) || eye.length != 3) {\r\n        throw \"lookAt(): first parameter [eye] must be an a vec3\";\r\n    }\r\n\r\n    if ( !Array.isArray(at) || at.length != 3) {\r\n        throw \"lookAt(): first parameter [at] must be an a vec3\";\r\n    }\r\n\r\n    if ( !Array.isArray(up) || up.length != 3) {\r\n        throw \"lookAt(): first parameter [up] must be an a vec3\";\r\n    }\r\n\r\n    if ( equal(eye, at) ) {\r\n        return mat4();\r\n    }\r\n\r\n    var v = normalize( subtract(at, eye) );  // view direction vector\r\n    var n = normalize( cross(v, up) );       // perpendicular vector\r\n    var u = normalize( cross(n, v) );        // \"new\" up vector\r\n\r\n    v = negate( v );\r\n\r\n    var result = mat4(\r\n        vec4( n, -dot(n, eye) ),\r\n        vec4( u, -dot(u, eye) ),\r\n        vec4( v, -dot(v, eye) ),\r\n        vec4()\r\n    );\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  Projection Matrix Generators\r\n//\r\n\r\nexport const ortho = function ortho( left, right, bottom, top, near, far )\r\n{\r\n    if ( left == right ) { throw \"ortho(): left and right are equal\"; }\r\n    if ( bottom == top ) { throw \"ortho(): bottom and top are equal\"; }\r\n    if ( near == far )   { throw \"ortho(): near and far are equal\"; }\r\n\r\n    var w = right - left;\r\n    var h = top - bottom;\r\n    var d = far - near;\r\n\r\n    var result = mat4();\r\n    result[0][0] = 2.0 / w;\r\n    result[1][1] = 2.0 / h;\r\n    result[2][2] = -2.0 / d;\r\n    result[0][3] = -(left + right) / w;\r\n    result[1][3] = -(top + bottom) / h;\r\n    result[2][3] = -(near + far) / d;\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const perspective = function perspective( fovy, aspect, near, far )\r\n{\r\n    var f = 1.0 / Math.tan( radians(fovy) / 2 );\r\n    var d = far - near;\r\n\r\n    var result = mat4();\r\n    result[0][0] = f / aspect;\r\n    result[1][1] = f;\r\n    result[2][2] = -(near + far) / d;\r\n    result[2][3] = -2 * near * far / d;\r\n    result[3][2] = -1;\r\n    result[3][3] = 0.0;\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  Matrix Functions\r\n//\r\n\r\nexport const transpose = function transpose( m )\r\n{\r\n    if ( !m.matrix ) {\r\n        return \"transpose(): trying to transpose a non-matrix\";\r\n    }\r\n\r\n    var result = [];\r\n    for ( var i = 0; i < m.length; ++i ) {\r\n        result.push( [] );\r\n        for ( var j = 0; j < m[i].length; ++j ) {\r\n            result[i].push( m[j][i] );\r\n        }\r\n    }\r\n\r\n    result.matrix = true;\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//  Vector Functions\r\n//\r\n\r\nexport const dot = function dot( u, v )\r\n{\r\n    if ( u.length != v.length ) {\r\n        throw \"dot(): vectors are not the same dimension\";\r\n    }\r\n\r\n    var sum = 0.0;\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        sum += u[i] * v[i];\r\n    }\r\n\r\n    return sum;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const negate = function negate( u )\r\n{\r\n    var result = [];\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        result.push( -u[i] );\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const cross = function cross( u, v )\r\n{\r\n    if ( !Array.isArray(u) || u.length < 3 ) {\r\n        throw \"cross(): first argument is not a vector of at least 3\";\r\n    }\r\n\r\n    if ( !Array.isArray(v) || v.length < 3 ) {\r\n        throw \"cross(): second argument is not a vector of at least 3\";\r\n    }\r\n\r\n    var result = [\r\n        u[1]*v[2] - u[2]*v[1],\r\n        u[2]*v[0] - u[0]*v[2],\r\n        u[0]*v[1] - u[1]*v[0]\r\n    ];\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const length = function length( u )\r\n{\r\n    return Math.sqrt( dot(u, u) );\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const normalize = function normalize( u, excludeLastComponent )\r\n{\r\n    if ( excludeLastComponent ) {\r\n        var last = u.pop();\r\n    }\r\n\r\n    var len = length( u );\r\n\r\n    if ( !isFinite(len) ) {\r\n        throw \"normalize: vector \" + u + \" has zero length\";\r\n    }\r\n\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        u[i] /= len;\r\n    }\r\n\r\n    if ( excludeLastComponent ) {\r\n        u.push( last );\r\n    }\r\n\r\n    return u;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nexport const mix = function mix( u, v, s )\r\n{\r\n    if ( typeof s !== \"number\" ) {\r\n        throw \"mix: the last paramter \" + s + \" must be a number\";\r\n    }\r\n\r\n    if ( u.length != v.length ) {\r\n        throw \"vector dimension mismatch\";\r\n    }\r\n\r\n    var result = [];\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        result.push( (1.0 - s) * u[i] + s * v[i] );\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n// Vector and Matrix functions\r\n//\r\n\r\nexport const scale = function scale( s, u )\r\n{\r\n    if ( !Array.isArray(u) ) {\r\n        throw \"scale: second parameter \" + u + \" is not a vector\";\r\n    }\r\n\r\n    var result = [];\r\n    for ( var i = 0; i < u.length; ++i ) {\r\n        result.push( s * u[i] );\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n//\r\n//\r\n//\r\n\r\nexport const flatten = function flatten( v )\r\n{\r\n    if ( v.matrix === true ) {\r\n        v = transpose( v );\r\n    }\r\n\r\n    var n = v.length;\r\n    var elemsAreArrays = false;\r\n\r\n    if ( Array.isArray(v[0]) ) {\r\n        elemsAreArrays = true;\r\n        n *= v[0].length;\r\n    }\r\n\r\n    var floats = new Float32Array( n );\r\n\r\n    if ( elemsAreArrays ) {\r\n        var idx = 0;\r\n        for ( var i = 0; i < v.length; ++i ) {\r\n            for ( var j = 0; j < v[i].length; ++j ) {\r\n                floats[idx++] = v[i][j];\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        for ( var i = 0; i < v.length; ++i ) {\r\n            floats[i] = v[i];\r\n        }\r\n    }\r\n\r\n    return floats;\r\n}\r\n\r\n//----------------------------------------------------------------------------\r\n\r\nvar sizeof = {\r\n    'vec2' : new Float32Array( flatten(vec2()) ).byteLength,\r\n    'vec3' : new Float32Array( flatten(vec3()) ).byteLength,\r\n    'vec4' : new Float32Array( flatten(vec4()) ).byteLength,\r\n    'mat2' : new Float32Array( flatten(mat2()) ).byteLength,\r\n    'mat3' : new Float32Array( flatten(mat3()) ).byteLength,\r\n    'mat4' : new Float32Array( flatten(mat4()) ).byteLength\r\n};\r\n\r\n// new functions 5/2/2015\r\n\r\n// printing\r\n\r\nexport const printm = function printm(m)\r\n{\r\n    if(m.length == 2)\r\n    for(var i=0; i<m.length; i++)\r\n       console.log(m[i][0], m[i][1]);\r\n    else if(m.length == 3)\r\n    for(var i=0; i<m.length; i++)\r\n       console.log(m[i][0], m[i][1], m[i][2]);\r\n    else if(m.length == 4)\r\n    for(var i=0; i<m.length; i++)\r\n       console.log(m[i][0], m[i][1], m[i][2], m[i][3]);\r\n}\r\n// determinants\r\n\r\nexport const det2 = function det2(m)\r\n{\r\n\r\n     return m[0][0]*m[1][1]-m[0][1]*m[1][0];\r\n\r\n}\r\n\r\nexport const det3 = function det3(m)\r\n{\r\n     var d = m[0][0]*m[1][1]*m[2][2]\r\n           + m[0][1]*m[1][2]*m[2][0]\r\n           + m[0][2]*m[2][1]*m[1][0]\r\n           - m[2][0]*m[1][1]*m[0][2]\r\n           - m[1][0]*m[0][1]*m[2][2]\r\n           - m[0][0]*m[1][2]*m[2][1]\r\n           ;\r\n     return d;\r\n}\r\n\r\nexport const det4 = function det4(m)\r\n{\r\n     var m0 = [\r\n         vec3(m[1][1], m[1][2], m[1][3]),\r\n         vec3(m[2][1], m[2][2], m[2][3]),\r\n         vec3(m[3][1], m[3][2], m[3][3])\r\n     ];\r\n     var m1 = [\r\n         vec3(m[1][0], m[1][2], m[1][3]),\r\n         vec3(m[2][0], m[2][2], m[2][3]),\r\n         vec3(m[3][0], m[3][2], m[3][3])\r\n     ];\r\n     var m2 = [\r\n         vec3(m[1][0], m[1][1], m[1][3]),\r\n         vec3(m[2][0], m[2][1], m[2][3]),\r\n         vec3(m[3][0], m[3][1], m[3][3])\r\n     ];\r\n     var m3 = [\r\n         vec3(m[1][0], m[1][1], m[1][2]),\r\n         vec3(m[2][0], m[2][1], m[2][2]),\r\n         vec3(m[3][0], m[3][1], m[3][2])\r\n     ];\r\n     return m[0][0]*det3(m0) - m[0][1]*det3(m1)\r\n         + m[0][2]*det3(m2) - m[0][3]*det3(m3);\r\n\r\n}\r\n\r\nexport const det = function det(m)\r\n{\r\n     if(m.matrix != true) console.log(\"not a matrix\");\r\n     if(m.length == 2) return det2(m);\r\n     if(m.length == 3) return det3(m);\r\n     if(m.length == 4) return det4(m);\r\n}\r\n\r\n//---------------------------------------------------------\r\n\r\n// inverses\r\n\r\nexport const inverse2 = function inverse2(m)\r\n{\r\n     var a = mat2();\r\n     var d = det2(m);\r\n     a[0][0] = m[1][1]/d;\r\n     a[0][1] = -m[0][1]/d;\r\n     a[1][0] = -m[1][0]/d;\r\n     a[1][1] = m[0][0]/d;\r\n     a.matrix = true;\r\n     return a;\r\n}\r\n\r\nexport const inverse3 = function inverse3(m)\r\n{\r\n    var a = mat3();\r\n    var d = det3(m);\r\n\r\n    var a00 = [\r\n       vec2(m[1][1], m[1][2]),\r\n       vec2(m[2][1], m[2][2])\r\n    ];\r\n    var a01 = [\r\n       vec2(m[1][0], m[1][2]),\r\n       vec2(m[2][0], m[2][2])\r\n    ];\r\n    var a02 = [\r\n       vec2(m[1][0], m[1][1]),\r\n       vec2(m[2][0], m[2][1])\r\n    ];\r\n    var a10 = [\r\n       vec2(m[0][1], m[0][2]),\r\n       vec2(m[2][1], m[2][2])\r\n    ];\r\n    var a11 = [\r\n       vec2(m[0][0], m[0][2]),\r\n       vec2(m[2][0], m[2][2])\r\n    ];\r\n    var a12 = [\r\n       vec2(m[0][0], m[0][1]),\r\n       vec2(m[2][0], m[2][1])\r\n    ];\r\n    var a20 = [\r\n       vec2(m[0][1], m[0][2]),\r\n       vec2(m[1][1], m[1][2])\r\n    ];\r\n    var a21 = [\r\n       vec2(m[0][0], m[0][2]),\r\n       vec2(m[1][0], m[1][2])\r\n    ];\r\n    var a22 = [\r\n       vec2(m[0][0], m[0][1]),\r\n       vec2(m[1][0], m[1][1])\r\n    ];\r\n\r\n   a[0][0] = det2(a00)/d;\r\n   a[0][1] = -det2(a10)/d;\r\n   a[0][2] = det2(a20)/d;\r\n   a[1][0] = -det2(a01)/d;\r\n   a[1][1] = det2(a11)/d;\r\n   a[1][2] = -det2(a21)/d;\r\n   a[2][0] = det2(a02)/d;\r\n   a[2][1] = -det2(a12)/d;\r\n   a[2][2] = det2(a22)/d;\r\n\r\n   return a;\r\n\r\n}\r\n\r\nexport const inverse4 = function inverse4(m)\r\n{\r\n    var a = mat4();\r\n    var d = det4(m);\r\n\r\n    var a00 = [\r\n       vec3(m[1][1], m[1][2], m[1][3]),\r\n       vec3(m[2][1], m[2][2], m[2][3]),\r\n       vec3(m[3][1], m[3][2], m[3][3])\r\n    ];\r\n    var a01 = [\r\n       vec3(m[1][0], m[1][2], m[1][3]),\r\n       vec3(m[2][0], m[2][2], m[2][3]),\r\n       vec3(m[3][0], m[3][2], m[3][3])\r\n    ];\r\n    var a02 = [\r\n       vec3(m[1][0], m[1][1], m[1][3]),\r\n       vec3(m[2][0], m[2][1], m[2][3]),\r\n       vec3(m[3][0], m[3][1], m[3][3])\r\n    ];\r\n    var a03 = [\r\n       vec3(m[1][0], m[1][1], m[1][2]),\r\n       vec3(m[2][0], m[2][1], m[2][2]),\r\n       vec3(m[3][0], m[3][1], m[3][2])\r\n    ];\r\n    var a10 = [\r\n       vec3(m[0][1], m[0][2], m[0][3]),\r\n       vec3(m[2][1], m[2][2], m[2][3]),\r\n       vec3(m[3][1], m[3][2], m[3][3])\r\n    ];\r\n    var a11 = [\r\n       vec3(m[0][0], m[0][2], m[0][3]),\r\n       vec3(m[2][0], m[2][2], m[2][3]),\r\n       vec3(m[3][0], m[3][2], m[3][3])\r\n    ];\r\n    var a12 = [\r\n       vec3(m[0][0], m[0][1], m[0][3]),\r\n       vec3(m[2][0], m[2][1], m[2][3]),\r\n       vec3(m[3][0], m[3][1], m[3][3])\r\n    ];\r\n    var a13 = [\r\n       vec3(m[0][0], m[0][1], m[0][2]),\r\n       vec3(m[2][0], m[2][1], m[2][2]),\r\n       vec3(m[3][0], m[3][1], m[3][2])\r\n    ];\r\n    var a20 = [\r\n       vec3(m[0][1], m[0][2], m[0][3]),\r\n       vec3(m[1][1], m[1][2], m[1][3]),\r\n       vec3(m[3][1], m[3][2], m[3][3])\r\n    ];\r\n    var a21 = [\r\n       vec3(m[0][0], m[0][2], m[0][3]),\r\n       vec3(m[1][0], m[1][2], m[1][3]),\r\n       vec3(m[3][0], m[3][2], m[3][3])\r\n    ];\r\n    var a22 = [\r\n       vec3(m[0][0], m[0][1], m[0][3]),\r\n       vec3(m[1][0], m[1][1], m[1][3]),\r\n       vec3(m[3][0], m[3][1], m[3][3])\r\n    ];\r\n    var a23 = [\r\n       vec3(m[0][0], m[0][1], m[0][2]),\r\n       vec3(m[1][0], m[1][1], m[1][2]),\r\n       vec3(m[3][0], m[3][1], m[3][2])\r\n    ];\r\n\r\n    var a30 = [\r\n       vec3(m[0][1], m[0][2], m[0][3]),\r\n       vec3(m[1][1], m[1][2], m[1][3]),\r\n       vec3(m[2][1], m[2][2], m[2][3])\r\n    ];\r\n    var a31 = [\r\n       vec3(m[0][0], m[0][2], m[0][3]),\r\n       vec3(m[1][0], m[1][2], m[1][3]),\r\n       vec3(m[2][0], m[2][2], m[2][3])\r\n    ];\r\n    var a32 = [\r\n       vec3(m[0][0], m[0][1], m[0][3]),\r\n       vec3(m[1][0], m[1][1], m[1][3]),\r\n       vec3(m[2][0], m[2][1], m[2][3])\r\n    ];\r\n    var a33 = [\r\n       vec3(m[0][0], m[0][1], m[0][2]),\r\n       vec3(m[1][0], m[1][1], m[1][2]),\r\n       vec3(m[2][0], m[2][1], m[2][2])\r\n    ];\r\n\r\n\r\n\r\n   a[0][0] = det3(a00)/d;\r\n   a[0][1] = -det3(a10)/d;\r\n   a[0][2] = det3(a20)/d;\r\n   a[0][3] = -det3(a30)/d;\r\n   a[1][0] = -det3(a01)/d;\r\n   a[1][1] = det3(a11)/d;\r\n   a[1][2] = -det3(a21)/d;\r\n   a[1][3] = det3(a31)/d;\r\n   a[2][0] = det3(a02)/d;\r\n   a[2][1] = -det3(a12)/d;\r\n   a[2][2] = det3(a22)/d;\r\n   a[2][3] = -det3(a32)/d;\r\n   a[3][0] = -det3(a03)/d;\r\n   a[3][1] = det3(a13)/d;\r\n   a[3][2] = -det3(a23)/d;\r\n   a[3][3] = det3(a33)/d;\r\n\r\n   return a;\r\n}\r\nexport const inverse = function inverse(m)\r\n{\r\n   if(m.matrix != true) console.log(\"not a matrix\");\r\n   if(m.length == 2) return inverse2(m);\r\n   if(m.length == 3) return inverse3(m);\r\n   if(m.length == 4) return inverse4(m);\r\n}\r\n\r\nexport const normalMatrix = function normalMatrix(m, flag)\r\n{\r\n    var a = mat4();\r\n    a = inverse(transpose(m));\r\n    if(flag != true) return a;\r\n    else {\r\n    var b = mat3();\r\n    for(var i=0;i<3;i++) for(var j=0; j<3; j++) b[i][j] = a[i][j];\r\n    return b;\r\n    }\r\n\r\n}\r\n","import { vec3, perspective, ortho, lookAt, scale, add, subtract, normalize, cross } from \"./Utils/Vector_Matrix\";\n\n/**\n * @author Alberto Contorno\n * @class\n * It represents a Camera that can be used in a Scene. \n * It provides methods to move and rotate the camera and \n * default view matrices ('ortho', 'perspective').\n */\nexport class Camera{\n  static nextId = 1;\n\n  position = vec3(0, 0, 0);\n  rotation = vec3(0, 0, 0);\n  \n  up = vec3(0,1,0);\n  right;\n  direction = vec3(0, 0, 0);\n  front = vec3(0, 0, 0);\n  \n  proj;\n  type = 'perspective';\n\n  yaw = 0;\n  pitch = 0;\n\n  zoomLevel = 2;\n  zooms;\n  sensitivity = 1;\n  speed = 1;\n\n  currX; currY; lastX; lastY;\n  \n  moveKeys = {forward: 'w', backward: 's', right: 'd', left: 'a' };\n\n  updateCameraDirection;\n  updateCameraPos;\n  inputs;\n  time;\n  //per ortho left = -1.0; right = 1.0; ytop = 1.0; bottom = -1.0;\n  \n  /**\n   * \n   * @param {vec3} position The initial position of the camera.\n   * @param {vec3} up The up vector of the camera\n   * @param {number} speed The movement speed of the camera used if the camera is moved with the inner methods.\n   * @param {string} type The type of the camera. Must be 'ortho' or 'perspective'.\n   * @param {object} moveKeys TO BE DEFINED\n   * @param {object} projOptions Options object for more configurations (TO BE DEFINED)\n   * @param {number} sensitivity The turn speed used to update the direction of the camera by the inner method.\n   * @param {object} zooms An object containing all the zoom levels in the form {0: fov0, 1: fov1} (only for 'perspective' cameras)\n   */\n  constructor(position, up, speed, type, moveKeys, projOptions, sensitivity, zooms){\n    Camera.nextId++;\n    this.id = Camera.nextId;\n    this.sensitivity = sensitivity;\n    this.speed = speed;\n    this.position = position;\n    this.type = type;\n    this.projOptions = projOptions;\n    this.zooms = zooms;\n    window.addEventListener(\"wheel\", event => {\n      this.zoomLevel += Math.sign(event.deltaY);\n      this.zoomLevel = Math.clamp(this.zoomLevel, 0, this.zooms.maxLevel);\n      this.setZoomLevel(this.zoomLevel);\n    });\n    if(type && type === 'perspective'){\n      this.proj = perspective(this.projOptions.fov, this.projOptions.aspect, this.projOptions.near, this.projOptions.far);\n      this.updateCameraDirection = this._updateCameraDirection;\n      //this.updateCameraPos = this._updateCameraPos;\n    } else if (type && type === 'orthographic'){\n      this.proj = ortho(this.projOptions.left, this.projOptions.right, this.projOptions.bottom, this.projOptions.ytop, this.projOptions.near, this.projOptions.far);\n      this.updateCameraDirection = this._updateCameraDirection;\n    }\n  }\n\n  /**\n   * Return the Projection Matrix of the camera.\n   */\n  getProjectionMatrix(){\n    return this.proj;\n  }\n\n  /**\n   * Return the front vector of the camera;\n   */\n  getFrontVector(){\n    return vec3(\n      this.position[0] + this.direction[0],\n      this.position[1] + this.direction[1],\n      this.position[2] + this.direction[2]\n    );\n  }\n/**\n * Return the View Matrix of the camera.\n */\n  getViewMatrix(){\n    return lookAt(this.getFrontVector(), this.position, this.up);\n  }\n/**\n * It updates the direction of the camera.\n * @param {number} offsetX Offset on X direction to update the yaw of the camera (i.e. how much the camera must turn to the rigth/left)\n * @param {number} offsetY Offset on Y direction to update the pitch of the camera (i.e. how much the camera must turn up/down)\n * @param {number} deltaTime The delta time used to scale the quantities of the movements to make everything indipendent from the frame rate\n */\n  _updateCameraDirection(offsetX, offsetY, deltaTime) {\n    offsetX *= this.sensitivity * deltaTime;\n    offsetY *= this.sensitivity * deltaTime;\n    this.yaw += offsetX;\n    this.pitch += offsetY;\n\n    if (this.pitch > 89.0) { this.pitch = 89.0; }\n    if (this.pitch < -89.0) { this.pitch = -89.0;}\n    this.direction = vec3(\n      Math.cos(Math.radians(this.pitch)) * Math.cos(Math.radians(this.yaw)),\n      Math.sin(Math.radians(this.pitch)),\n      Math.cos(Math.radians(this.pitch)) * Math.sin(Math.radians(this.yaw))\n    );\n  }\n\n  /**\n   * Set a new position for the camera.\n   * @param {vec3} newPos A vector of 3 components (x,y,z) representing the new positon of the camera in the world\n   */\n  _updateCameraPos(newPos){\n    this.position = vec3(newPos[0], newPos[1], 0.0);\n  }\n  /**\n   * Move the camera forward with respect to the current looking direction, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveForward(deltaTime){\n    this.position = subtract(\n      this.position, scale(this.speed * deltaTime, this.direction)\n    );\n  }\n  /**\n   * Move the camera backwards with respect to the current looking direction, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveBackwards(deltaTime){\n    this.position = add(\n      this.position, scale(this.speed * deltaTime, this.direction)\n    );\n  }\n  /**\n   * Move the camera to the left with respect to the current looking direction, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveLeft(deltaTime){\n    this.position = add(\n      this.position, scale(this.speed * deltaTime, normalize(cross(this.direction, this.up)))\n    );\n  }\n  /**\n   * Move the camera to the left with respect to the current looking direction, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveRight(deltaTime){\n    this.position = subtract(\n      this.position, scale(this.speed * deltaTime, normalize(cross(this.direction, this.up)))\n    );\n  }\n  /**\n   * Move the camera up, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveUp(deltaTime){\n    this.position =  add(\n      this.position, scale(this.speed * deltaTime, vec3(0, 1, 0))\n    );\n  }\n  /**\n   * Move the camera down, based on the camera speed,\n   *  @param {number} deltaTime The delta time used to scale the quantity of the movement to make it indipendent from the frame rate\n   */\n  moveDown(deltaTime){\n    this.position = subtract(\n      this.position, scale(this.speed * deltaTime, vec3(0, 1, 0))\n      );\n\n  }\n  /**\n   * Set the configuration of the levels of zooms. Only for perspective cameras.\n   * @param {object} zooms - An object of configuration. It must contains a maxLevel zoom, and a key[int]-value[int] pair for every level of zoom, indicating\n   * as a key the level (an integer starting from 0 and incremented by 1 for every zoom level) and as a value the fov associated.\n   * @example\n   * { maxLevel: 3, 0: 30, 1: 45, 2: 75, 3: 90 },\n   */\n  setZoomLevels(zooms){\n    this.zooms = zooms;\n  }\n  /**\n   * Set the current level of zoom to be used, if applicable on the base of the zooms configuration.\n   * @param {*} level The chosen level of zoom.\n   */\n  setZoomLevel(level){\n    this.zoomLevel = level;\n    if(this.zooms){\n      this.projOptions.fov = this.zooms[this.zoomLevel] || 45;\n    } else {\n      this.projOptions.fov = 45;\n    }\n    this.proj = perspective(this.projOptions.fov, this.projOptions.aspect, this.projOptions.near, this.projOptions.far);\n  }\n  \n}","import { Transform } from './Components/Transform';\nimport { registeredComponents, Component } from './Component';\nimport { Camera } from './Camera';\n\n/**\n * @author Alberto Contorno\n * @class\n */\nexport class SceneObject{\n  static nextId = 1;\n  id;\n  scene;\n  components = {};\n  transform;\n  meshes = []; //model\n  children = [];\n  parent;\n  material;\n  name;\n\n  onStart = () => {};\n\n  onUpdate = () => {};\n\n  onDestroy = () => {};\n\n  constructor(startCallback, name){ \n    this.name =name;\n    SceneObject.nextId++;\n    this.id = SceneObject.nextId;\n    this.onStart = startCallback;\n    this.transform = this.components['transform'] = new Transform(this);\n  }\n  \n  addMesh(mesh){\n    for (let m of this.meshes) {\n      if (m.id === mesh.id) {\n        console.warning('[WARNING - Object](addMesh) - Added mesh is already present.');\n        return;\n      }\n    }\n    this.meshes.push(mesh);\n  }\n\n  addChild(child){\n    this.children.push(child);\n    child.parent = this;\n  }\n\n  getTransformToRender(){\n    let transformToRender;\n    if (this.parent) {\n      transformToRender = Transform.summed(this.transform, this.parent.getTransformToRender())\n    } else {\n      transformToRender = this.transform;\n    }\n\n    return transformToRender;\n  }\n\n  /**\n   * \n   * @param {GL_CONTEXT} gl \n   * @param {Camera} camera \n   * @param {*} lights \n   */\n  render(gl, camera, lights, lightsTypes){\n    //obj passes position, rotation and scaling\n    for(let mesh of this.meshes){\n      let transformToRender = this.getTransformToRender();\n      mesh.render(gl, camera, this, this.type, this.material, lights, lightsTypes, this.name);\n      //mesh.renderDefault(gl, camera, this, this.type, this.material, lights, defaultShader, locs)\n    }\n  }\n\n  /**\n   * \n   * @param {Component} component \n   */\n  addComponent(component){\n    if (!component) {\n      console.warn('[WARNING - SCENE_OBJECT](addComponent) - Trying to add a component but no component provided.');\n      return;\n    }\n    this.components[component.name] = component;\n    component.parent = this;\n    component.onAfterAdded(this, this.scene);\n  }\n\n  /**\n   * \n   * @param {Component} component \n   */\n  removeComponent(component){\n    if(!component){\n      console.warn('[WARNING - SCENE_OBJECT](addComponent) - Trying to add a component but no component provided.');\n      return;\n    }\n    this.components[component.name] = null;\n    component.parent = null;\n    component.onAfterRemoved(this, this.scene);\n  }\n\n}","import { SceneObject } from \"./Object\";\nimport { Camera } from \"./Camera\";\n\n/**\n * @author Alberto Contorno\n * @class\n * Class that represents a Scene. \n * A Scene is a container to render and manage objects.\n * Moreover it has an array of cameras that can be used, of which, one is the main camera used to render.\n */\nexport class Scene{\n  static nextId = 1;\n  id;\n  objects = [];\n  objectsMap = {};\n  cameras = [];\n  mainCamera;\n  lights = [];\n  lightsTypes = {};\n  defaultShaders = {vertex: null, fragment: null, program: null};\n  defaultLocations = {};\n  emptyTextures;\n  engine;\n\n  constructor(){\n    Scene.nextId++;\n    this.id = Scene.nextId;\n  }\n\n  onAfterSceneAdded(engine){\n    this.engine = engine;\n    //this.setupDefaultShaders();\n  }\n\n  /**\n   * \n   * @param {Camera} camera \n   */\n  addCamera(camera){\n    for(let cam of this.cameras){\n      if(cam.id === camera.id){\n        console.warn('[WARNING - SCENE](addCamera) - Added camera is already present.');\n        return;\n      }\n    }\n    this.cameras.push(camera);\n    if(!this.mainCamera){\n      this.mainCamera = camera;\n    }\n  }\n\n  /**\n   * \n   * @param {Camera} camera \n   */\n  setMainCamera(camera){\n    this.mainCamera = camera;\n    let alreadyPresent = false;\n    for (let cam of this.cameras) {\n      if (cam.id === camera.id) {\n        alreadyPresent = true;\n        break;\n      }\n    }\n    if(!alreadyPresent){\n      this.cameras.push(camera);\n    }\n  }\n\n  /**\n   * \n   * @param {SceneObject} obj \n   */\n  addObject(obj){\n    this.objects.push(obj);\n    obj.scene = this;\n    this.objectsMap[obj.id] = this.objects.length - 1;\n  }\n\n  /**\n   * \n   * @param {SceneObject} obj \n   */\n  removeObject(obj){\n    if(typeof obj === 'object'){\n      if (this.objectsMap[this.objectsMap[obj.id]] != null){\n        this.objects[this.objectsMap[obj.id]] = null;\n        this.objectsMap[this.objectsMap[obj.id]] = null;\n      }\n    } else if (typeof obj === 'number'){\n      if (this.objects[obj] != null){\n        this.objects[obj] = null;\n      }\n    }\n  }\n\n  registerLight(type, light){\n    this.lights.push({ parentObj: light.parent, type, light });\n    this.lightsTypes[type] = this.lightsTypes[type] ? this.lightsTypes[type] + 1 : 1;\n    // TODO Recompute shader\n  }\n\n  unregisterLight(type, light){\n    if (!light){\n      console.warn('[WARNING - SCENE](unregisterLight) - Trying to unregister a light but no light is provided.')\n    }\n    let lightIndex = this.lights.findIndex( el => el.id = light.id);\n    if (lightIndex >= 0){\n      this.lights[lightIndex].parentObj = null;\n      this.lights[lightIndex].light = null;\n      this.lightsTypes[type] = this.lightsTypes[type] ? this.lightsTypes[type] - 1 : 0;\n      this.lights.splice(lightIndex, 1);\n      //TODO Recompute shader\n    } else {\n      console.warn('[WARNING - SCENE](unregisterLight) - Trying to unregister a light that is not registered into the scene.');\n    }\n  }\n\n  renderScene(gl){\n    for (let obj of this.objects) {\n      obj.onUpdate(obj);\n      obj.render(gl, this.mainCamera, this.lights, this.lightsTypes);\n    }\n  }\n\n\n}","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","\nimport {ShaderUtils} from './shadersUtils';\n\n/**\n * @author Alberto Contorno\n * @class\n */\nexport class Shader{\n    static nextId = 1;\n\n    type;\n    source;\n    id;\n    errors = [];\n    shader;\n    constructor(gl, type, source){\n      Shader.nextId++;\n      this.id = Shader.nextId;\n      this.type = (type === 'vertex') ? gl.VERTEX_SHADER : gl.FRAGMENT_SHADER;\n      this.shader = ShaderUtils.loadAndCompileShader(this.type, source);\n      this.source = source;\n      let shaderError = ShaderUtils.checkShaderCompilingErrors(this.shader);\n      if (shaderError) { \n        console.log(\"err\",shaderError);\n        this.errors.push(shaderError); \n      }\n    }\n\n    equals(other){\n      return this.id === other.id;\n    }\n\n    destroy(gl){\n\n    }\n    \n}","/**\n * @author Alberto Contorno\n * @class\n */\nimport { ShaderUtils } from './shadersUtils';\n\nexport class ShaderProgram{\n  static nextId = 1;\n  program;\n  errors = [];\n  constructor(gl, shaders){\n    ShaderProgram.nextId++;\n    this.id = ShaderProgram.nextId;\n    this.program = ShaderUtils.createShaderProgramFromShaders(shaders);\n    let shaderError = ShaderUtils.checkShaderProgramLinkingErrors(this.program);\n    if (shaderError) { \n      console.log('err prog',shaderError);\n      this.errors.push(shaderError) \n    }\n  }\n}","import {vec2, vec3, vec4} from \"./Vector_Matrix\";\r\n\r\nexport const LightTypes = {\r\n    DirectionalLight: 'DIRECTIONAL_LIGHT',\r\n    PointLight: 'POINTLIGHT',\r\n    SpotLight: 'SPOTLIGHT'\r\n}\r\n\r\nexport const TextureTypes = {\r\n    DiffuseMap: 'DIFFUSE_MAP',\r\n    SpecularMap: 'SPECULAR_MAP',\r\n    NormalMap: 'NORMAL_MAP',\r\n    LightMap: 'LIGHT_MAP',\r\n    BumpMap: 'BUMP_MAP',\r\n    ShadowMap: 'SHADOW_MAP'\r\n}\r\n\r\nexport const EmptyTexture = {\r\n    level: 0,\r\n    width:1,\r\n    height: 1,\r\n    border: 0,\r\n    srcFormat: 'RGBA',\r\n    internalFormat: 'RGBA',\r\n    srcType: 'UNSIGNED_BYTE',\r\n    pixels: new Uint8Array([255, 255, 255, 255])\r\n}\r\nexport const DefTextCoords = vec2(0,0);\r\n","export const vMainBody_fPos_Calc = '\\tfPos = vec3(model * vPosition);\\n';\r\nexport const vMainBody_fPos_Calc_TBN = '\\tfPos = vec3(model * vPosition) * TBN;\\n';\r\nexport const vColor_In = 'in vec4 vColor;\\n';\r\nexport const vColor_Out = 'out vec4 fColor;\\n';\r\nexport const vColor_Assign = 'fColor = vColor;\\n';\r\n\r\nexport const vTextureCoords_In = 'in vec2 vTextureCoords;\\n';\r\nexport const vTextureCoords_Out = 'out vec2 fTextureCoords;\\n';\r\nexport const vTextureCoords_Assign = '\\tfTextureCoords = vTextureCoords;\\n';\r\n\r\nexport const vTangent_In = 'in vec3 vTangent;\\n';\r\nexport const vTangent_Out = 'out vec3 fTangent;\\n';\r\nexport const vTangent_Assign = '\\tfTangent = normalize(normalMatrix * vTangent);\\n';\r\nexport const vTangentCalc = `\r\n    vec3 T = normalize(normalMatrix * vTangent);\r\n    vec3 N = normalize(fNormal);\r\n    T = normalize(T - dot(T, N) * N);\r\n    vec3 B = cross(N, T);\r\n    mat3 TBN = mat3(T, B, N);\\n`;\r\nexport const vTbn_Out = 'out mat3 fTBN;\\n';\r\nexport const vTbn_Assing = '\\tfTBN = TBN;\\n';\r\n\r\nexport const vertexCompleteShaderObj = () =>({\r\n  version: '#version 300 es\\n',\r\n  position: 'in vec4 vPosition;\\n',\r\n  lightsPosUniform: '',\r\n  lightsPosOut: '',\r\n  colorIn: '',\r\n  textureCoordsIn: '',\r\n  textureCoordsOut: '',\r\n  normalIn: 'in vec3 vNormal;\\n',\r\n  tangentIn: '',\r\n  tangentOut: '',\r\n  modelViewProj: 'uniform mat4 model;\\nuniform mat4 view;\\nuniform mat4 projection;\\n',\r\n  colorOut: '',\r\n  normalOut: 'out vec3 fNormal;\\n',\r\n  tbnOut: '',\r\n  fragPosOut: 'out vec3 fPos;\\n',\r\n  mainStart: 'void main(){\\n',\r\n  mainBodyNormalCalc: '\\tmat3 normalMatrix = mat3(transpose(inverse(model)));\\n\\tfNormal = normalMatrix * vNormal;\\n',\r\n  textureCoordsAssign: '',\r\n  tangentAssign: '',\r\n  tbnCalc: '',\r\n  tbnAssign: '',\r\n  mainBodyFPos: '',\r\n  colorAssign: '',\r\n  mainBodyOutput: '\\n\\tgl_Position = projection * view * model * vPosition;\\n}'\r\n});\r\n\r\n\r\nexport const materialStruct = 'struct Material {\\n' +\r\n'\\tvec3 ambient;\\n' +\r\n'\\tvec3 diffuse;\\n' +\r\n'\\tvec3 specular;\\n' +\r\n'\\tfloat shininess;\\n' +\r\n'};\\n'\r\n\r\nexport const DirectionalLightShader = `struct DirectionalLight {\r\n    vec3 direction;\r\n    vec3 ambient;\r\n    vec3 diffuse;\r\n    vec3 specular;\r\n};\r\n`;\r\n\r\nexport const PointLightShader = `struct PointLight {\r\n    vec3 position;\r\n    vec3 ambient;\r\n    vec3 diffuse;\r\n    vec3 specular;\r\n    float constant;\r\n    float linear;\r\n    float quadratic;\r\n};\r\n`;\r\n\r\nexport const PointLightShader_NoPos = `struct PointLight {\r\n    vec3 ambient;\r\n    vec3 diffuse;\r\n    vec3 specular;\r\n    float constant;\r\n    float linear;\r\n    float quadratic;\r\n};\r\n`;\r\n\r\nexport const SpotLightShader = `\r\nstruct SpotLight {\r\n    vec3 direction;\r\n    vec3 position;\r\n    vec3 ambient;\r\n    vec3 diffuse;\r\n    vec3 specular;\r\n    float constant;\r\n    float linear;\r\n    float quadratic;\r\n    float cutOff;\r\n    float outerCutOff;\r\n};\r\n`;\r\n\r\nexport const SpotLightShader_NoPos = `\r\nstruct SpotLight {\r\n    vec3 direction;\r\n    vec3 ambient;\r\n    vec3 diffuse;\r\n    vec3 specular;\r\n    float constant;\r\n    float linear;\r\n    float quadratic;\r\n    float cutOff;\r\n    float outerCutOff;\r\n};\r\n`;\r\n\r\nexport const DirLightFuncDec = 'vec3 CalcDirLight(DirectionalLight light, vec3 normal, vec3 viewDir);\\n';\r\nexport const PointLightFuncDec = 'vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir);\\n';\r\nexport const SpotLightFuncDec = 'vec3 CalcSpotLight(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir);\\n';\r\n\r\nexport const LightAmbientWithTexture_Diff_Spec = '\\tvec3 ambient = light.ambient * vec3(texture(diffuseTexture, fTextureCoords));\\n'\r\nexport const LightDiffuseWithTexture_Diff_Spec = '\\tvec3 diffuse = light.diffuse * diff * vec3(texture(diffuseTexture, fTextureCoords));\\n'\r\nexport const LightSpecularWithTexture_Diff_Spec = '\\tvec3 specular = light.specular * spec * vec3(texture(specularTexture, fTextureCoords));\\n'\r\n\r\nexport const LightAmbientWithTexture_Diff = '\\tvec3 ambient = light.ambient * vec3(texture(diffuseTexture, fTextureCoords));\\n'\r\nexport const LightDiffuseWithTexture_Diff = '\\tvec3 diffuse = light.diffuse * diff * vec3(texture(diffuseTexture, fTextureCoords));\\n'\r\nexport const LightSpecularWithTexture_Diff = '\\tvec3 specular = light.specular * spec * material.specular;\\n'\r\n\r\nexport const LightAmbientWithTexture_Spec = '\\tvec3 ambient = light.ambient * material.diffuse;\\n'\r\nexport const LightDiffuseWithTexture_Spec = '\\tvec3 diffuse = light.ambient * material.diffuse;\\n'\r\nexport const LightSpecularWithTexture_Spec = '\\tvec3 specular = light.specular * spec * vec3(texture(specularTexture, fTextureCoords));\\n'\r\n\r\nexport const DirLightFuncImplObj = () =>({\r\n  signature: 'vec3 CalcDirLight(DirectionalLight light, vec3 normal, vec3 viewDir){\\n',\r\n  bodyStandandPart: `\\tvec3 lightDir = normalize(-light.direction);\r\n  \\t// diffuse shading\r\n  \\tfloat diff = max(dot(normal, lightDir), 0.0);\r\n  \\t// specular shading\r\n  \\tvec3 reflectDir = reflect(-lightDir, normal);\r\n  \\tfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\r\n  \\t// combine results\\n`,\r\n  bodyAmbient: '\\tvec3 ambient = light.ambient * material.diffuse;\\n',\r\n  bodyDiffuse: '\\tvec3 diffuse = light.diffuse * diff * material.diffuse;\\n',\r\n  bodySpecular: '\\tvec3 specular = light.specular * spec * material.specular;\\n',\r\n  bodyReturn: '\\treturn (ambient + diffuse + specular);\\n}\\n'\r\n});\r\n\r\n\r\nexport const PointLightFuncImplObj = () =>({\r\n  signature: 'vec3 CalcPointLight(PointLight light, vec3 normal, vec3 fragPos, vec3 viewDir){\\n',\r\n  bodyStandandPart: `\\tvec3 lightDir = normalize(light.position - fragPos);\r\n  \\t// diffuse shading\r\n  \\tfloat diff = max(dot(normal, lightDir), 0.0);\r\n  \\t// specular shading\r\n  \\tvec3 reflectDir = reflect(-lightDir, normal);\r\n  \\tfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\r\n  \\t// attenuation\r\n  \\tfloat distance = length(light.position - fragPos);\r\n  \\tfloat attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    \r\n  \\t// combine results\\n`,\r\n  bodyAmbient: '\\tvec3 ambient = light.ambient * material.diffuse;\\n',\r\n  bodyDiffuse: '\\tvec3 diffuse = light.diffuse * diff * material.diffuse;\\n',\r\n  bodySpecular: '\\tvec3 specular = light.specular * spec * material.specular;\\n',\r\n  bodyAttenuation: `\\tambient *= attenuation;\r\n  \\tdiffuse *= attenuation;\r\n  \\tspecular *= attenuation;\\n`,\r\n  bodyReturn: '\\treturn (ambient + diffuse + specular);\\n}\\n'\r\n});\r\n\r\nexport const SpotLightFuncImplObj = () =>({\r\n  signature: 'vec3 CalcSpotLight(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir){\\n',\r\n  bodyStandandPart: `\\tvec3 lightDir = normalize(light.position - fragPos);\r\n  \\t// diffuse shading\r\n  \\tfloat diff = max(dot(normal, lightDir), 0.0);\r\n  \\t// specular shading\r\n  \\tvec3 reflectDir = reflect(-lightDir, normal);\r\n  \\tfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), material.shininess);\r\n  \\t// attenuation\r\n  \\tfloat distance = length(light.position - fragPos);\r\n  \\tfloat attenuation = 1.0 / (light.constant + light.linear * distance + light.quadratic * (distance * distance));    \r\n  \\t// spotlight intensity\r\n  \\tfloat theta = dot(lightDir, normalize(-light.direction)); \r\n  \\tfloat epsilon = light.cutOff - light.outerCutOff;\r\n  \\tfloat intensity = clamp((theta - light.outerCutOff) / epsilon, 0.0, 1.0);\r\n  \\t// combine results\\n`,\r\n  bodyAmbient: '\\tvec3 ambient = light.ambient * material.diffuse;\\n',\r\n  bodyDiffuse: '\\tvec3 diffuse = light.diffuse * diff * material.diffuse;\\n',\r\n  bodySpecular: '\\tvec3 specular = light.specular * spec * material.specular;\\n',\r\n  bodyAttenuation: `\\tambient *= attenuation * intensity;\r\n  \\tdiffuse *= attenuation * intensity;\r\n  \\tspecular *= attenuation * intensity;\\n`,\r\n  bodyReturn: '\\treturn (ambient + diffuse + specular);\\n}\\n'\r\n});\r\n\r\nexport const materialVar = 'uniform Material material;\\n';\r\nexport const fColorIn = 'in vec4 fColor;\\n';\r\n\r\nexport const diffuseMapVar = 'uniform sampler2D diffuseTexture;\\n';\r\nexport const specularMapVar = 'uniform sampler2D specularTexture;\\n';\r\nexport const lightMapVar = 'uniform sampler2D lightTexture;\\n';\r\nexport const bumbMapVar = 'uniform sampler2D bumpTexture;\\n';\r\nexport const shadowMapVar = 'uniform sampler2D shadowTexture;\\n';\r\nexport const normalMapVar = 'uniform sampler2D normalTexture;\\n';\r\n\r\nexport const fTextureCoords = 'in vec2 fTextureCoords;\\n';\r\nexport const fDiffuseCoords = 'in vec2 fDiffuseTextCoords;\\n';\r\n\r\nexport const fOutput_Lights = '\\tfragColor = vec4(lightColor, 1.0);\\n';\r\nexport const fOutput_Lights_Color = '\\tfragColor = vec4(lightColor, 1.0) * fColor;\\n';\r\n\r\nexport const fNormalCalc_noTangents = `\\tvec3 norm = texture(normalTexture, fTextureCoords).rgb;\r\n\\tnorm = normalize(norm * 2.0 - 1.0);\\n`;\r\nexport const fNormalCalc_Tangents = `vec3 norm = texture(normalTexture, fTextureCoords).rgb;\r\nnorm = norm * 2.0 - 1.0;   \r\nnorm = normalize(fTBN * norm);`;\r\nexport const fTBN_In = 'in mat3 fTBN;\\n';\r\n\r\nexport const fTangent_In = 'in vec3 fTangent;\\n';\r\nexport const fTbn_Calc = `\\tvec3 norm = normalize(fNormal) * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\r\n\\tvec3 tangent = normalize(fTangent) * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\r\n\\tvec3 bitangent = normalize(cross(norm, tangent));\r\n\\tmat3 tbn = mat3(tangent, bitangent, norm);\r\n\\tnorm = texture(normalTexture, fTextureCoords).rgb * 2. - 1.;\r\n\\tnorm = normalize(tbn * norm);\\n`;\r\n\r\n\r\nexport var fragmentShaderCompleteObj = ()=>({\r\n  version: '#version 300 es\\n',\r\n  precision: 'precision mediump float;\\n',\r\n  materialStruct: '',\r\n  lightsStructs: '',\r\n  lightsFuncDec: '',\r\n  colorIn: '',\r\n  normalIn: 'in vec3 fNormal;\\n',\r\n  tangentIn: '',\r\n  tbnIn: '',\r\n  fragPosIn: 'in vec3 fPos;\\n',\r\n  texturesCoords: '',\r\n  samplers: '',\r\n  viewPos: 'uniform vec3 viewPos;\\n',\r\n  material: '',\r\n  lightsUniform: '',\r\n  colorOut: 'out vec4 fragColor;\\n',\r\n  mainStart: 'void main(){\\n',\r\n  normalCalc: '',\r\n  lightsCalc: '',\r\n  textureCalc: '',\r\n  fragOutput: '\\tfragColor = vec4(0.0, 0.0, 1.0, 1.0);\\n',\r\n  mainEnd: '}\\n',\r\n  lightsFuncImpl: '',\r\n  textureFuncImpl: ''\r\n});\r\n\r\n","import { vec2, vec3 } from \"./Utils/Vector_Matrix\";\r\n\r\n\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Class that represents a Material of a Mesh, that defines the differents components\r\n * of the Phong Lighting.\r\n */\r\nexport class Material{\r\n    static nextId = 1;\r\n    ambient;\r\n    diffuse; // Can be a Texture - If present ambient is to be ignored\r\n    specular; // Can be a Texture\r\n    shininess;\r\n\r\n    textures; // TODO { diffuseMap: Texture, specularMap: Texture, lightMap: Texture, bumpMap: Texture, shadowMap: Texture}\r\n\r\n    /**\r\n     * Create a new Material to be used by a Mesh.\r\n     * @param {vec3} ambient The ambient color of the object\r\n     * @param {vec3} diffuse The diffuse color of the objcet\r\n     * @param {vec3} diffuse The spcular color of the objcet\r\n     * @param {float} diffuse The shininess level of the objcet (a power of 2 (eg. 32, 64 ...))\r\n     */\r\n    constructor(ambient, diffuse, specular, shininess){\r\n        Material.nextId++;\r\n        this.id = Material.nextId;\r\n        this.ambient = ambient || vec3(0.5, 0.5, 0.5);\r\n        this.diffuse = diffuse || vec3(0.5, 0.5, 0.5);\r\n        this.specular = specular || vec3(0.5, 0.5, 0.5);\r\n        this.shininess = shininess || 64;\r\n    }\r\n}","import { Mesh } from '../common/Mesh';\r\nimport { LightTypes, TextureTypes } from '../common/Utils/constants';\r\nimport * as shaderDefault from './shaderDefaults';\r\nimport { Material } from '../common/Material';\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Class used to create Default Shaders according to Mesh properties.\r\n */\r\nexport class ShaderFactory{\r\n    \r\n\r\n    // ==============================================================================================================================\r\n    /**\r\n     * \r\n     * @param {{\r\n        *  material : { diffuse, specular, specular, shininess, vertexColoring(true, false),\r\n        *      textures: { diffuseMap, specularMap, lightMap, bumpMap, shadowMap}\r\n        *  },\r\n        *  lights : {lights, lightsValues: []},\r\n        * }} props \r\n    */\r\n    static CreateVertexShaderFromProperties(props) {\r\n        let vertexSource = shaderDefault.vertexCompleteShaderObj();\r\n        if(props.material){\r\n            if(props.material.vertexColoring){\r\n                vertexSource.colorIn = shaderDefault.vColor_In;\r\n                vertexSource.colorOut = shaderDefault.vColor_Out;\r\n                vertexSource.colorAssign = shaderDefault.vColor_Assign;\r\n            }\r\n\r\n            const textures = props.material.textures\r\n            if(textures){\r\n                vertexSource.textureCoordsIn = shaderDefault.vTextureCoords_In;\r\n                vertexSource.textureCoordsOut = shaderDefault.vTextureCoords_Out;\r\n                vertexSource.textureCoordsAssign = shaderDefault.vTextureCoords_Assign;\r\n\r\n                if(textures[TextureTypes.NormalMap]){\r\n                    vertexSource.tangentIn = shaderDefault.vTangent_In;\r\n                    vertexSource.tangentOut = shaderDefault.vTangent_Out;\r\n                    vertexSource.tangentAssign = shaderDefault.vTangent_Assign;\r\n                    /* vertexSource.tbnOut = shaderDefault.vTbn_Out;\r\n                    vertexSource.tbnCalc = shaderDefault.vTangentCalc;\r\n                    vertexSource.tbnAssign = shaderDefault.vTbn_Assing; */\r\n                    vertexSource.mainBodyFPos = shaderDefault.vMainBody_fPos_Calc; //TODO CHANGE\r\n                    /* if(props.lights){\r\n                        const tangentVertexLightsVars = this.getLightsPosForTangentSpace(props.lights.lights); \r\n                        vertexSource.lightsPosUniform = tangentVertexLightsVars.inUniforms;\r\n                        vertexSource.lightsPosOut = tangentVertexLightsVars.outPos;\r\n                        vertexSource.tangentCalc += tangentVertexLightsVars.tangentLightsCalc;\r\n                    } */\r\n                } else {\r\n                    vertexSource.mainBodyFPos = shaderDefault.vMainBody_fPos_Calc;\r\n                }\r\n            }\r\n        }\r\n\r\n        vertexSource = Object.values(vertexSource).join('');\r\n        return vertexSource;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {{\r\n        *  material : { diffuse, specular, specular, shininess, vertexColoring(true, false),\r\n        *      textures: { diffuseMap, specularMap, lightMap, bumpMap, shadowMap}\r\n        *  },\r\n        *  lights : {lights, lightsValues: []},\r\n        * }} props\r\n     */\r\n    static CreateFragmentShaderFromProperties(props, n) {\r\n        let fragmentSource = shaderDefault.fragmentShaderCompleteObj();\r\n        let hasLights = false;\r\n\r\n        if(props.material){\r\n            if(props.material.vertexColoring){\r\n                fragmentSource.colorIn = shaderDefault.fColorIn;\r\n            }\r\n\r\n            fragmentSource.materialStruct = shaderDefault.materialStruct;\r\n            fragmentSource.material = shaderDefault.materialVar;\r\n            const textures = props.material.textures;\r\n            if(textures){\r\n                fragmentSource.texturesCoords = shaderDefault.fTextureCoords;\r\n                if(textures[TextureTypes.DiffuseMap]){\r\n                    \r\n                    fragmentSource.samplers += shaderDefault.diffuseMapVar;\r\n                } \r\n                if(textures[TextureTypes.SpecularMap]){\r\n                    fragmentSource.samplers += shaderDefault.specularMapVar;\r\n                } \r\n                if(textures[TextureTypes.LightMap]){\r\n                    fragmentSource.samplers += shaderDefault.lightMapVar;\r\n                } \r\n                if(textures[TextureTypes.BumpMap]){\r\n                    fragmentSource.samplers += shaderDefault.bumbMapVar;\r\n                } \r\n                if(textures[TextureTypes.NormalMap]){\r\n                    fragmentSource.samplers += shaderDefault.normalMapVar;\r\n                    //fragmentSource.tbnIn = shaderDefault.fTBN_In;\r\n                    fragmentSource.tangentIn = shaderDefault.fTangent_In;\r\n                } \r\n                if(textures[TextureTypes.ShadowMap]){\r\n                    fragmentSource.samplers += shaderDefault.shadowMapVar;\r\n                }\r\n                fragmentSource.textureCalc = this.getTexturesCalc(props.material.textures);\r\n            }\r\n        }\r\n\r\n        if(props.lights){\r\n            hasLights = true;\r\n            fragmentSource.lightsStructs = this.getLightsStructsFromLights(props.lights.lightsTypes);\r\n            fragmentSource.lightsFuncDec = this.getLightsFuncDec(props.lights.lightsTypes);\r\n            fragmentSource.lightsUniform = this.getLightsVarsFromLights(props.lights.lights);\r\n            fragmentSource.lightsCalc = this.doLightCalcs(props.lights.lights, props.material.textures);\r\n            fragmentSource.lightsFuncImpl = this.getLightsFuncImpl(props.lights.lightsTypes, props.material.textures);\r\n            fragmentSource.fragOutput = shaderDefault.fOutput_Lights;\r\n            if(props.material.vertexColoring){\r\n                fragmentSource.fragOutput = shaderDefault.fOutput_Lights_Color\r\n            }\r\n        }\r\n\r\n        fragmentSource = Object.values(fragmentSource).join('');\r\n        return fragmentSource;\r\n    }\r\n\r\n\r\n    //===================UTILS===================\r\n    static getLights(sources){\r\n        let lights = '';\r\n        if (sources && sources.lights){\r\n            for (let i = 0; i < sources.lights.length; i++) {\r\n                lights +='uniform Light light'+i+';\\n';\r\n            }\r\n        }\r\n        return lights;\r\n    }\r\n\r\n    static doLightCalcs(lights, textures) {\r\n        \r\n        let lightsCalc  = '';\r\n        if(textures[TextureTypes.NormalMap]){\r\n            lightsCalc =\r\n                '\\tvec3 viewDir = normalize(viewPos - fPos);\\n' /* +\r\n                shaderDefault.fNormalCalc_noTangents; */\r\n                + shaderDefault.fTbn_Calc;\r\n        } else {\r\n            lightsCalc =\r\n                '\\tvec3 viewDir = normalize(viewPos - fPos);\\n' +\r\n                '\\tvec3 norm = normalize(fNormal);\\n'\r\n        }\r\n\r\n        for(let i=0; i<lights.length; i++){\r\n            if( i == 0){\r\n                lightsCalc += '\\tvec3 lightColor = '; \r\n            } else {\r\n                lightsCalc += '\\tlightColor += ';\r\n            }\r\n            if (lights[i].type == LightTypes.DirectionalLight){\r\n                lightsCalc += 'CalcDirLight(light' + i + ', norm, viewDir);\\n';\r\n            }\r\n            if (lights[i].type == LightTypes.PointLight){\r\n                lightsCalc += 'CalcPointLight(light' + i + ', norm, fPos, viewDir);\\n';\r\n            }\r\n            if (lights[i].type == LightTypes.SpotLight){\r\n                lightsCalc += 'CalcSpotLight(light' + i + ', norm, fPos, viewDir);\\n';\r\n            }\r\n        }\r\n\r\n        return lightsCalc;\r\n    }\r\n\r\n    static getLightsStructsFromLights(lightsTypes) {\r\n        let r = '';\r\n\r\n        if (lightsTypes[LightTypes.DirectionalLight]) r += shaderDefault.DirectionalLightShader;\r\n        if (lightsTypes[LightTypes.PointLight]) r += shaderDefault.PointLightShader;\r\n        if (lightsTypes[LightTypes.SpotLight]) r += shaderDefault.SpotLightShader;\r\n        \r\n        return r;\r\n    }\r\n\r\n    static getLightsFuncDec(lightsTypes){\r\n        let r = '';\r\n\r\n        if (lightsTypes[LightTypes.DirectionalLight]) r += shaderDefault.DirLightFuncDec;\r\n        if (lightsTypes[LightTypes.PointLight]) r += shaderDefault.PointLightFuncDec;\r\n        if (lightsTypes[LightTypes.SpotLight]) r += shaderDefault.SpotLightFuncDec;\r\n\r\n        return r;\r\n    }\r\n\r\n    static getLightsFuncImpl(lightsTypes, textures){\r\n        let r = '';\r\n\r\n        if (lightsTypes[LightTypes.DirectionalLight]){\r\n            const lightSource = shaderDefault.DirLightFuncImplObj();\r\n            if(textures){ this.setLightSourceTextures(lightSource, textures); }\r\n            r += Object.values(lightSource).join('');\r\n        }\r\n        if(lightsTypes[LightTypes.PointLight]){\r\n            const lightSource = shaderDefault.PointLightFuncImplObj();\r\n            if(textures){ this.setLightSourceTextures(lightSource, textures); }\r\n            r += Object.values(lightSource).join('');\r\n        }\r\n        if (lightsTypes[LightTypes.SpotLight]){\r\n            const lightSource = shaderDefault.SpotLightFuncImplObj();\r\n            if(textures){ this.setLightSourceTextures(lightSource, textures); }\r\n            r += Object.values(lightSource).join('');\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static setLightSourceTextures(lightSource, textures){\r\n        if(textures[TextureTypes.DiffuseMap] && textures[TextureTypes.SpecularMap]){\r\n            lightSource.bodyAmbient = shaderDefault.LightAmbientWithTexture_Diff_Spec;\r\n            lightSource.bodyDiffuse = shaderDefault.LightDiffuseWithTexture_Diff_Spec;\r\n            lightSource.bodySpecular = shaderDefault.LightSpecularWithTexture_Diff_Spec;\r\n        } else if(textures[TextureTypes.DiffuseMap] && !textures[TextureTypes.SpecularMap]){\r\n            lightSource.bodyAmbient = shaderDefault.LightAmbientWithTexture_Diff;\r\n            lightSource.bodyDiffuse = shaderDefault.LightDiffuseWithTexture_Diff;\r\n            lightSource.bodySpecular = shaderDefault.LightSpecularWithTexture_Diff;\r\n        } else if(!textures[TextureTypes.DiffuseMap] && textures[TextureTypes.SpecularMap]){\r\n            lightSource.bodyAmbient = shaderDefault.LightAmbientWithTexture_Spec;\r\n            lightSource.bodyDiffuse = shaderDefault.LightDiffuseWithTexture_Spec;\r\n            lightSource.bodySpecular = shaderDefault.LightSpecularWithTexture_Spec;\r\n        }\r\n    }\r\n\r\n    static getLightsVarsFromLights (lights){\r\n        let r = '';\r\n\r\n        for(let i=0; i<lights.length; i++){\r\n            if (lights[i].type === LightTypes.DirectionalLight) r += 'uniform DirectionalLight light' + i + ';\\n';\r\n            if (lights[i].type === LightTypes.PointLight) r += 'uniform PointLight light' + i + ';\\n';\r\n            if (lights[i].type === LightTypes.SpotLight) r += 'uniform SpotLight light' + i + ';\\n';\r\n        }\r\n\r\n        return r;\r\n    }\r\n\r\n    static getLightsPosForTangentSpace(lights){\r\n        let inUniforms = '';\r\n        let outPos = '';\r\n\r\n        for(let i=0; i<lights.length; i++){\r\n            let lightType = lights[i].type\r\n            if (lightType === LightTypes.PointLight || lightType === LightTypes.SpotLight) {\r\n                inUniforms += 'uniform vec3 vLightPos' + i + ';\\n';\r\n                outPos += 'out vec3 fLightPos' + i + ';\\n';\r\n            };\r\n        }\r\n\r\n        return {inUniforms, outPos, tangentLightsCalc};\r\n    }\r\n\r\n    //FOR FUTURE\r\n    static getTexturesCalc(textures){\r\n        let r = '';\r\n        return r;\r\n    }\r\n\r\n}\r\n","import {Shader} from './Shader';\nimport {ShaderProgram} from './ShaderProgram';\nimport {ShaderFactory} from '../shaders/ShaderFactory';\nimport { vec3, flatten, mat4, translate, rotate, rotateX, rotateY, rotateZ, scalem, mult } from './Utils/Vector_Matrix';\nimport { Material } from './Material';\nimport { LightTypes, TextureTypes } from \"./Utils/constants\";\n/**\n * @author Alberto Contorno\n * @class\n */\nexport class Mesh{\n  static nextId = 1;\n  vertices;\n  indices;\n  shaders = {vertex: null, fragment: null, program: null, set: false}\n  id;\n  VAO;\n  VBO;\n  EBO;\n  NBO;\n  TBO;\n  type;\n  locations = {};\n  textures = {}; // {diffuseMap, specularMap, normalMap, BumbpMap, shadowMap}\n  normals;\n  material;\n  textCoords;\n  shaderUpdated = false;\n  /*\n    opt : keepData, autoUpdateShaders, shadersShouldUpdate\n  */\n  /**\n   * \n   * @param {*} gl \n   * @param {*} vertices \n   * @param {*} indices \n   * @param {{ vertex: string, fragment: string }} shaders\n   * @param {*} opt \n   * @param {*} textures // props.material.textures = {  DIFFUSE_MAP: 1, SPECULAR_MAP: 1, NORMAL_MAP: 1, LIGHT_MAP: 1, BUMP_MAP: 1, SHADOW_MAP: 1 };\n   * @param {*} textCoords \n   */\n  constructor(gl, vertices, indices, shaders, opt, textures, textCoords, normals, tangents, colors){\n    Mesh.nextId++;\n    this.gl = gl;\n    this.id = Mesh.nextId;\n    this.vertices = vertices;\n    this.colors = colors;\n    this.indices = indices;\n    this.opt = opt || { keepData: true };\n    this.type = this.opt.type || gl.TRIANGLES;\n    this.textures = Object.assign({ DIFFUSE_MAP: null, SPECULAR_MAP: null, NORMAL_MAP: null, LIGHT_MAP: null, BUMP_MAP: null, SHADOW_MAP: null}, textures);;\n    this.textCoords = textCoords;\n    this.normals = normals;\n    this.tangents = tangents;\n\n    this.shaders = {};\n    //Create shader if passed else do it automatically from info\n    // TODO create shader from object properties, update when properties change (eg. a component in the object is removed)\n    console.log('MESH CREATED_'+this.id, this);\n  }\n\n  createAndLoadBuffers(gl){\n    this.VAO = gl.createVertexArray();\n    gl.bindVertexArray(this.VAO);\n\n    this.VBO = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.VBO);\n    gl.bufferData(gl.ARRAY_BUFFER, flatten(this.vertices), gl.STATIC_DRAW);\n\n    let positionLoc = gl.getAttribLocation(this.shaders.program.program, 'vPosition');\n    gl.vertexAttribPointer(positionLoc, 4, gl.FLOAT, false, 0, 0);\n    gl.enableVertexAttribArray(positionLoc);\n\n    if (this.normals) {\n      this.NBO = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.NBO);\n      gl.bufferData(gl.ARRAY_BUFFER, flatten(this.normals), gl.STATIC_DRAW);\n      let normalLoc = gl.getAttribLocation(this.shaders.program.program, 'vNormal');\n      gl.vertexAttribPointer(normalLoc, 3, gl.FLOAT, false, 0, 0);\n      gl.enableVertexAttribArray(normalLoc);\n    }\n\n    if (this.tangents) {\n      this.TBO = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.TBO);\n      gl.bufferData(gl.ARRAY_BUFFER, flatten(this.tangents), gl.STATIC_DRAW);\n      let tangentLoc = gl.getAttribLocation(this.shaders.program.program, 'vTangent');\n      console.log('tangentLoc', tangentLoc, this.shaders.fragment.source);\n      gl.vertexAttribPointer(tangentLoc, 3, gl.FLOAT, false, 0, 0);\n      gl.enableVertexAttribArray(tangentLoc);\n    }\n\n    this.locations.textures = {};\n    if(this.textures.DIFFUSE_MAP){\n      if (this.textCoords){\n        this.textCoordBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.textCoordBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, flatten(this.textCoords), gl.STATIC_DRAW);\n        let textCoordLoc = gl.getAttribLocation(this.shaders.program.program, 'vTextureCoords');\n        gl.vertexAttribPointer(textCoordLoc, 2, gl.FLOAT, false, 0, 0);\n        gl.enableVertexAttribArray(textCoordLoc);\n      }\n    }\n\n    if (this.indices) {\n      this.EBO = gl.createBuffer();\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.EBO);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(this.indices), gl.STATIC_DRAW);\n    }\n\n    if(this.colors){\n      this.CBO = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.CBO);\n      gl.bufferData(gl.ARRAY_BUFFER, flatten(this.colors), gl.STATIC_DRAW);\n      let colorsLoc = gl.getAttribLocation(this.shaders.program.program, 'vColor');\n      gl.vertexAttribPointer(colorsLoc, 4, gl.FLOAT, false, 0, 0);\n      gl.enableVertexAttribArray(colorsLoc);\n    }\n    \n    /* let textCoordLoc = gl.getAttribLocation(this.shaders.program.program, 'vTextCoord');\n    gl.vertexAttribPointer(textCoordLoc, 3, gl.FLOAT, false, 32, 12);\n    gl.enableVertexAttribArray(textCoordLoc); */\n\n    //questa parte la fara l'engine\n    this.locations.modelLoc = gl.getUniformLocation(this.shaders.program.program, 'model');\n    this.locations.viewLoc = gl.getUniformLocation(this.shaders.program.program, 'view');\n    this.locations.projLoc = gl.getUniformLocation(this.shaders.program.program, 'projection');\n\n    this.unbindVAO(gl);\n    //TODO\n    //in teoria this.vertices, e this.indices non serve pi e possiamo tenerci solo la this.indices.lenght\n    //se servono usiamo un flag per decidere di tenerli\n    if(this.opt && !this.opt.keepData){\n      this.vertices = null;\n      this.indices = null;\n      this.textCoords = null;\n    }\n\n  }\n\n  unbindVAO(gl){\n    gl.bindVertexArray(null);\n  }\n\n  getModelMatrix(object){\n    let transform = object.transform;\n    \n    let position = transform.position || [0, 0, 0];\n    let rotation = transform.rotation || [0, 0, 0];\n    let scale = transform.scale || [1, 1, 1];\n\n    let modelMatrix = mat4();\n    // da costruire a partire dalla posizione dell'oggetto\n    let traslationMatrix = translate(position[0], position[1], position[2]);\n    //da costruire a partire dalla rotazione dell'oggetto\n    let rotationMatrixX = rotateX(rotation[0]);\n    let rotationMatrixY = rotateY(rotation[1]);\n    let rotationMatrixZ = rotateZ(rotation[2]);\n\n    let scaleMatrix = scalem(scale[0], scale[1], scale[2]);\n\n    //translate * rotate * scale\n    modelMatrix = mult(traslationMatrix, rotationMatrixX);\n    modelMatrix = mult(modelMatrix, rotationMatrixY);\n    modelMatrix = mult(modelMatrix, rotationMatrixZ);\n    modelMatrix = mult(modelMatrix, scaleMatrix);\n\n    if (object.parent) {\n      modelMatrix = mult(this.getModelMatrix(object.parent), modelMatrix);\n    }\n\n    return modelMatrix;\n  }\n\n  getDirectionalLightLocations(gl, lightName){\n    let lightLocs = {type: LightTypes.DirectionalLight};\n    lightLocs.ambient = gl.getUniformLocation(this.shaders.program.program, lightName+'.ambient');\n    lightLocs.diffuse = gl.getUniformLocation(this.shaders.program.program, lightName +'.diffuse');\n    lightLocs.specular = gl.getUniformLocation(this.shaders.program.program, lightName +'.specular');\n    lightLocs.direction = gl.getUniformLocation(this.shaders.program.program, lightName +'.direction');\n    return lightLocs;\n  }\n\n  getPointLightLocations(gl, lightName){\n    let lightLocs = { type: LightTypes.PointLight };\n    lightLocs.position = gl.getUniformLocation(this.shaders.program.program, lightName + '.position');\n    lightLocs.ambient = gl.getUniformLocation(this.shaders.program.program, lightName + '.ambient');\n    lightLocs.diffuse = gl.getUniformLocation(this.shaders.program.program, lightName + '.diffuse');\n    lightLocs.specular = gl.getUniformLocation(this.shaders.program.program, lightName + '.specular');\n    lightLocs.constant = gl.getUniformLocation(this.shaders.program.program, lightName + '.constant');\n    lightLocs.linear = gl.getUniformLocation(this.shaders.program.program, lightName + '.linear');\n    lightLocs.quadratic = gl.getUniformLocation(this.shaders.program.program, lightName + '.quadratic');\n    return lightLocs;\n  }\n\n  getSpotLightLocations(lightName){\n    const gl = this.gl;\n    let lightLocs = { type: LightTypes.SpotLight };\n    lightLocs.position = gl.getUniformLocation(this.shaders.program.program, lightName + '.position');\n    lightLocs.ambient = gl.getUniformLocation(this.shaders.program.program, lightName + '.ambient');\n    lightLocs.diffuse = gl.getUniformLocation(this.shaders.program.program, lightName + '.diffuse');\n    lightLocs.specular = gl.getUniformLocation(this.shaders.program.program, lightName + '.specular');\n    lightLocs.constant = gl.getUniformLocation(this.shaders.program.program, lightName + '.constant');\n    lightLocs.linear = gl.getUniformLocation(this.shaders.program.program, lightName + '.linear');\n    lightLocs.quadratic = gl.getUniformLocation(this.shaders.program.program, lightName + '.quadratic');\n    lightLocs.cutOff = gl.getUniformLocation(this.shaders.program.program, lightName + '.cutOff');\n    lightLocs.outerCutOff = gl.getUniformLocation(this.shaders.program.program, lightName + '.outerCutOff');\n    lightLocs.direction = gl.getUniformLocation(this.shaders.program.program, lightName + '.direction');\n    return lightLocs;\n  }\n\n  getLocations(lights){\n    const gl = this.gl;\n    //vertex\n    this.locations.modelLoc = gl.getUniformLocation(this.shaders.program.program, 'model');\n    this.locations.viewLoc = gl.getUniformLocation(this.shaders.program.program, 'view');\n    this.locations.projLoc = gl.getUniformLocation(this.shaders.program.program, 'projection');\n    //fragment\n    this.locations.viewPosLoc = gl.getUniformLocation(this.shaders.program.program, 'viewPos');\n    this.locations.materialLocs = {};\n    this.locations.materialLocs.ambient = gl.getUniformLocation(this.shaders.program.program, 'material.ambient');\n    this.locations.materialLocs.diffuse = gl.getUniformLocation(this.shaders.program.program, 'material.diffuse');\n    this.locations.materialLocs.specular = gl.getUniformLocation(this.shaders.program.program, 'material.specular');\n    this.locations.materialLocs.shininess = gl.getUniformLocation(this.shaders.program.program, 'material.shininess');\n\n    if(lights && lights.length > 0){\n      this.locations.lights = [];\n      for (let i = 0; i < lights.length; i++) {\n        if (lights[i].type == LightTypes.DirectionalLight) {\n          this.locations.lights.push(this.getDirectionalLightLocations(gl, 'light' + i));\n        } else if (lights[i].type == LightTypes.PointLight) {\n          this.locations.lights.push(this.getPointLightLocations(gl, 'light' + i));\n        } else if (lights[i].type == LightTypes.SpotLight) {\n          this.locations.lights.push(this.getSpotLightLocations(gl, 'light' + i));\n        }\n      }\n    }\n\n    this.locations.texturesLocs = {};\n    Object.entries(this.textures).forEach(([k, texture]) => {\n      if (texture){\n        if(k === TextureTypes.DiffuseMap){\n          this.locations.texturesLocs[TextureTypes.DiffuseMap] = gl.getUniformLocation(this.shaders.program.program, 'diffuseTexture');\n        } else if(k === TextureTypes.SpecularMap){\n          this.locations.texturesLocs[TextureTypes.SpecularMap] = gl.getUniformLocation(this.shaders.program.program, 'specularTexture');\n        } else if(k === TextureTypes.NormalMap){\n          this.locations.texturesLocs[TextureTypes.NormalMap] = gl.getUniformLocation(this.shaders.program.program, 'normalTexture');\n        } else if(k === TextureTypes.ShadowMap){\n          this.locations.texturesLocs[TextureTypes.ShadowMap] = gl.getUniformLocation(this.shaders.program.program, 'shadowTexture');\n        } \n      }\n    });\n\n  }\n\n  updateShadersAndProgram(material, lights, lightsTypes, name){\n    this.shaderUpdated = true;\n      const props = { id: name,\n        material: {\n          ...material,\n          textures:  this.textures,\n          vertexColoring: !!this.colors\n        },\n        lights: {\n          lights: lights,\n          lightsTypes: lightsTypes\n        }\n      }\n      \n      let v = ShaderFactory.CreateVertexShaderFromProperties(props);\n      let f = ShaderFactory.CreateFragmentShaderFromProperties(props, name);\n      this.shaders.vertex = new Shader(this.gl, 'vertex', v);;\n      this.shaders.fragment = new Shader(this.gl, 'fragment', f);\n\n      let shaders = [];\n      for(let key in this.shaders){\n        if (key != 'program' && key != 'set'){\n          shaders.push(this.shaders[key].shader);\n        }\n      }\n\n      this.shaders.program = new ShaderProgram(this.gl, shaders);\n      if (this.opt && !this.opt.keepData) {\n        this.shaders.vertex= null;\n        this.shaders.fragment = null;\n      }\n\n      this.getLocations(lights);\n      this.createAndLoadBuffers(this.gl);\n  }\n\n  render(gl, camera, transform = {}, type, material, lights, lightsTypes, n) {\n    //Update shader\n    if(!this.shaderUpdated) this.updateShadersAndProgram(material, lights, lightsTypes, n);\n    \n    gl.useProgram(this.shaders.program.program); \n    gl.bindVertexArray(this.VAO);\n\n    let modelMatrix = this.getModelMatrix(transform);\n    let projMatrix = camera.getProjectionMatrix();\n    let viewMatrix = camera.getViewMatrix();\n\n    if (this.locations.modelLoc) {\n      gl.uniformMatrix4fv(this.locations.modelLoc, false, flatten(modelMatrix));\n    }\n    if (this.locations.viewLoc) {\n      gl.uniformMatrix4fv(this.locations.viewLoc, false, flatten(viewMatrix));\n    }\n    if (this.locations.projLoc) {\n      gl.uniformMatrix4fv(this.locations.projLoc, false, flatten(projMatrix));\n    }\n    if (this.locations.viewPosLoc) {\n      gl.uniform3fv(this.locations.viewPosLoc, camera.getFrontVector());\n    }\n\n    if (this.locations.materialLocs){\n      if (!material){ material = new Material(); }\n      gl.uniform3fv(this.locations.materialLocs.ambient, flatten(material.ambient));\n      gl.uniform3fv(this.locations.materialLocs.diffuse, material.diffuse);\n      gl.uniform3fv(this.locations.materialLocs.specular, material.specular);\n      gl.uniform1f(this.locations.materialLocs.shininess, material.shininess);\n    }\n\n    if (this.locations.lights){\n      for (let i = 0; i < this.locations.lights.length; i++){\n        if (this.locations.lights[i].type === LightTypes.DirectionalLight) {\n          this.setupDirectionalLight(gl, this.locations.lights[i], lights[i]);\n        } else if (this.locations.lights[i].type === LightTypes.PointLight) {\n          this.setupPointLight(gl, this.locations.lights[i], lights[i]);\n        } else if (this.locations.lights[i].type === LightTypes.SpotLight) {\n          this.setupSpotLight(gl, this.locations.lights[i], lights[i]);\n        }\n      }\n    }\n    \n    Object.entries(this.locations.texturesLocs).forEach(([k, loc]) => {\n      gl.uniform1i(loc, this.textures[k].textureUnit);\n    });\n\n    Object.values(this.textures).forEach(texture => {\n      if (texture) texture.ActiveTexture(gl);\n    });\n\n    if (this.indices) {//draw elements\n      gl.drawElements(type || gl.TRIANGLES, this.indices.length, gl.UNSIGNED_SHORT, 0);\n    } else { //draw arrays\n      gl.drawArrays(type || gl.TRIANGLES, 0, this.vertices.length);\n    }\n\n    Object.values(this.textures).forEach(texture => {\n      if (texture) texture.DisactiveTexture(gl);\n    });\n    \n    gl.bindVertexArray(null);\n    gl.useProgram(null);\n  }\n\n  destroyShader(shader, gl){\n    gl.deleteShader(shader);\n  }\n\n  destroyShaders(gl){\n\n  }\n\n  destroyProgram(program, gl){\n\n  }\n\n  destroy(gl){\n    this.destroyProgram(gl);\n    this.destroyShaders(gl);\n  }\n\n  setupDirectionalLight(gl, lightLocs, light){\n    gl.uniform3fv(lightLocs.ambient, light.light.ambient);\n    gl.uniform3fv(lightLocs.diffuse, light.light.diffuse);\n    gl.uniform3fv(lightLocs.specular, light.light.specular);\n    gl.uniform3fv(lightLocs.direction, light.light.direction);\n  }\n\n  setupPointLight(gl, lightLocs, light) {\n    /* gl.uniform3fv(lightLocs.position, light.light.position);\n    gl.uniform3fv(lightLocs.ambient, light.light.ambient);\n    gl.uniform3fv(lightLocs.diffuse, light.light.diffuse);\n    gl.uniform3fv(lightLocs.specular, light.light.specular);\n    gl.uniform1f(lightLocs.constant, light.light.constant);\n    gl.uniform1f(lightLocs.linear, light.light.linear);\n    gl.uniform1f(lightLocs.quadratic, light.light.quadratic); */\n    Object.keys(lightLocs).forEach( k => {\n      switch (k) {\n        case 'position':\n          gl.uniform3fv(lightLocs.position, light.light.position);\n          break;\n        case 'ambient':\n          gl.uniform3fv(lightLocs.ambient, light.light.ambient);\n          break;\n        case 'diffuse':\n          gl.uniform3fv(lightLocs.diffuse, light.light.diffuse);\n          break;\n        case 'specular':\n          gl.uniform3fv(lightLocs.specular, light.light.specular);\n          break;\n        case 'constant':\n          gl.uniform1f(lightLocs.constant, light.light.constant);\n          break;\n        case 'linear':\n          gl.uniform1f(lightLocs.linear, light.light.linear);\n          break;\n        case 'quadratic':\n          gl.uniform1f(lightLocs.quadratic, light.light.quadratic);\n          break;\n      \n        default:\n          break;\n      }\n    });\n  }\n\n  setupSpotLight(gl, lightLocs, light) {\n    gl.uniform3fv(lightLocs.position, light.light.position);\n    gl.uniform3fv(lightLocs.ambient, light.light.ambient);\n    gl.uniform3fv(lightLocs.diffuse, light.light.diffuse);\n    gl.uniform3fv(lightLocs.specular, light.light.specular);\n    gl.uniform1f(lightLocs.constant, light.light.constant);\n    gl.uniform1f(lightLocs.linear, light.light.linear);\n    gl.uniform1f(lightLocs.quadratic, light.light.quadratic);\n    gl.uniform1f(lightLocs.cutOff, light.light.cutOff);\n    gl.uniform1f(lightLocs.outerCutOff, light.light.outerCutOff);\n    gl.uniform3fv(lightLocs.direction, light.light.direction);\n  }\n}","import {TextureTypes} from './Utils/constants'\r\n\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Class that represents a single Texture of a Mesh.\r\n */\r\nexport class Texture{\r\n    static nextId = 1;\r\n\r\n    id;\r\n    textureUnit = 0;\r\n    imagePath;\r\n    textureSource;\r\n    texture;\r\n    s_texelType;\r\n    texelType;\r\n    params;\r\n    /**\r\n    *\r\n    * @param {number} textureUnit The texture unit associated to the Texture\r\n    * @param {GL_ENUM} gl_type The texture type (e.g. TEXTURE_2D)\r\n    * @param {vec3} up The up vector of the camera\r\n    * @param {GL_ENUM} s_texelType The texel's type of the source data of the texture.\r\n    * @param {GL_ENUM} texelType The texel's type of the data of the texture stored into the GPU.\r\n    * @param {Array} params Array of params objects {key[GL_ENUM]:value} where the key is a GL_ENUM that specifies the texture parameter and the value is the value to apply.\r\n    * @param {TextureTypes} type The type of the texture: one of the values of the constant TextureTypes (eg. NormalMap).\r\n    */\r\n    constructor(textureUnit, gl_type, imagePath, s_texelType, texelType, params, type){\r\n        Texture.nextId++;\r\n        this.id = Texture.nextId;\r\n        this.textureUnit = textureUnit || 0;\r\n        this.gl_type = type;\r\n        this.imagePath = imagePath;\r\n        this.s_texelType = s_texelType;\r\n        this.texelType = texelType;\r\n        this.params = params;\r\n        this.type = type;\r\n    }\r\n\r\n    CreateTextureFromArray(gl){\r\n        this.texture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, this.texelType, 1, 1,\r\n            0, this.s_texelType, gl.UNSIGNED_BYTE, new Uint8Array([255, 255, 255, 255]));\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n    \r\n    LoadTexture(gl){\r\n        this.textureSource = new Image();\r\n        this.textureSource.crossOrigin = \"\";\r\n        this.textureSource.src = this.imagePath;\r\n        this.texture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n        //set texture params\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, this.texelType, 1, 1,\r\n            0, this.s_texelType, gl.UNSIGNED_BYTE, new Uint8Array([0, 0, 255, 255]));\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n        let _loaded = () => {\r\n            gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n            console.log(\"TEXTURE LOADED\", this.id);\r\n            gl.texImage2D(gl.TEXTURE_2D, 0, this.texelType, this.textureSource.width, this.textureSource.height,\r\n                0, this.s_texelType, gl.UNSIGNED_BYTE, this.textureSource);\r\n            gl.generateMipmap(gl.TEXTURE_2D);\r\n            this.textureSource.removeEventListener('load', _loaded);\r\n            this.textureSource = null;\r\n            gl.bindTexture(gl.TEXTURE_2D, null);\r\n        }\r\n        this.textureSource.addEventListener('load', _loaded);  \r\n    }\r\n\r\n    UseTexture(gl, textureUnit){\r\n        gl.activeTexture(gl.TEXTURE0 + textureUnit);\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n    }\r\n\r\n    ActiveTexture(gl){\r\n        if(this.params){\r\n            gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, this.params.flipY);\r\n        }\r\n        gl.activeTexture(gl.TEXTURE0 + this.textureUnit);\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n    }\r\n\r\n    DisactiveTexture(gl){\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n\r\n    deleteTextyre(gl){\r\n        gl.deleteTexture(this.texture);\r\n    }\r\n\r\n}","import {Component} from '../Component';\r\nimport { SceneObject } from '../Object';\r\nimport { Scene } from '../Scene';\r\nimport { LightTypes } from '../Utils/constants';\r\nimport { vec3 } from \"../Utils/Vector_Matrix\";\r\nconst lightTypes = LightTypes;\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Components that makes the object to which it is attached a source light.\r\n */\r\nexport class Light extends Component{\r\n    static nextId = 1;\r\n    id;\r\n    diffuse = vec3(1.0, 1.0, 1.0);\r\n    ambient = vec3(0.1, 0.1, 0.1);\r\n    specular = vec3(1.0, 1.0, 1.0);\r\n    /**\r\n     * \r\n     * @param {vec3} diffuse Diffuse component of the light\r\n     * @param {vec3} ambient Ambient component of the light\r\n     * @param {vec3} specular Specular component of the light\r\n     */\r\n    constructon(diffuse, ambient, specular){\r\n        this.id = Light.nextId;\r\n        Light.nextId++;\r\n        this.name = 'Light';\r\n        this.diffuse = diffuse;\r\n        this.ambient = ambient;\r\n        this.specular = specular;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {SceneObject} parent \r\n     * @param {Scene} scene \r\n     */\r\n    onAfterAdded(parent, scene){\r\n        scene.registerLight(lightTypes[this.constructor.name], this);\r\n    }\r\n\r\n    onAfterRemoved(parent, scene){\r\n        scene.unregisterLight(lightTypes[this.constructor.name], this);\r\n    }\r\n}","import { Light } from \"./Light\";\r\nimport { vec3 } from \"../Utils/Vector_Matrix\";\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Components that represents a directional global light.\r\n */\r\nexport class DirectionalLight extends Light{\r\n\r\n    direction;\r\n\r\n    constructor(diffuse, ambient, specular, direction){\r\n        super(diffuse, ambient, specular);\r\n        this.name = 'DirectionalLight';\r\n        this.direction = direction || vec3(0,-1,0);\r\n    }\r\n\r\n    static getDirectionForShader(){\r\n        return 'vec3 lightDir = normalize(-light.direction);';\r\n    }\r\n\r\n}","import { Light } from \"./Light\";\r\nimport { vec3 } from \"../Utils/Vector_Matrix\";\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Components that represents a point light.\r\n */\r\nexport class PointLight extends Light{\r\n    position\r\n    constant;\r\n    linear;\r\n    quadratic;\r\n\r\n    constructor(diffuse, ambient, specular, position, constant, linear, quadratic){\r\n        super();\r\n        this.name = 'PointLight';\r\n        this.constant = constant || 1.0;\r\n        this.linear = linear || 0.09;\r\n        this.quadratic = quadratic || 0.032;\r\n        this.position = position || vec3(0, 5, 0);\r\n    }\r\n\r\n}","import { Light } from \"./Light\";\r\nimport { vec3 } from \"../Utils/Vector_Matrix\";\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Components that represents a spot light.\r\n */\r\nexport class SpotLight extends Light{\r\n    position;\r\n    cutOff;\r\n    outerCutOff;\r\n    constant;\r\n    linear;\r\n    quadratic;\r\n    direction;\r\n\r\n    constructor(diffuse, ambient, specular, position, constant, linear, quadratic, cutOff, outerCutOff, direction){\r\n        super(diffuse, ambient, specular);\r\n        this.name = 'SpotLight';\r\n        this.constant = constant || 1.0;\r\n        this.linear = linear || 0.09;\r\n        this.quadratic = quadratic || 0.032;\r\n        this.cutOff = cutOff || 0.4;\r\n        this.outerCutOff = outerCutOff || 0.5;\r\n        this.direction = direction || vec3(1, -1, 0);\r\n        this.position = position || vec3(0,0,0);\r\n    }\r\n\r\n}","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","module.exports = require(\"regenerator-runtime\");\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","export const HTTP_METHOD = {\r\n    HEAD: 'HEAD',\r\n    GET: 'GET',\r\n    POST: 'POST',\r\n    PUT: 'PUT',\r\n    PATCH: 'PATCH',\r\n    DELETE: 'DELETE'\r\n}\r\n\r\nexport const HTTP_RESPONSE_STATUS = {\r\n    OK: 200,\r\n    CREATED: 201,\r\n    FORBIDDEN: 403,\r\n    NOT_FOUND: 404,\r\n    INTERNAL_SERVER_ERROR: 500\r\n}\r\n\r\n/**\r\n * @author Alberto Contorno\r\n * @class\r\n * Wrapper to make http requests\r\n */\r\nexport class Request{\r\n\r\n    constructor( url, method, options, data ){\r\n        this.url = url;\r\n        this.method = method || 'GET';\r\n        this.options = options;\r\n        this.data = data;\r\n    }\r\n\r\n    send(){\r\n        return new Promise( async (resolve, reject) => {\r\n            if(!this.url){ return; }\r\n            const _options = {\r\n                methods: this.method,\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                }\r\n            }\r\n    \r\n            if(this.method == 'GET' || this.method == 'DELETE' || this.method == 'HEAD'){\r\n    \r\n            } else {\r\n                if(_options.headers.contentType === 'application/json') _options.body = JSON.stringify(data); // TODO DEPENDS ON MYME-TYPE\r\n                else _options.body = data;\r\n            }\r\n            \r\n            fetch(this.url, _options).then( async (res) => {\r\n                let body;\r\n                let contentType;\r\n                for (var header of res.headers.entries()){\r\n                    let [key, value] = header;\r\n                    if(key === 'content-type'){\r\n                        contentType = value;\r\n                    }\r\n                }\r\n                if(contentType.includes('application/json')) { body = await res.json(); }\r\n                else { body = res.text(); };\r\n                resolve(body);\r\n            }).catch( err => reject(err));\r\n\r\n        });\r\n        /* {\r\n            method: 'POST', // *GET, POST, PUT, DELETE, etc.\r\n            mode: 'cors', // no-cors, *cors, same-origin\r\n            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\r\n            credentials: 'same-origin', // include, *same-origin, omit\r\n            headers: {\r\n              'Content-Type': 'application/json'\r\n              // 'Content-Type': 'application/x-www-form-urlencoded',\r\n            },  redirect: 'follow', // manual, *follow, error\r\n            referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url\r\n            body: JSON.stringify(data) // body data type must match \"Content-Type\" header)*/\r\n        \r\n            \r\n    }\r\n}\r\n\r\n","export class ModelLoader{\r\n    constructor(){}\r\n\r\n    parse(path){\r\n        \r\n    }\r\n}","import {ModelLoader} from './ModelLoader'\r\n\r\nexport class ObjLoader extends ModelLoader{\r\n  parse(text) {\r\n    // because indices are base 1 let's just fill in the 0th data\r\n    const objPositions = [[0, 0, 0]];\r\n    const objTexcoords = [[0, 0]];\r\n    const objNormals = [[0, 0, 0]];\r\n    const objColors = [[0, 0, 0]];\r\n  \r\n    // same order as `f` indices\r\n    const objVertexData = [\r\n      objPositions,\r\n      objTexcoords,\r\n      objNormals,\r\n      objColors,\r\n    ];\r\n  \r\n    // same order as `f` indices\r\n    let webglVertexData = [\r\n      [],   // positions\r\n      [],   // texcoords\r\n      [],   // normals\r\n      [],   // colors\r\n    ];\r\n  \r\n    const materialLibs = [];\r\n    const geometries = [];\r\n    let geometry;\r\n    let groups = ['default'];\r\n    let material = 'default';\r\n    let object = 'default';\r\n  \r\n    const noop = () => {};\r\n  \r\n    function newGeometry() {\r\n      // If there is an existing geometry and it's\r\n      // not empty then start a new one.\r\n      if (geometry && geometry.data.position.length) {\r\n        geometry = undefined;\r\n      }\r\n    }\r\n  \r\n    function setGeometry() {\r\n      if (!geometry) {\r\n        const position = [];\r\n        const texcoord = [];\r\n        const normal = [];\r\n        const color = [];\r\n        webglVertexData = [\r\n          position,\r\n          texcoord,\r\n          normal,\r\n          color,\r\n        ];\r\n        geometry = {\r\n          object,\r\n          groups,\r\n          material,\r\n          data: {\r\n            position,\r\n            texcoord,\r\n            normal,\r\n            color,\r\n          },\r\n        };\r\n        geometries.push(geometry);\r\n      }\r\n    }\r\n  \r\n    function addVertex(vert) {\r\n      const ptn = vert.split('/');\r\n      ptn.forEach((objIndexStr, i) => {\r\n        if (!objIndexStr) {\r\n          return;\r\n        }\r\n        const objIndex = parseInt(objIndexStr);\r\n        const index = objIndex + (objIndex >= 0 ? 0 : objVertexData[i].length);\r\n        webglVertexData[i].push(...objVertexData[i][index]);\r\n        // if this is the position index (index 0) and we parsed\r\n        // vertex colors then copy the vertex colors to the webgl vertex color data\r\n        if (i === 0 && objColors.length > 1) {\r\n          geometry.data.color.push(...objColors[index]);\r\n        }\r\n      });\r\n    }\r\n  \r\n    const keywords = {\r\n      v(parts) {\r\n        // if there are more than 3 values here they are vertex colors\r\n        if (parts.length > 3) {\r\n          objPositions.push(parts.slice(0, 3).map(parseFloat));\r\n          objColors.push(parts.slice(3).map(parseFloat));\r\n        } else {\r\n          objPositions.push(parts.map(parseFloat));\r\n        }\r\n      },\r\n      vn(parts) {\r\n        objNormals.push(parts.map(parseFloat));\r\n      },\r\n      vt(parts) {\r\n        // should check for missing v and extra w?\r\n        objTexcoords.push(parts.map(parseFloat));\r\n      },\r\n      f(parts) {\r\n        setGeometry();\r\n        const numTriangles = parts.length - 2;\r\n        for (let tri = 0; tri < numTriangles; ++tri) {\r\n          addVertex(parts[0]);\r\n          addVertex(parts[tri + 1]);\r\n          addVertex(parts[tri + 2]);\r\n        }\r\n      },\r\n      s: noop,    // smoothing group\r\n      mtllib(parts, unparsedArgs) {\r\n        // the spec says there can be multiple filenames here\r\n        // but many exist with spaces in a single filename\r\n        materialLibs.push(unparsedArgs);\r\n      },\r\n      usemtl(parts, unparsedArgs) {\r\n        material = unparsedArgs;\r\n        newGeometry();\r\n      },\r\n      g(parts) {\r\n        groups = parts;\r\n        newGeometry();\r\n      },\r\n      o(parts, unparsedArgs) {\r\n        object = unparsedArgs;\r\n        newGeometry();\r\n      },\r\n    };\r\n  \r\n    const keywordRE = /(\\w*)(?: )*(.*)/;\r\n    const lines = text.split('\\n');\r\n    for (let lineNo = 0; lineNo < lines.length; ++lineNo) {\r\n      const line = lines[lineNo].trim();\r\n      if (line === '' || line.startsWith('#')) {\r\n        continue;\r\n      }\r\n      const m = keywordRE.exec(line);\r\n      if (!m) {\r\n        continue;\r\n      }\r\n      const [, keyword, unparsedArgs] = m;\r\n      const parts = line.split(/\\s+/).slice(1);\r\n      const handler = keywords[keyword];\r\n      if (!handler) {\r\n        console.warn('obj unhandled keyword:', keyword); \r\n        continue;\r\n      }\r\n      handler(parts, unparsedArgs);\r\n    }\r\n  \r\n    // remove any arrays that have no entries.\r\n    for (const geometry of geometries) {\r\n      geometry.data = Object.fromEntries(\r\n          Object.entries(geometry.data).filter(([, array]) => array.length > 0));\r\n    }\r\n  \r\n    return {\r\n      geometries,\r\n      materialLibs,\r\n    };\r\n  }\r\n  \r\n  parseMapArgs(unparsedArgs) {\r\n    // TODO: handle options\r\n    return unparsedArgs;\r\n  }\r\n  \r\n  parseMTL(text) {\r\n    const materials = {};\r\n    let material;\r\n    \r\n    const keywords = {\r\n      newmtl(parts, unparsedArgs) {\r\n        material = {};\r\n        materials[unparsedArgs] = material;\r\n      },\r\n\r\n      Ns: (parts) => { material.shininess      = parseFloat(parts[0]); },\r\n      Ka: (parts) => { material.ambient        = parts.map(parseFloat); },\r\n      Kd: (parts) => { material.diffuse        = parts.map(parseFloat); },\r\n      Ks: (parts) => { material.specular       = parts.map(parseFloat); },\r\n      Ke: (parts) => { material.emissive       = parts.map(parseFloat); },\r\n      map_Kd: (parts, unparsedArgs) => { material.diffuseMap = this.parseMapArgs(unparsedArgs); },\r\n      map_Ns: (parts, unparsedArgs) => { material.specularMap = this.parseMapArgs(unparsedArgs); },\r\n      map_Bump: (parts, unparsedArgs) => { material.normalMap = this.parseMapArgs(unparsedArgs); },\r\n      Ni: (parts) => { material.opticalDensity = parseFloat(parts[0]); },\r\n      d: (parts) => { material.opacity        = parseFloat(parts[0]); },\r\n      illum: (parts) => { material.illum          = parseInt(parts[0]); },\r\n    };\r\n    console.log(this)\r\n    const keywordRE = /(\\w*)(?: )*(.*)/;\r\n    const lines = text.split('\\n');\r\n    for (let lineNo = 0; lineNo < lines.length; ++lineNo) {\r\n      const line = lines[lineNo].trim();\r\n      if (line === '' || line.startsWith('#')) {\r\n        continue;\r\n      }\r\n      const m = keywordRE.exec(line);\r\n      if (!m) {\r\n        continue;\r\n      }\r\n      const [, keyword, unparsedArgs] = m;\r\n      const parts = line.split(/\\s+/).slice(1);\r\n      const handler = keywords[keyword];\r\n      if (!handler) {\r\n        console.warn('material unhandled keyword:', keyword);  // eslint-disable-line no-console\r\n        continue;\r\n      }\r\n      handler(parts, unparsedArgs);\r\n    }\r\n  \r\n    return materials;\r\n  }\r\n}","import {subtract, scale, normalize, vec3} from './Vector_Matrix';\r\n\r\nconst toVec3 = (v) => {return vec3(v[0], v[1], v[2])}\r\n\r\nexport function generateTangents(verteces, texcoords, indices) {\r\n\r\n    const numFaces = verteces.length / 3;\r\n    const tangents = [];\r\n    for (let i = 0; i < numFaces; i++) {\r\n\r\n        const p1 = toVec3(verteces[i]);\r\n        const p2 = toVec3(verteces[i+1]);\r\n        const p3 = toVec3(verteces[i+2]);\r\n\r\n        const uv1 = texcoords[i];\r\n        const uv2 = texcoords[i+1];\r\n        const uv3 = texcoords[i+2];\r\n\r\n        const edge1  = subtract(p2, p1);\r\n        const edge2 = subtract(p3, p1);\r\n\r\n        const deltaUV1 = subtract(uv2, uv1);\r\n        const deltaUV2 = subtract(uv3, uv1);\r\n\r\n\r\n        const f = 1.0 / (deltaUV1[0] * deltaUV2[1] - deltaUV2[0] * deltaUV1[1]);\r\n        const tangent = Number.isFinite(f)\r\n        ? normalize(scale(f, subtract(\r\n            scale(deltaUV2[1], edge1),\r\n            scale(deltaUV1[1], edge2),\r\n            )))\r\n        : [1, 0, 0];\r\n\r\n        tangents.push(...tangent, ...tangent, ...tangent);\r\n    }\r\n\r\n    return tangents;\r\n}","/**\n * @author Alberto Contorno\n */\nimport \"./styles.css\";\nimport { WebGLUtils } from \"./common/webgl-utils\";\nimport { Engine } from \"./common/Engine\";\nimport { InputManager } from \"./common/inputManager\";\nimport { Scene } from \"./common/Scene\";\nimport { Camera } from \"./common/Camera\";\nimport { SceneObject } from \"./common/Object\";\nimport { Mesh } from \"./common/Mesh\";\nimport { Texture } from \"./common/Texture\";\nimport { DirectionalLight } from \"./common/Components/DirectionalLight\";\nimport { PointLight } from './common/Components/PointLight';\nimport { SpotLight } from './common/Components/SpotLight';\nimport { vec2, vec3, vec4, perspective, lookAt, scale, add, subtract,  } from \"./common/Utils/Vector_Matrix\";\nimport { Material } from \"./common/Material\";\nimport { Request } from './common/Utils/Request';\nimport { ObjLoader } from './common/Loaders/ObjLoader';\nimport { generateTangents } from './common/Utils/NormalsGenerator';\n\nvar inputs = new InputManager();\n\nconst up = vec3(0.0, 1.0, 0.0);\n\nconst canvas = document.getElementById(\"app\");\ninputs.lockMouse(canvas);\nconst gl = WebGLUtils.setupWebGL(canvas);\nvar aspect = gl.drawingBufferWidth / gl.drawingBufferHeight;\nvar camera = new Camera(vec3(0, 0, 5), up, 5, \"perspective\", {},\n  { fov: 45, aspect: aspect, near: 0.1, far: 100 },\n  25, { maxLevel: 3, 0: 30, 1: 45, 2: 75, 3: 90 }, 1\n);\n/* var camera = new Camera(vec3(0, 0, 0), up, 5, \"orthographic\", {},\n  { left: -1, right: 1, up: 1, bottom: -1, near: 0.1, far: 100 },\n  25, { maxLevel: 3, 0: 30, 1: 45, 2: 75, 3: 90 }, 1\n); */\ngl.enable(gl.DEPTH_TEST);\n//gl.enable(gl.CULL_FACE);\ngl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\nvar engine = new Engine(gl, {showFps: true, clearColor: [0.0, 0.0, 0.0, 0.0]});\nvar scene = new Scene();\nconst req = new Request('http://localhost:1234/assets/windmill.obj');\nconst reqMtl = new Request('http://localhost:1234/assets/windmill.mtl');\n\nPromise.all([req.send(), reqMtl.send()]).then( res => {\n  const obj = res[0];\n  const mat = res[1];\n  \n  const loader = new ObjLoader();\n  let m = loader.parse(obj);\n  console.log(m);\n  let o = new SceneObject(null, 'holder');\n  scene.addObject(o);\n  const mtl = loader.parseMTL(mat);\n  console.log(mtl);\n  o.onUpdate = () => {\n     o.transform.rotation[1] += 25 * engine.time.deltaTime; \n     //o.transform.rotation[0] += 5 * engine.time.deltaTime; \n  }\n\n  m.geometries.forEach( g => {\n    let oo = new SceneObject(null, 'sub');\n    \n    let verts = [];\n    let verts_n = [];\n    let text_coords = [];\n    let colors;\n    let data = g.data;\n    let tangents;\n    for(let i = 0; i<data.position.length-2; i+=3){\n      verts.push(vec4(data.position[i], data.position[i+1], data.position[i+2], 1.0));\n      verts_n.push(vec3(data.normal[i], data.normal[i+1], data.normal[i+2]));\n    }\n    for(let i = 0; i<data.texcoord.length-1; i+=2){\n      text_coords.push(vec2(data.texcoord[i], data.texcoord[i+1], 1.0));\n    }\n    if(data.color){\n      colors = [];\n      for(let i = 0; i<data.color.length-2; i+=3){\n        colors.push(vec4(data.color[i], data.color[i+1], data.color[i+2], 1.0));\n      }\n    }\n\n    let ooMat = mtl[g.material]\n    if (data.texcoord && data.normal && ooMat['normalMap']) {\n      let tangents_ = generateTangents(verts, text_coords);\n      tangents = [];\n      for(let i = 0; i<tangents_.length-2; i+=3){\n        tangents.push(vec3(tangents_[i], tangents_[i+1], tangents_[i+2]));\n      }\n    }\n\n    let ooMesh = new Mesh(gl, verts, null, null, null, null, text_coords, verts_n, tangents);\n    oo.addMesh(ooMesh);\n    oo.parent = o;\n    scene.addObject(oo);\n    \n    if(ooMat['diffuseMap']){\n      let diffuseMap = new Texture(0, null, 'assets/'+ooMat['diffuseMap'], gl.RGB, gl.RGB, {flipY: true});\n      diffuseMap.LoadTexture(gl);\n      ooMesh.textures.DIFFUSE_MAP = diffuseMap;\n    }\n    if(ooMat['normalMap']){\n      console.log('NORMAL MAP ' + ooMat['normalMap'])\n      let normalMap = new Texture(2, null, 'assets/'+ooMat['normalMap'], gl.RGB, gl.RGB, {flipY: true});\n      normalMap.LoadTexture(gl);\n      ooMesh.textures.NORMAL_MAP = normalMap;\n    }\n    if(ooMat['specularMap']){\n      let specularMap = new Texture(1, null, 'assets/'+ooMat['specularMap'], gl.RGB, gl.RGB, {flipY: true});\n      specularMap.LoadTexture(gl);\n      ooMesh.textures.SPECULAR_MAP = specularMap;\n    }\n    oo.material = new Material(ooMat.ambient, ooMat.diffuse, ooMat.specular, ooMat.shininess);\n  });\n\n\n  o.transform.position = [0, 0, -3];\n  o.transform.rotation = [0, -90, 0];\n  o.transform.scale = [.1,.1,.1]\n  scene.addObject(o);\n});\n\n\nfunction handleInputs() {\n  if (\n    inputs.isKeyDown(inputs.keyCodes.KEYNAMES.shift) &&\n    inputs.isKeyDown(inputs.keyCodes.KEYNAMES.w)\n  ) {\n    camera.moveUp(engine.time.deltaTime);\n  } else if (\n    inputs.isKeyDown(inputs.keyCodes.KEYNAMES.shift) &&\n    inputs.isKeyDown(inputs.keyCodes.KEYNAMES.s)\n  ) {\n    camera.moveDown(engine.time.deltaTime);\n  } else {\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.a)) {\n      camera.moveLeft(engine.time.deltaTime);\n    }\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.s)) {\n      camera.moveBackwards(engine.time.deltaTime);\n    }\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.d)) {\n      camera.moveRight(engine.time.deltaTime);\n    }\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.w)) {\n      camera.moveForward(engine.time.deltaTime);\n    }\n\n    if(inputs.isKeyDown(inputs.keyCodes.KEYNAMES.q)){\n      obj3.transform.rotation[0] +=4;\n      obj3.transform.rotation[1] += 5;\n      obj3.transform.rotation[2] += 4;\n    }\n\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.r)) {\n      robotLowerArm.transform.rotation[0] += 4;\n    }\n\n    if (inputs.isKeyDown(inputs.keyCodes.KEYNAMES.t) ) {\n      robotBody.transform.rotation[1] += 4;\n    }\n\n    if(inputs.isKeyDown(inputs.keyCodes.KEYNAMES.o)) {\n      pointLight_obj.transform.position[0] = 4 * Math.sin(engine.time.time);\n      pointLight_obj.transform.position[2] = 4 * Math.cos(engine.time.time);\n      pointLight.position = pointLight_obj.transform.position;\n    } \n  }\n\n  camera.updateCameraDirection(\n    inputs.getMouseMovX(),\n    inputs.getMouseMovY(),\n    engine.time.deltaTime\n  );\n\n}\n\n\nlet vertices1 = [\n  vec4(-0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, 0.5, -0.5, 1.0),\n  vec4(0.5, 0.5, -0.5, 1.0),\n  vec4(-0.5, 0.5, -0.5, 1.0),\n  vec4(-0.5, -0.5, -0.5, 1.0),\n\n  vec4(-0.5, -0.5, 0.5, 1.0),\n  vec4(0.5, -0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, -0.5, 0.5, 1.0),\n\n  vec4(-0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, -0.5, 1.0),\n  vec4(-0.5, -0.5, -0.5, 1.0),\n  vec4(-0.5, -0.5, -0.5, 1.0),\n  vec4(-0.5, -0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, 0.5, 1.0),\n\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n\n  vec4(-0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, -0.5, 1.0),\n  vec4(0.5, -0.5, 0.5, 1.0),\n  vec4(0.5, -0.5, 0.5, 1.0),\n  vec4(-0.5, -0.5, 0.5, 1.0),\n  vec4(-0.5, -0.5, -0.5, 1.0),\n\n  vec4(-0.5, 0.5, -0.5, 1.0),\n  vec4(0.5, 0.5, -0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, 0.5, 1.0),\n  vec4(-0.5, 0.5, -0.5, 1.0)\n];\nvar normals = [\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n  vec3(0.0, 0.0, -1.0),\n\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n  vec3(0.0, 0.0, 1.0),\n\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n  vec3(-1.0, 0.0, 0.0),\n\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n  vec3(1.0, 0.0, 0.0),\n\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n  vec3(0.0, -1.0, 0.0),\n\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0),\n  vec3(0.0, 1.0, 0.0)\n]\nlet cube = new Mesh(gl, vertices1, null, null, null, null, null, normals);\nvar lightsObj = new SceneObject(null, 'lights');\n\nscene.addObject(lightsObj);\n\nlet dirLight = new DirectionalLight();\ndirLight.ambient = vec3(0.1, 0.1, 0.1);\ndirLight.diffuse = vec3(1.0, 1.0, 1.0);\ndirLight.direction = vec3(-1, -1, 5);\ndirLight.specular = vec3(1, 1, 1);\n\nvar pointLight_obj = new SceneObject(null, 'dirLight');\npointLight_obj.addMesh(cube);\npointLight_obj.material = new Material(vec3(0.0, 1.0, 0.0), vec3(0.0, 1.0, 0.0));\nscene.addObject(pointLight_obj);\n\npointLight_obj.transform.position = [0.0, 0, -2.0];\npointLight_obj.transform.scale = [.1, .1, .1];\n\nlet pointLight = new PointLight();\npointLight.position = vec3(0.0, 0, -2.0);\npointLight.diffuse = vec3(1.0, 1.0, 1.0);\n\n/* var pointLight_obj2 = new SceneObject(null, 'dirLight');\npointLight_obj2.addMesh(cube);\npointLight_obj2.material = new Material(vec3(1.0, 1.0, 1.0), vec3(1.0, 1.0, 1.0));\nscene.addObject(pointLight_obj2);\n\npointLight_obj2.transform.position = [0.0, -3.0, 0.0];\npointLight_obj2.transform.scale = [.2, .2, .2];\n\nlet pointLight2 = new PointLight();\npointLight2.position = vec3(0.0, -3.0, 0.0);\npointLight2.diffuse = vec3(1.0, 1.0, 1.0); */\n\nlet spotLight = new SpotLight();\nspotLight.direction = vec3(0, 1.0, 0.0);\nspotLight.position = vec3(0.0, 2.0, -3.0);\nspotLight.cutOff = 0.011;\nspotLight.outerCutOff = 0.512;\nspotLight.ambient = vec3(1.0, 0.1, 0.1);\nlightsObj.addComponent(dirLight);\n/* lightsObj.addComponent(pointLight); */\n/* lightsObj.addComponent(pointLight2); */\n\nvar gameManager = new SceneObject(null, 'gm');\nconsole.log(engine);\ngameManager.onUpdate =  function(){\n  handleInputs();\n  inputs.clearMousePosition();\n}\nscene.addObject(gameManager);\nscene.addCamera(camera);\nengine.addScene(scene);\n\n\nfunction main() {\n  engine.doRendering(); \n}\n\nmain();\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}